//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */

/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */

//     (c) 2010-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

// MarionetteJS (Backbone.Marionette)
// ----------------------------------
// v2.4.3
//
// Copyright (c)2015 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
//
// http://marionettejs.com

/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */

// Copyright (c)2015 Derick Bailey, Muted Solutions, LLC.

// Distributed under MIT license

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 */

/* ===================================================
 * bootstrap-transition.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ==========================================================
 * bootstrap-alert.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ============================================================
 * bootstrap-button.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ==========================================================
 * bootstrap-carousel.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#carousel
 * ==========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =============================================================
 * bootstrap-collapse.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ============================================================
 * bootstrap-dropdown.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =========================================================
 * bootstrap-modal.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ===========================================================
 * bootstrap-tooltip.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ===========================================================
 * bootstrap-popover.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */

/* =============================================================
 * bootstrap-scrollspy.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#scrollspy
 * =============================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================== */

/* ========================================================
 * bootstrap-tab.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */

/* =============================================================
 * bootstrap-typeahead.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#typeahead
 * =============================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ==========================================================
 * bootstrap-affix.js v2.3.2
 * http://twbs.github.com/bootstrap/javascript.html#affix
 * ==========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 * 
 * Defines a FLAT collection of all Parameters belonging to specific Page.
 * Parameters can be items of Array Parameters or Compound Parameters and therefore
 * form nested structures.
 * Each of Parameters has "children" and "parent" properties to easily move
 * between them.
 * NEW: The Collection is sorted so that each root parameter is in a place
 * specified by the server "params" response. Additionally if a parameter is complex 
 * then its children are placed after it and before any other non-descendant element.
 */

/*
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 */

/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! VelocityJS.org (1.2.3). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License */

/*! VelocityJS.org jQuery Shim (1.0.1). (C) 2014 The jQuery Foundation. MIT @license: en.wikipedia.org/wiki/MIT_License. */

/* Technique by Erik Moller. MIT license: https://gist.github.com/paulirish/1579671 */

/* Array compacting. Copyright Lo-Dash. MIT License: https://github.com/lodash/lodash/blob/master/LICENSE.txt */

/* Copyright Martin Bohm. MIT License: https://gist.github.com/Tomalak/818a78a226a0738eaade */

/* Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */

/* Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */

/* Hex to RGB conversion. Copyright Tim Down: http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb */

/* VelocityJS.org UI Pack (5.0.4). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License. Portions copyright Daniel Eden, Christian Pucci. */

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 * 
 * Base type from which all Parameter types should inherit.
 */

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 * 
 * It renders parameter values as uneditable list.
 * Present at first in sidebar after loading analysis plot response.
 */

/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @license MIT
 */

/*
Copyright 2012 Igor Vaynberg

Version: 3.5.4 Timestamp: Sun Aug 30 13:30:32 EDT 2015

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 * 
 * This factory defines a method which allows programmer to dynamically
 * set prototype chain for newly created Combobox Parameter View.
 * The routine for setting the chain is based on self-dependency of the model
 * and the place where the view will appear.
 */

/* 
 * Copyright Genentech - A member of the Roche Group
 * @author Adrian Nowicki <adrian.nowicki@contractors.roche.com>
 * 
 */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */

/*!
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * @link   http://www.phpied.com/rgb-color-parser-in-javascript/
 * @license Use it if you like it
 */

/*!

StackBlur - a fast almost Gaussian Blur For Canvas

Version: 	0.5
Author:		Mario Klingemann
Contact: 	mario@quasimondo.com
Website:	http://www.quasimondo.com/StackBlurForCanvas
Twitter:	@quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr: 
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/

/*!
 * canvg.js - Javascript SVG parser and renderer on Canvas
 * MIT Licensed 
 * Gabe Lerner (gabelerner@gmail.com)
 * http://code.google.com/p/canvg/
 *
 * Requires: rgbcolor.js - http://www.phpied.com/rgb-color-parser-in-javascript/
 */

/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */

function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)e==n&&(e=t[n]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],i=0;i<r.length;i++){var s=r[i].re,o=r[i].process,u=s.exec(e);u&&(channels=o(u),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n},this.getHelpXML=function(){for(var e=new Array,n=0;n<r.length;n++)for(var i=r[n].example,s=0;s<i.length;s++)e[e.length]=i[s];for(var o in t)e[e.length]=o;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(var n=0;n<e.length;n++)try{var a=document.createElement("li"),f=new RGBColor(e[n]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+f.toHex()+"; color:"+f.toHex(),l.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[n]+" -> "+f.toRGB()+" -> "+f.toHex());a.appendChild(l),a.appendChild(c),u.appendChild(a)}catch(h){}return u}}function stackBlurImage(e,t,n,r){var i=document.getElementById(e),s=i.naturalWidth,o=i.naturalHeight,u=document.getElementById(t);u.style.width=s+"px",u.style.height=o+"px",u.width=s,u.height=o;var a=u.getContext("2d");a.clearRect(0,0,s,o),a.drawImage(i,0,0),isNaN(n)||1>n||(r?stackBlurCanvasRGBA(t,0,0,s,o,n):stackBlurCanvasRGB(t,0,0,s,o,n))}function stackBlurCanvasRGBA(e,t,n,r,i,s){if(!(isNaN(s)||1>s)){s|=0;var o,u=document.getElementById(e),a=u.getContext("2d");try{try{o=a.getImageData(t,n,r,i)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=a.getImageData(t,n,r,i)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P=o.data,H=s+s+1,B=r-1,j=i-1,F=s+1,I=F*(F+1)/2,q=new BlurStack,R=q;for(h=1;H>h;h++)if(R=R.next=new BlurStack,h==F)var U=R;R.next=q;var z=null,W=null;m=v=0;var X=mul_table[s],V=shg_table[s];for(c=0;i>c;c++){for(N=C=k=L=g=y=b=w=0,E=F*(A=P[v]),S=F*(O=P[v+1]),x=F*(M=P[v+2]),T=F*(_=P[v+3]),g+=I*A,y+=I*O,b+=I*M,w+=I*_,R=q,h=0;F>h;h++)R.r=A,R.g=O,R.b=M,R.a=_,R=R.next;for(h=1;F>h;h++)p=v+((h>B?B:h)<<2),g+=(R.r=A=P[p])*(D=F-h),y+=(R.g=O=P[p+1])*D,b+=(R.b=M=P[p+2])*D,w+=(R.a=_=P[p+3])*D,N+=A,C+=O,k+=M,L+=_,R=R.next;for(z=q,W=U,l=0;r>l;l++)P[v+3]=_=w*X>>V,0!=_?(_=255/_,P[v]=(g*X>>V)*_,P[v+1]=(y*X>>V)*_,P[v+2]=(b*X>>V)*_):P[v]=P[v+1]=P[v+2]=0,g-=E,y-=S,b-=x,w-=T,E-=z.r,S-=z.g,x-=z.b,T-=z.a,p=m+((p=l+s+1)<B?p:B)<<2,N+=z.r=P[p],C+=z.g=P[p+1],k+=z.b=P[p+2],L+=z.a=P[p+3],g+=N,y+=C,b+=k,w+=L,z=z.next,E+=A=W.r,S+=O=W.g,x+=M=W.b,T+=_=W.a,N-=A,C-=O,k-=M,L-=_,W=W.next,v+=4;m+=r}for(l=0;r>l;l++){for(C=k=L=N=y=b=w=g=0,v=l<<2,E=F*(A=P[v]),S=F*(O=P[v+1]),x=F*(M=P[v+2]),T=F*(_=P[v+3]),g+=I*A,y+=I*O,b+=I*M,w+=I*_,R=q,h=0;F>h;h++)R.r=A,R.g=O,R.b=M,R.a=_,R=R.next;for(d=r,h=1;s>=h;h++)v=d+l<<2,g+=(R.r=A=P[v])*(D=F-h),y+=(R.g=O=P[v+1])*D,b+=(R.b=M=P[v+2])*D,w+=(R.a=_=P[v+3])*D,N+=A,C+=O,k+=M,L+=_,R=R.next,j>h&&(d+=r);for(v=l,z=q,W=U,c=0;i>c;c++)p=v<<2,P[p+3]=_=w*X>>V,_>0?(_=255/_,P[p]=(g*X>>V)*_,P[p+1]=(y*X>>V)*_,P[p+2]=(b*X>>V)*_):P[p]=P[p+1]=P[p+2]=0,g-=E,y-=S,b-=x,w-=T,E-=z.r,S-=z.g,x-=z.b,T-=z.a,p=l+((p=c+F)<j?p:j)*r<<2,g+=N+=z.r=P[p],y+=C+=z.g=P[p+1],b+=k+=z.b=P[p+2],w+=L+=z.a=P[p+3],z=z.next,E+=A=W.r,S+=O=W.g,x+=M=W.b,T+=_=W.a,N-=A,C-=O,k-=M,L-=_,W=W.next,v+=r}a.putImageData(o,t,n)}}function stackBlurCanvasRGB(e,t,n,r,i,s){if(!(isNaN(s)||1>s)){s|=0;var o,u=document.getElementById(e),a=u.getContext("2d");try{try{o=a.getImageData(t,n,r,i)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=a.getImageData(t,n,r,i)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O=o.data,M=s+s+1,_=r-1,D=i-1,P=s+1,H=P*(P+1)/2,B=new BlurStack,j=B;for(h=1;M>h;h++)if(j=j.next=new BlurStack,h==P)var F=j;j.next=B;var I=null,q=null;m=v=0;var R=mul_table[s],U=shg_table[s];for(c=0;i>c;c++){for(x=T=N=g=y=b=0,w=P*(C=O[v]),E=P*(k=O[v+1]),S=P*(L=O[v+2]),g+=H*C,y+=H*k,b+=H*L,j=B,h=0;P>h;h++)j.r=C,j.g=k,j.b=L,j=j.next;for(h=1;P>h;h++)p=v+((h>_?_:h)<<2),g+=(j.r=C=O[p])*(A=P-h),y+=(j.g=k=O[p+1])*A,b+=(j.b=L=O[p+2])*A,x+=C,T+=k,N+=L,j=j.next;for(I=B,q=F,l=0;r>l;l++)O[v]=g*R>>U,O[v+1]=y*R>>U,O[v+2]=b*R>>U,g-=w,y-=E,b-=S,w-=I.r,E-=I.g,S-=I.b,p=m+((p=l+s+1)<_?p:_)<<2,x+=I.r=O[p],T+=I.g=O[p+1],N+=I.b=O[p+2],g+=x,y+=T,b+=N,I=I.next,w+=C=q.r,E+=k=q.g,S+=L=q.b,x-=C,T-=k,N-=L,q=q.next,v+=4;m+=r}for(l=0;r>l;l++){for(T=N=x=y=b=g=0,v=l<<2,w=P*(C=O[v]),E=P*(k=O[v+1]),S=P*(L=O[v+2]),g+=H*C,y+=H*k,b+=H*L,j=B,h=0;P>h;h++)j.r=C,j.g=k,j.b=L,j=j.next;for(d=r,h=1;s>=h;h++)v=d+l<<2,g+=(j.r=C=O[v])*(A=P-h),y+=(j.g=k=O[v+1])*A,b+=(j.b=L=O[v+2])*A,x+=C,T+=k,N+=L,j=j.next,D>h&&(d+=r);for(v=l,I=B,q=F,c=0;i>c;c++)p=v<<2,O[p]=g*R>>U,O[p+1]=y*R>>U,O[p+2]=b*R>>U,g-=w,y-=E,b-=S,w-=I.r,E-=I.g,S-=I.b,p=l+((p=c+P)<D?p:D)*r<<2,g+=x+=I.r=O[p],y+=T+=I.g=O[p+1],b+=N+=I.b=O[p+2],I=I.next,w+=C=q.r,E+=k=q.g,S+=L=q.b,x-=C,T-=k,N-=L,q=q.next,v+=r}a.putImageData(o,t,n)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}(function(){function x(e){function t(t,n,r,i,s,o){for(;s>=0&&s<o;s+=e){var u=i?i[s]:s;r=n(r,t[u],u,t)}return r}return function(n,r,i,s){r=v(r,s,4);var o=!S(n)&&d.keys(n),u=(o||n).length,a=e>0?0:u-1;return arguments.length<3&&(i=n[o?o[a]:a],a+=e),t(n,r,i,o,a,u)}}function C(e){return function(t,n,r){n=m(n,r);var i=E(t),s=e>0?0:i-1;for(;s>=0&&s<i;s+=e)if(n(t[s],s,t))return s;return-1}}function k(e,t,n){return function(r,i,s){var u=0,a=E(r);if(typeof s=="number")e>0?u=s>=0?s:Math.max(s+a,u):a=s>=0?Math.min(s+1,a):s+a+1;else if(n&&s&&a)return s=n(r,i),r[s]===i?s:-1;if(i!==i)return s=t(o.call(r,u,a),d.isNaN),s>=0?s+u:-1;for(s=e>0?u:a-1;s>=0&&s<a;s+=e)if(r[s]===i)return s;return-1}}function M(e,t){var n=O.length,i=e.constructor,s=d.isFunction(i)&&i.prototype||r,o="constructor";d.has(e,o)&&!d.contains(t,o)&&t.push(o);while(n--)o=O[n],o in e&&e[o]!==s[o]&&!d.contains(t,o)&&t.push(o)}var e=this,t=e._,n=Array.prototype,r=Object.prototype,i=Function.prototype,s=n.push,o=n.slice,u=r.toString,a=r.hasOwnProperty,f=Array.isArray,l=Object.keys,c=i.bind,h=Object.create,p=function(){},d=function(e){if(e instanceof d)return e;if(!(this instanceof d))return new d(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=d),exports._=d):e._=d,d.VERSION="1.8.3";var v=function(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}},m=function(e,t,n){return e==null?d.identity:d.isFunction(e)?v(e,t,n):d.isObject(e)?d.matcher(e):d.property(e)};d.iteratee=function(e,t){return m(e,t,Infinity)};var g=function(e,t){return function(n){var r=arguments.length;if(r<2||n==null)return n;for(var i=1;i<r;i++){var s=arguments[i],o=e(s),u=o.length;for(var a=0;a<u;a++){var f=o[a];if(!t||n[f]===void 0)n[f]=s[f]}}return n}},y=function(e){if(!d.isObject(e))return{};if(h)return h(e);p.prototype=e;var t=new p;return p.prototype=null,t},b=function(e){return function(t){return t==null?void 0:t[e]}},w=Math.pow(2,53)-1,E=b("length"),S=function(e){var t=E(e);return typeof t=="number"&&t>=0&&t<=w};d.each=d.forEach=function(e,t,n){t=v(t,n);var r,i;if(S(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=d.keys(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e},d.map=d.collect=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length,s=Array(i);for(var o=0;o<i;o++){var u=r?r[o]:o;s[o]=t(e[u],u,e)}return s},d.reduce=d.foldl=d.inject=x(1),d.reduceRight=d.foldr=x(-1),d.find=d.detect=function(e,t,n){var r;S(e)?r=d.findIndex(e,t,n):r=d.findKey(e,t,n);if(r!==void 0&&r!==-1)return e[r]},d.filter=d.select=function(e,t,n){var r=[];return t=m(t,n),d.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},d.reject=function(e,t,n){return d.filter(e,d.negate(m(t)),n)},d.every=d.all=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0},d.some=d.any=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1},d.contains=d.includes=d.include=function(e,t,n,r){S(e)||(e=d.values(e));if(typeof n!="number"||r)n=0;return d.indexOf(e,t,n)>=0},d.invoke=function(e,t){var n=o.call(arguments,2),r=d.isFunction(t);return d.map(e,function(e){var i=r?t:e[t];return i==null?i:i.apply(e,n)})},d.pluck=function(e,t){return d.map(e,d.property(t))},d.where=function(e,t){return d.filter(e,d.matcher(t))},d.findWhere=function(e,t){return d.find(e,d.matcher(t))},d.max=function(e,t,n){var r=-Infinity,i=-Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s>r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o>i||o===-Infinity&&r===-Infinity)r=e,i=o});return r},d.min=function(e,t,n){var r=Infinity,i=Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s<r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o<i||o===Infinity&&r===Infinity)r=e,i=o});return r},d.shuffle=function(e){var t=S(e)?e:d.values(e),n=t.length,r=Array(n);for(var i=0,s;i<n;i++)s=d.random(0,i),s!==i&&(r[i]=r[s]),r[s]=t[i];return r},d.sample=function(e,t,n){return t==null||n?(S(e)||(e=d.values(e)),e[d.random(e.length-1)]):d.shuffle(e).slice(0,Math.max(0,t))},d.sortBy=function(e,t,n){return t=m(t,n),d.pluck(d.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,r){var i={};return n=m(n,r),d.each(t,function(r,s){var o=n(r,s,t);e(i,r,o)}),i}};d.groupBy=T(function(e,t,n){d.has(e,n)?e[n].push(t):e[n]=[t]}),d.indexBy=T(function(e,t,n){e[n]=t}),d.countBy=T(function(e,t,n){d.has(e,n)?e[n]++:e[n]=1}),d.toArray=function(e){return e?d.isArray(e)?o.call(e):S(e)?d.map(e,d.identity):d.values(e):[]},d.size=function(e){return e==null?0:S(e)?e.length:d.keys(e).length},d.partition=function(e,t,n){t=m(t,n);var r=[],i=[];return d.each(e,function(e,n,s){(t(e,n,s)?r:i).push(e)}),[r,i]},d.first=d.head=d.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:d.initial(e,e.length-t)},d.initial=function(e,t,n){return o.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))},d.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:d.rest(e,Math.max(0,e.length-t))},d.rest=d.tail=d.drop=function(e,t,n){return o.call(e,t==null||n?1:t)},d.compact=function(e){return d.filter(e,d.identity)};var N=function(e,t,n,r){var i=[],s=0;for(var o=r||0,u=E(e);o<u;o++){var a=e[o];if(S(a)&&(d.isArray(a)||d.isArguments(a))){t||(a=N(a,t,n));var f=0,l=a.length;i.length+=l;while(f<l)i[s++]=a[f++]}else n||(i[s++]=a)}return i};d.flatten=function(e,t){return N(e,t,!1)},d.without=function(e){return d.difference(e,o.call(arguments,1))},d.uniq=d.unique=function(e,t,n,r){d.isBoolean(t)||(r=n,n=t,t=!1),n!=null&&(n=m(n,r));var i=[],s=[];for(var o=0,u=E(e);o<u;o++){var a=e[o],f=n?n(a,o,e):a;t?((!o||s!==f)&&i.push(a),s=f):n?d.contains(s,f)||(s.push(f),i.push(a)):d.contains(i,a)||i.push(a)}return i},d.union=function(){return d.uniq(N(arguments,!0,!0))},d.intersection=function(e){var t=[],n=arguments.length;for(var r=0,i=E(e);r<i;r++){var s=e[r];if(d.contains(t,s))continue;for(var o=1;o<n;o++)if(!d.contains(arguments[o],s))break;o===n&&t.push(s)}return t},d.difference=function(e){var t=N(arguments,!0,!0,1);return d.filter(e,function(e){return!d.contains(t,e)})},d.zip=function(){return d.unzip(arguments)},d.unzip=function(e){var t=e&&d.max(e,E).length||0,n=Array(t);for(var r=0;r<t;r++)n[r]=d.pluck(e,r);return n},d.object=function(e,t){var n={};for(var r=0,i=E(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},d.findIndex=C(1),d.findLastIndex=C(-1),d.sortedIndex=function(e,t,n,r){n=m(n,r,1);var i=n(t),s=0,o=E(e);while(s<o){var u=Math.floor((s+o)/2);n(e[u])<i?s=u+1:o=u}return s},d.indexOf=k(1,d.findIndex,d.sortedIndex),d.lastIndexOf=k(-1,d.findLastIndex),d.range=function(e,t,n){t==null&&(t=e||0,e=0),n=n||1;var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r);for(var s=0;s<r;s++,e+=n)i[s]=e;return i};var L=function(e,t,n,r,i){if(r instanceof t){var s=y(e.prototype),o=e.apply(s,i);return d.isObject(o)?o:s}return e.apply(n,i)};d.bind=function(e,t){if(c&&e.bind===c)return c.apply(e,o.call(arguments,1));if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");var n=o.call(arguments,2),r=function(){return L(e,r,t,this,n.concat(o.call(arguments)))};return r},d.partial=function(e){var t=o.call(arguments,1),n=function(){var r=0,i=t.length,s=Array(i);for(var o=0;o<i;o++)s[o]=t[o]===d?arguments[r++]:t[o];while(r<arguments.length)s.push(arguments[r++]);return L(e,n,this,this,s)};return n},d.bindAll=function(e){var t,n=arguments.length,r;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)r=arguments[t],e[r]=d.bind(e[r],e);return e},d.memoize=function(e,t){var n=function(r){var i=n.cache,s=""+(t?t.apply(this,arguments):r);return d.has(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return n.cache={},n},d.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},d.defer=d.partial(d.delay,d,1),d.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:d.now(),o=null,s=e.apply(r,i),o||(r=i=null)};return function(){var f=d.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),u=f,s=e.apply(r,i),o||(r=i=null)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},d.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=d.now()-o;f<t&&f>=0?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),r||(s=i=null)))};return function(){s=this,i=arguments,o=d.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},d.wrap=function(e,t){return d.partial(t,e)},d.negate=function(e){return function(){return!e.apply(this,arguments)}},d.compose=function(){var e=arguments,t=e.length-1;return function(){var n=t,r=e[t].apply(this,arguments);while(n--)r=e[n].call(this,r);return r}},d.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},d.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},d.once=d.partial(d.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];d.keys=function(e){if(!d.isObject(e))return[];if(l)return l(e);var t=[];for(var n in e)d.has(e,n)&&t.push(n);return A&&M(e,t),t},d.allKeys=function(e){if(!d.isObject(e))return[];var t=[];for(var n in e)t.push(n);return A&&M(e,t),t},d.values=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},d.mapObject=function(e,t,n){t=m(t,n);var r=d.keys(e),i=r.length,s={},o;for(var u=0;u<i;u++)o=r[u],s[o]=t(e[o],o,e);return s},d.pairs=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},d.invert=function(e){var t={},n=d.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},d.functions=d.methods=function(e){var t=[];for(var n in e)d.isFunction(e[n])&&t.push(n);return t.sort()},d.extend=g(d.allKeys),d.extendOwn=d.assign=g(d.keys),d.findKey=function(e,t,n){t=m(t,n);var r=d.keys(e),i;for(var s=0,o=r.length;s<o;s++){i=r[s];if(t(e[i],i,e))return i}},d.pick=function(e,t,n){var r={},i=e,s,o;if(i==null)return r;d.isFunction(t)?(o=d.allKeys(i),s=v(t,n)):(o=N(arguments,!1,!1,1),s=function(e,t,n){return t in n},i=Object(i));for(var u=0,a=o.length;u<a;u++){var f=o[u],l=i[f];s(l,f,i)&&(r[f]=l)}return r},d.omit=function(e,t,n){if(d.isFunction(t))t=d.negate(t);else{var r=d.map(N(arguments,!1,!1,1),String);t=function(e,t){return!d.contains(r,t)}}return d.pick(e,t,n)},d.defaults=g(d.allKeys,!0),d.create=function(e,t){var n=y(e);return t&&d.extendOwn(n,t),n},d.clone=function(e){return d.isObject(e)?d.isArray(e)?e.slice():d.extend({},e):e},d.tap=function(e,t){return t(e),e},d.isMatch=function(e,t){var n=d.keys(t),r=n.length;if(e==null)return!r;var i=Object(e);for(var s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0};var _=function(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return e===t;e instanceof d&&(e=e._wrapped),t instanceof d&&(t=t._wrapped);var i=u.call(e);if(i!==u.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":if(+e!==+e)return+t!==+t;return+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var s=i==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(d.isFunction(o)&&o instanceof o&&d.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];var f=n.length;while(f--)if(n[f]===e)return r[f]===t;n.push(e),r.push(t);if(s){f=e.length;if(f!==t.length)return!1;while(f--)if(!_(e[f],t[f],n,r))return!1}else{var l=d.keys(e),c;f=l.length;if(d.keys(t).length!==f)return!1;while(f--){c=l[f];if(!d.has(t,c)||!_(e[c],t[c],n,r))return!1}}return n.pop(),r.pop(),!0};d.isEqual=function(e,t){return _(e,t)},d.isEmpty=function(e){return e==null?!0:S(e)&&(d.isArray(e)||d.isString(e)||d.isArguments(e))?e.length===0:d.keys(e).length===0},d.isElement=function(e){return!!e&&e.nodeType===1},d.isArray=f||function(e){return u.call(e)==="[object Array]"},d.isObject=function(e){var t=typeof e;return t==="function"||t==="object"&&!!e},d.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){d["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(e){return d.has(e,"callee")}),typeof /./!="function"&&typeof Int8Array!="object"&&(d.isFunction=function(e){return typeof e=="function"||!1}),d.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},d.isNaN=function(e){return d.isNumber(e)&&e!==+e},d.isBoolean=function(e){return e===!0||e===!1||u.call(e)==="[object Boolean]"},d.isNull=function(e){return e===null},d.isUndefined=function(e){return e===void 0},d.has=function(e,t){return e!=null&&a.call(e,t)},d.noConflict=function(){return e._=t,this},d.identity=function(e){return e},d.constant=function(e){return function(){return e}},d.noop=function(){},d.property=b,d.propertyOf=function(e){return e==null?function(){}:function(t){return e[t]}},d.matcher=d.matches=function(e){return e=d.extendOwn({},e),function(t){return d.isMatch(t,e)}},d.times=function(e,t,n){var r=Array(Math.max(0,e));t=v(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},d.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},d.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=d.invert(D),H=function(e){var t=function(t){return e[t]},n="(?:"+d.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=e==null?"":""+e,r.test(e)?e.replace(i,t):e}};d.escape=H(D),d.unescape=H(P),d.result=function(e,t,n){var r=e==null?void 0:e[t];return r===void 0&&(r=n),d.isFunction(r)?r.call(e):r};var B=0;d.uniqueId=function(e){var t=++B+"";return e?e+t:t},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+F[e]};d.template=function(e,t,n){!t&&n&&(t=n),t=d.defaults({},t,d.templateSettings);var r=RegExp([(t.escape||j).source,(t.interpolate||j).source,(t.evaluate||j).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(I,q),i=u+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(t.variable||"obj","_",s)}catch(u){throw u.source=s,u}var a=function(e){return o.call(this,e,d)},f=t.variable||"obj";return a.source="function("+f+"){\n"+s+"}",a},d.chain=function(e){var t=d(e);return t._chain=!0,t};var R=function(e,t){return e._chain?d(t).chain():t};d.mixin=function(e){d.each(d.functions(e),function(t){var n=d[t]=e[t];d.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),R(this,n.apply(d,e))}})},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];d.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0],R(this,n)}}),d.each(["concat","join","slice"],function(e){var t=n[e];d.prototype[e]=function(){return R(this,t.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return""+this._wrapped},typeof define=="function"&&define.amd&&define("underscore",[],function(){return d})}).call(this),function(e,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}(typeof window!="undefined"?window:this,function(window,noGlobal){function isArraylike(e){var t="length"in e&&e.length,n=jQuery.type(e);return n==="function"||jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(risSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return indexOf.call(t,e)>=0!==n})}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(rnotwhite)||[],function(e,n){t[n]=!0}),t}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Data.uid++}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?jQuery.parseJSON(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=0,r=e.length;for(;n<r;n++)data_priv.set(e[n],"globalEval",!t||data_priv.get(t[n],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=data_priv.set(t,s),f=s.events;if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function actualDisplay(e,t){var n,r=jQuery(t.createElement(e)).appendTo(t.body),i=window.getDefaultComputedStyle&&(n=window.getDefaultComputedStyle(r[0]))?n.display:jQuery.css(r[0],"display");return r.detach(),i}function defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=iframe[0].contentDocument,t.write(),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function curCSS(e,t,n){var r,i,s,o,u=e.style;return n=n||getStyles(e),n&&(o=n.getPropertyValue(t)||n[t]),n&&(o===""&&!jQuery.contains(e.ownerDocument,e)&&(o=jQuery.style(e,t)),rnumnonpx.test(o)&&rmargin.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),o!==undefined?o+"":o}function addGetHookIf(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function vendorPropName(e,t){if(t in e)return t;var n=t[0].toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(support.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",defaultDisplay(r.nodeName)))):(i=isHidden(r),(n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function genFx(e,t){var n,r=0,i={height:e};t=t?1:0;for(;r<4;r+=2-t)n=cssExpand[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function createTween(e,t,n){var r,i=(tweeners[t]||[]).concat(tweeners["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f,l,c=this,h={},p=e.style,d=e.nodeType&&isHidden(e),v=data_priv.get(e,"fxshow");n.queue||(u=jQuery._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,c.always(function(){c.always(function(){u.unqueued--,jQuery.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],f=jQuery.css(e,"display"),l=f==="none"?data_priv.get(e,"olddisplay")||defaultDisplay(e.nodeName):f,l==="inline"&&jQuery.css(e,"float")==="none"&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(rfxtypes.exec(i)){delete t[r],s=s||i==="toggle";if(i===(d?"hide":"show")){if(i!=="show"||!v||v[r]===undefined)continue;d=!0}h[r]=v&&v[r]||jQuery.style(e,r)}else f=undefined}if(!jQuery.isEmptyObject(h)){v?"hidden"in v&&(d=v.hidden):v=data_priv.access(e,"fxshow",{}),s&&(v.hidden=!d),d?jQuery(e).show():c.done(function(){jQuery(e).hide()}),c.done(function(){var t;data_priv.remove(e,"fxshow");for(t in h)jQuery.style(e,t,h[t])});for(r in h)o=createTween(d?v[r]:0,r,c),r in v||(v[r]=o.start,d&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}else(f==="none"?defaultDisplay(e.nodeName):f)==="inline"&&(p.display=f)}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return jQuery.map(l,createTween,f),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},document=window.document,version="2.1.4",jQuery=function(e,t){return new jQuery.fn.init(e,t)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(e){return e!=null?e<0?this[e+this.length]:this[e]:slice.call(this)},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[u]||{},u++),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!jQuery.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e)?!1:e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?class2type[toString.call(e)]||"object":typeof e},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":(e+"").replace(rtrim,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:indexOf.call(t,e,n)},merge:function(e,t){var n=+t.length,r=0,i=e.length;for(;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length,u=!n;for(;s<o;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&u.push(r);else for(i in e)r=t(e[i],i,n),r!=null&&u.push(r);return concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()});var Sizzle=function(e){function ot(e,t,r,i){var s,u,f,l,c,d,g,y,S,x;(t?t.ownerDocument||t:E)!==p&&h(t),t=t||p,r=r||[],l=t.nodeType;if(typeof e!="string"||!e||l!==1&&l!==9&&l!==11)return r;if(!i&&v){if(l!==11&&(s=Z.exec(e)))if(f=s[1]){if(l===9){u=t.getElementById(f);if(!u||!u.parentNode)return r;if(u.id===f)return r.push(u),r}else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&b(t,u)&&u.id===f)return r.push(u),r}else{if(s[2])return D.apply(r,t.getElementsByTagName(e)),r;if((f=s[3])&&n.getElementsByClassName)return D.apply(r,t.getElementsByClassName(f)),r}if(n.qsa&&(!m||!m.test(e))){y=g=w,S=t,x=l!==1&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){d=o(e),(g=t.getAttribute("id"))?y=g.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=d.length;while(c--)d[c]=y+gt(d[c]);S=et.test(e)&&vt(t.parentNode)||t,x=d.join(",")}if(x)try{return D.apply(r,S.querySelectorAll(x)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return a(e.replace(z,"$1"),t,r,i)}function ut(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function at(e){return e[w]=!0,e}function ft(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function ct(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||L)-(~e.sourceIndex||L);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(e){return e&&typeof e.getElementsByTagName!="undefined"&&e}function mt(){}function gt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=x++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[S,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[w]||(t[w]={});if((u=a[r])&&u[0]===S&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n){var r=0,i=t.length;for(;r<i;r++)ot(e,t[r],n);return n}function Et(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function St(e,t,n,r,i,s){return r&&!r[w]&&(r=St(r)),i&&!i[w]&&(i=St(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||wt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?Et(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=Et(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?H(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=Et(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):D.apply(o,g)})}function xt(e){var t,n,i,s=e.length,o=r.relative[e[0].type],u=o||r.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return H(t,e)>-1},u,!0),h=[function(e,n,r){var i=!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r));return t=null,i}];for(;a<s;a++)if(n=r.relative[e[a].type])h=[yt(bt(h),n)];else{n=r.filter[e[a].type].apply(null,e[a].matches);if(n[w]){i=++a;for(;i<s;i++)if(r.relative[e[i].type])break;return St(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(z,"$1"),n,a<i&&xt(e.slice(a,i)),i<s&&xt(e=e.slice(i)),i<s&&gt(e))}h.push(n)}return bt(h)}function Tt(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,u,a,l){var c,h,d,v=0,m="0",g=s&&[],y=[],b=f,w=s||i&&r.find.TAG("*",l),E=S+=b==null?1:Math.random()||.1,x=w.length;l&&(f=o!==p&&o);for(;m!==x&&(c=w[m])!=null;m++){if(i&&c){h=0;while(d=e[h++])if(d(c,o,u)){a.push(c);break}l&&(S=E)}n&&((c=!d&&c)&&v--,s&&g.push(c))}v+=m;if(n&&m!==v){h=0;while(d=t[h++])d(g,y,o,u);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=M.call(a));y=Et(y)}D.apply(a,y),l&&!s&&y.length>0&&v+t.length>1&&ot.uniqueSort(a)}return l&&(S=E,f=b),g};return n?at(s):s}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w="sizzle"+1*new Date,E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=function(e,t){return e===t&&(c=!0),0},L=1<<31,A={}.hasOwnProperty,O=[],M=O.pop,_=O.push,D=O.push,P=O.slice,H=function(e,t){var n=0,r=e.length;for(;n<r;n++)if(e[n]===t)return n;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",I=F.replace("w","w#"),q="\\["+j+"*("+F+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+j+"*\\]",R=":("+F+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|"+".*"+")\\)|)",U=new RegExp(j+"+","g"),z=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),W=new RegExp("^"+j+"*,"+j+"*"),X=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),V=new RegExp("="+j+"*([^\\]'\"]*?)"+j+"*\\]","g"),$=new RegExp(R),J=new RegExp("^"+I+"$"),K={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+j+"?|("+j+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)},it=function(){h()};try{D.apply(O=P.call(E.childNodes),E.childNodes),O[E.childNodes.length].nodeType}catch(st){D={apply:O.length?function(e,t){_.apply(e,P.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=ot.support={},s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},h=ot.setDocument=function(e){var t,i,o=e?e.ownerDocument||e:E;if(o===p||o.nodeType!==9||!o.documentElement)return p;p=o,d=o.documentElement,i=o.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",it,!1):i.attachEvent&&i.attachEvent("onunload",it)),v=!s(o),n.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ft(function(e){return e.appendChild(o.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(o.getElementsByClassName),n.getById=ft(function(e){return d.appendChild(e).id=w,!o.getElementsByName||!o.getElementsByName(w).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!="undefined"&&v){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!="undefined")return t.getElementsByTagName(e);if(n.qsa)return t.querySelectorAll(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(v)return t.getElementsByClassName(e)},g=[],m=[];if(n.qsa=Y.test(o.querySelectorAll))ft(function(e){d.appendChild(e).innerHTML="<a id='"+w+"'></a>"+"<select id='"+w+"-\f]' msallowcapture=''>"+"<option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+j+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+j+"*(?:value|"+B+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]")}),ft(function(e){var t=o.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+j+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")});return(n.matchesSelector=Y.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ft(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),g.push("!=",R)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Y.test(d.compareDocumentPosition),b=t||Y.test(d.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return c=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,r&1||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===o||e.ownerDocument===E&&b(E,e)?-1:t===o||t.ownerDocument===E&&b(E,t)?1:l?H(l,e)-H(l,t):0:r&4?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,i=e.parentNode,s=t.parentNode,u=[e],a=[t];if(!i||!s)return e===o?-1:t===o?1:i?-1:s?1:l?H(l,e)-H(l,t):0;if(i===s)return ct(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[r]===a[r])r++;return r?ct(u[r],a[r]):u[r]===E?-1:a[r]===E?1:0},o},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){(e.ownerDocument||e)!==p&&h(e),t=t.replace(V,"='$1']");if(n.matchesSelector&&v&&(!g||!g.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var i=r.attrHandle[t.toLowerCase()],s=i&&A.call(r.attrHandle,t.toLowerCase())?i(e,t,!v):undefined;return s!==undefined?s:n.attributes||!v?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},ot.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,s=0;c=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(k);if(c){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return l=null,e},i=ot.getText=function(e){var t,n="",r=0,s=e.nodeType;if(!s)while(t=e[r++])n+=i(t);else if(s===1||s===9||s===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(s===3||s===4)return e.nodeValue;return n},r=ot.selectors={cacheLength:50,createPseudo:at,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+j+")"+e+"("+j+"|$)"))&&T(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!="undefined"&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i.replace(U," ")+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[w]||(c[w]={}))[e]=[S,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return i[w]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=H(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:at(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[w]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return e=e.replace(nt,rt),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:at(function(e){return J.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[n<0?n+t:n]}),even:dt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ht(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pt(t);return mt.prototype=r.filters=r.pseudos,r.setFilters=new mt,o=ot.tokenize=function(e,t){var n,i,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){if(!n||(i=W.exec(u)))i&&(u=u.slice(i[0].length)||u),a.push(s=[]);n=!1;if(i=X.exec(u))n=i.shift(),s.push({value:n,type:i[0].replace(z," ")}),u=u.slice(n.length);for(o in r.filter)(i=K[o].exec(u))&&(!f[o]||(i=f[o](i)))&&(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)},u=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=o(e)),n=t.length;while(n--)s=xt(t[n]),s[w]?r.push(s):i.push(s);s=C(e,Tt(i,r)),s.selector=e}return s},a=ot.select=function(e,t,i,s){var a,f,l,c,h,p=typeof e=="function"&&e,d=!s&&o(e=p.selector||e);i=i||[];if(d.length===1){f=d[0]=d[0].slice(0);if(f.length>2&&(l=f[0]).type==="ID"&&n.getById&&t.nodeType===9&&v&&r.relative[f[1].type]){t=(r.find.ID(l.matches[0].replace(nt,rt),t)||[])[0];if(!t)return i;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}a=K.needsContext.test(e)?0:f.length;while(a--){l=f[a];if(r.relative[c=l.type])break;if(h=r.find[c])if(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&vt(t.parentNode)||t)){f.splice(a,1),e=s.length&&gt(f);if(!e)return D.apply(i,s),i;break}}}return(p||u(e,d))(s,t,!v,i,et.test(e)&&vt(t.parentNode)||t),i},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!c,h(),n.sortDetached=ft(function(e){return e.compareDocumentPosition(p.createElement("div"))&1}),ft(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||lt("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&lt("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),ft(function(e){return e.getAttribute("disabled")==null})||lt(B,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),ot}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},jQuery.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if(typeof e!="string")return this.pushStack(jQuery(e).filter(function(){for(t=0;t<n;t++)if(jQuery.contains(i[t],this))return!0}));for(t=0;t<n;t++)jQuery.find(e,i[t],r);return r=this.pushStack(n>1?jQuery.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},not:function(e){return this.pushStack(winnow(this,e||[],!0))},is:function(e){return!!winnow(this,typeof e=="string"&&rneedsContext.test(e)?jQuery(e):e||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(e,t){var n,r;if(!e)return this;if(typeof e=="string"){e[0]==="<"&&e[e.length-1]===">"&&e.length>=3?n=[null,e,null]:n=rquickExpr.exec(e);if(n&&(n[1]||!t)){if(n[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(n[1])&&jQuery.isPlainObject(t))for(n in t)jQuery.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=document.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=document,this.selector=e,this}return!t||t.jquery?(t||rootjQuery).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?typeof rootjQuery.ready!="undefined"?rootjQuery.ready(e):e(jQuery):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}}),jQuery.fn.extend({has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?indexOf.call(jQuery(e),this[0]):indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return e.contentDocument||jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),rparentsprev.test(e)&&i.reverse()),this.pushStack(i)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return u&&(!n||a)&&(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}});var readyList;jQuery.fn.ready=function(e){return jQuery.ready.promise().done(e),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.ready.promise();var access=jQuery.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s};jQuery.acceptData=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))jQuery.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&typeof t=="string"&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,jQuery.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):(i=jQuery.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(rnotwhite)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(e===undefined){if(this.length){i=data_user.get(s);if(s.nodeType===1&&!data_priv.get(s,"hasDataAttrs")){n=o.length;while(n--)o[n]&&(r=o[n].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.slice(5)),dataAttr(s,r,i[r])));data_priv.set(s,"hasDataAttrs",!0)}}return i}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):access(this,function(t){var n,r=jQuery.camelCase(e);if(s&&t===undefined){n=data_user.get(s,e);if(n!==undefined)return n;n=data_user.get(s,r);if(n!==undefined)return n;n=dataAttr(s,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)},rcheckableType=/^(?:checkbox|radio)$/i;(function(){var e=document.createDocumentFragment(),t=e.appendChild(document.createElement("div")),n=document.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),support.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(t){return typeof jQuery!==strundefined&&jQuery.event.triggered!==t.type?jQuery.event.dispatch.apply(e,arguments):undefined}),t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=hasOwn.call(e,"type")?e.type:e,p=hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&f.apply&&jQuery.acceptData(s)&&(e.result=f.apply(s,t),e.result===!1&&e.preventDefault());return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=document),e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===!1?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t);i||r.addEventListener(e,n,!0),data_priv.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t)-1;i?data_priv.access(r,t,i):(r.removeEventListener(e,n,!0),data_priv.remove(r,t))}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=t.createDocumentFragment(),c=[],h=0,p=e.length;for(;h<p;h++){i=e[h];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(c,i.nodeType?[i]:i);else if(!rhtml.test(i))c.push(t.createTextNode(i));else{s=s||l.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;jQuery.merge(c,s.childNodes),s=l.firstChild,s.textContent=""}}l.textContent="",h=0;while(i=c[h++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(l.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return l},cleanData:function(e){var t,n,r,i,s=jQuery.event.special,o=0;for(;(n=e[o])!==undefined;o++){if(jQuery.acceptData(n)){i=n[data_priv.expando];if(i&&(t=data_priv.cache[i])){if(t.events)for(r in t.events)s[r]?jQuery.event.remove(n,r):jQuery.removeEvent(n,r,t.handle);data_priv.cache[i]&&delete data_priv.cache[i]}}delete data_user.cache[n[data_user.expando]]}}}),jQuery.fn.extend({text:function(e){return access(this,function(e){return e===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.textContent=e})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,jQuery.cleanData(getAll(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=concat.apply([],e);var n,r,i,s,o,u,a=0,f=this.length,l=this,c=f-1,h=e[0],p=jQuery.isFunction(h);if(p||f>1&&typeof h=="string"&&!support.checkClone&&rchecked.test(h))return this.each(function(n){var r=l.eq(n);p&&(e[0]=h.call(this,n,r.html())),r.domManip(e,t)});if(f){n=jQuery.buildFragment(e,this[0].ownerDocument,!1,this),r=n.firstChild,n.childNodes.length===1&&(n=r);if(r){i=jQuery.map(getAll(n,"script"),disableScript),s=i.length;for(;a<f;a++)o=n,a!==c&&(o=jQuery.clone(o,!0,!0),s&&jQuery.merge(i,getAll(o,"script"))),t.call(this[a],o,a);if(s){u=i[i.length-1].ownerDocument,jQuery.map(i,restoreScript);for(a=0;a<s;a++)o=i[a],rscriptType.test(o.type||"")&&!data_priv.access(o,"globalEval")&&jQuery.contains(u,o)&&(o.src?jQuery._evalUrl&&jQuery._evalUrl(o.src):jQuery.globalEval(o.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),push.apply(r,n.get());return this.pushStack(r)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null)};(function(){function s(){i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",i.innerHTML="",n.appendChild(r);var s=window.getComputedStyle(i,null);e=s.top!=="1%",t=s.width==="4px",n.removeChild(r)}var e,t,n=document.documentElement,r=document.createElement("div"),i=document.createElement("div");if(!i.style)return;i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle=i.style.backgroundClip==="content-box",r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(i),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return s(),e},boxSizingReliable:function(){return t==null&&s(),t},reliableMarginRight:function(){var e,t=i.appendChild(document.createElement("div"));return t.style.cssText=i.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",i.style.width="1px",n.appendChild(r),e=!parseFloat(window.getComputedStyle(t,null).marginRight),n.removeChild(r),i.removeChild(t),e}})})(),jQuery.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||n!==n)return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return rdisplayswap.test(jQuery.css(e,"display"))&&e.offsetWidth===0?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)}),jQuery.fn.extend({css:function(e,t){return access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=rfxnum.exec(t),s=i&&i[3]||(jQuery.cssNumber[e]?"":"px"),o=(jQuery.cssNumber[e]||s!=="px"&&+r)&&rfxnum.exec(jQuery.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,jQuery.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.timers=[],jQuery.fx.tick=function(){var e,t=0,n=jQuery.timers;fxNow=jQuery.now();for(;t<n.length;t++)e=n[t],!e()&&n[t]===e&&n.splice(t--,1);n.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){jQuery.timers.push(e),e()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=document.createElement("input"),t=document.createElement("select"),n=t.appendChild(document.createElement("option"));e.type="checkbox",support.checkOn=e.value!=="",support.optSelected=n.selected,t.disabled=!0,support.optDisabled=!n.disabled,e=document.createElement("input"),e.value="t",e.type="radio",support.radioValue=e.value==="t"}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(e,t){return access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})}}),jQuery.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.bool.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(e,t){var n=attrHandle[t]||jQuery.find.attr;attrHandle[t]=function(e,t,r){var i,s;return r||(s=attrHandle[t],attrHandle[t]=i,i=n(e,t,r)!=null?t.toLowerCase():null,attrHandle[t]=s),i}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(e,t){return access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=jQuery.trim(r),n.className!==o&&(n.className=o)}}}return this},removeClass:function(e){var t,n,r,i,s,o,u=arguments.length===0||typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?jQuery.trim(r):"",n.className!==o&&(n.className=o)}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=jQuery(this),s=e.match(rnotwhite)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,jQuery(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{option:{get:function(e){var t=jQuery.find.attr(e,"value");return t!=null?t:jQuery.trim(jQuery.text(e))}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(r.value,s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(e){return JSON.parse(e+"")},jQuery.parseXML=function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204||l.type==="HEAD"?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=jQuery.event&&l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+nonce++):r+(rquery.test(r)?"&":"?")+"_="+nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery._evalUrl=function(e){return jQuery.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s=e.xhr(),o=++xhrId;s.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[o],t=s.onload=s.onerror=null,e==="abort"?s.abort():e==="error"?r(s.status,s.statusText):r(xhrSuccessStatus[s.status]||s.status,s.statusText,typeof s.responseText=="string"?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=xhrCallbacks[o]=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(u){if(t)throw u}},abort:function(){t&&t()}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.parseHTML=function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&i.length&&jQuery(i).remove(),jQuery.merge([],r.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=jQuery.trim(e.slice(u)),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]=addGetHookIf(support.pixelPosition,function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n})}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(e){var t=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global;if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore"),r;try{r=require("jquery")}catch(i){}e(t,exports,n,r)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.2.3",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,r){switch(e){case 1:return function(){return n[t](this[r])};case 2:return function(e){return n[t](this[r],e)};case 3:return function(e,i){return n[t](this[r],a(e,this),i)};case 4:return function(e,i,s){return n[t](this[r],a(e,this),i,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[r]),n[t].apply(n,e)}}},u=function(e,t,r){n.each(t,function(t,i){n[i]&&(e.prototype[i]=o(t,i,r))})},a=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?f(e):n.isString(e)?function(t){return t.get(e)}:e},f=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},l=t.Events={},c=/\s+/,h=function(e,t,r,i,s){var o=0,u;if(r&&typeof r=="object"){i!==void 0&&"context"in s&&s.context===void 0&&(s.context=i);for(u=n.keys(r);o<u.length;o++)t=h(e,t,u[o],r[u[o]],s)}else if(r&&c.test(r))for(u=r.split(c);o<u.length;o++)t=e(t,u[o],i,s);else t=e(t,r,i,s);return t};l.on=function(e,t,n){return p(this,e,t,n)};var p=function(e,t,n,r,i){e._events=h(d,e._events||{},t,n,{context:r,ctx:e,listening:i});if(i){var s=e._listeners||(e._listeners={});s[i.id]=i}return e};l.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),o=s[i];if(!o){var u=this._listenId||(this._listenId=n.uniqueId("l"));o=s[i]={obj:e,objId:i,id:u,listeningTo:s,count:0}}return p(e,t,r,this,o),this};var d=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,u=r.listening;u&&u.count++,i.push({callback:n,context:s,ctx:s||o,listening:u})}return e};l.off=function(e,t,n){return this._events?(this._events=h(v,this._events,e,t,{context:n,listeners:this._listeners}),this):this},l.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=e?[e._listenId]:n.keys(i);for(var o=0;o<s.length;o++){var u=i[s[o]];if(!u)break;u.obj.off(t,r,this)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var v=function(e,t,r,i){if(!e)return;var s=0,o,u=i.context,a=i.listeners;if(!t&&!r&&!u){var f=n.keys(a);for(;s<f.length;s++)o=a[f[s]],delete a[o.id],delete o.listeningTo[o.objId];return}var l=t?[t]:n.keys(e);for(;s<l.length;s++){t=l[s];var c=e[t];if(!c)break;var h=[];for(var p=0;p<c.length;p++){var d=c[p];r&&r!==d.callback&&r!==d.callback._callback||u&&u!==d.context?h.push(d):(o=d.listening,o&&--o.count===0&&(delete a[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}if(n.size(e))return e};l.once=function(e,t,r){var i=h(m,{},e,t,n.bind(this.off,this));return this.on(i,void 0,r)},l.listenToOnce=function(e,t,r){var i=h(m,{},t,r,n.bind(this.stopListening,this,e));return this.listenTo(e,i)};var m=function(e,t,r,i){if(r){var s=e[t]=n.once(function(){i(t,s),r.apply(this,arguments)});s._callback=r}return e};l.trigger=function(e){if(!this._events)return this;var t=Math.max(0,arguments.length-1),n=Array(t);for(var r=0;r<t;r++)n[r]=arguments[r+1];return h(g,this._events,e,void 0,n),this};var g=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&y(i,r),s&&y(s,[t].concat(r))}return e},y=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}};l.bind=l.on,l.unbind=l.off,n.extend(t,l);var b=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(e==null)return this;var i;typeof e=="object"?(i=e,r=t):(i={})[e]=t,r||(r={});if(!this._validate(i,r))return!1;var s=r.unset,o=r.silent,u=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=n.clone(this.attributes),this.changed={});var f=this.attributes,l=this.changed,c=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(f[h],t)||u.push(h),n.isEqual(c[h],t)?delete l[h]:l[h]=t,s?delete f[h]:f[h]=t;this.id=this.get(this.idAttribute);if(!o){u.length&&(this._pending=r);for(var p=0;p<u.length;p++)this.trigger("change:"+u[p],this,f[u[p]],r)}if(a)return this;if(!o)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,r={};for(var i in e){var s=e[i];if(n.isEqual(t[i],s))continue;r[i]=s}return n.size(r)?r:!1},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},R(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0,parse:!0},r);var s=r.wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,u=r.success,a=this.attributes;r.success=function(e){o.attributes=a;var t=r.parse?o.parse(e,r):e;s&&(t=n.extend({},i,t));if(t&&!o.set(t,r))return!1;u&&u.call(r.context,o,e,r),o.trigger("sync",o,e,r)},R(this,r),i&&s&&(this.attributes=n.extend({},a,i));var f=this.isNew()?"create":r.patch?"patch":"update";f==="patch"&&!r.attrs&&(r.attrs=i);var l=this.sync(f,this,r);return this.attributes=a,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):(R(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};u(b,w,"attributes");var E=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},T=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r=Array(e.length-n),i=t.length;for(var s=0;s<r.length;s++)r[s]=e[s+n];for(s=0;s<i;s++)e[s+n]=t[s];for(s=0;s<r.length;s++)e[s+i+n]=r[s]};n.extend(E.prototype,l,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,x))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:n.clone(e);var i=this._removeModels(e,t);return!t.silent&&i&&this.trigger("update",this,t),r?i[0]:i},set:function(e,t){if(e==null)return;t=n.defaults({},t,S),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;i!=null&&(i=+i),i<0&&(i+=this.length+1);var s=[],o=[],u=[],a={},f=t.add,l=t.merge,c=t.remove,h=!1,p=this.comparator&&i==null&&t.sort!==!1,d=n.isString(this.comparator)?this.comparator:null,v;for(var m=0;m<e.length;m++){v=e[m];var g=this.get(v);if(g){if(l&&v!==g){var y=this._isModel(v)?v.attributes:v;t.parse&&(y=g.parse(y,t)),g.set(y,t),p&&!h&&(h=g.hasChanged(d))}a[g.cid]||(a[g.cid]=!0,s.push(g)),e[m]=g}else f&&(v=e[m]=this._prepareModel(v,t),v&&(o.push(v),this._addReference(v,t),a[v.cid]=!0,s.push(v)))}if(c){for(m=0;m<this.length;m++)v=this.models[m],a[v.cid]||u.push(v);u.length&&this._removeModels(u,t)}var b=!1,w=!p&&f&&c;s.length&&w?(b=this.length!=s.length||n.some(this.models,function(e,t){return e!==s[t]}),this.models.length=0,T(this.models,s,0),this.length=this.models.length):o.length&&(p&&(h=!0),T(this.models,o,i==null?this.length:i),this.length=this.models.length),h&&this.sort({silent:!0});if(!t.silent){for(m=0;m<o.length;m++)i!=null&&(t.index=i+m),v=o[m],v.trigger("add",v,this,t);(h||b)&&this.trigger("sort",this,t),(o.length||u.length)&&this.trigger("update",this,t)}return r?e[0]:e},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(e==null)return void 0;var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),r===1||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},R(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var r=t.wait;e=this._prepareModel(e,t);if(!e)return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&i.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){var n=[];for(var r=0;r<e.length;r++){var i=this.get(e[r]);if(!i)continue;var s=this.indexOf(i);this.models.splice(s,1),this.length--,t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n.length?n:!1},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);n!=null&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);n!=null&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r);if(e==="change"){var i=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);i!==s&&(i!=null&&delete this._byId[i],s!=null&&(this._byId[s]=t))}this.trigger.apply(this,arguments)}});var N={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};u(E,N,"models");var C=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,L)),this._ensureElement(),this.initialize.apply(this,arguments)},k=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){e||(e=n.result(this,"events"));if(!e)return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[r]);if(!r)continue;var i=t.match(k);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=A[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||q()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1);var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.call(i.context,e,t,n)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,D=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(O.prototype,l,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(M,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var H=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,F=/#.*$/;H.started=!1,n.extend(H.prototype,l,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return e.charAt(0)==="/"?e.slice(1):e},getFragment:function(e){return e==null&&(this._usePushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(B,"")},start:function(e){if(H.started)throw new Error("Backbone.history has already been started");H.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!this.history&&!!this.history.pushState,this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(j,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),H.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})):!1},navigate:function(e,t){if(!H.started)return!1;if(!t||t===!0)t={trigger:!!t};e=this.getFragment(e||"");var n=this.root;if(e===""||e.charAt(0)==="?")n=n.slice(0,-1)||"/";var r=n+e;e=this.decodeFragment(e.replace(F,""));if(this.fragment===e)return;this.fragment=e;if(this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new H;var I=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};b.extend=E.extend=O.extend=C.extend=H.extend=I;var q=function(){throw new Error('A "url" property or function must be specified')},R=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}),function(e,t){if(typeof define=="function"&&define.amd)define("marionette",["backbone","underscore"],function(n,r){return e.Marionette=e.Mn=t(e,n,r)});else if(typeof exports!="undefined"){var n=require("backbone"),r=require("underscore");module.exports=t(e,n,r)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,function(e,t,n){"use strict";(function(e,t){var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===n)return delete this._indexByCustom[t],!0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(r){t.isFunction(r[e])&&r[e].apply(r,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(r,function(e){n.prototype[e]=function(){var n=t.values(this._views),r=[n].concat(t.toArray(arguments));return t[e].apply(t,r)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.10",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer})(t,n),function(e,t){var n=e.Wreqr,r=e.Wreqr={};return e.Wreqr.VERSION="1.3.5",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},r.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var r=null;t.isObject(e)&&!t.isFunction(e)&&(r=e.context,e=e.callback),this.setHandler(n,e,r)},this)},setHandler:function(e,t,n){var r={callback:t,context:n};this._wreqrHandlers[e]=r,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)return;return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),r.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),r.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var n=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,n):this.storage.addCommand(e,n)},_executeCommands:function(e,n,r){var i=this.storage.getCommands(e);t.each(i.instances,function(e){n.apply(r,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,r=e.storageType||this.storageType;t.isFunction(r)?n=new r:n=r,this.storage=n}})}(r,t),r.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){if(this.hasHandler(e))return this.getHandler(e).apply(this,t.rest(arguments))}})}(r,t),r.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),r.Channel=function(n){var r=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(r.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,r){if(!n)return;r=r||this;var i=e==="vent"?"on":"setHandler";t.each(n,function(n,s){this[e][i](s,t.bind(n,r))},this)}}),r}(r),r.radio=function(e,t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(r[e],function(t){this[e][t]=i(this,e,t)},this)},this)}});var r={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},i=function(e,n,r){return function(i){var s=e._getChannel(i)[n];return s[r].apply(s,t.rest(arguments))}};return new n}(r,t),e.Wreqr}(t,n);var r=e.Marionette,i=e.Mn,s=t.Marionette={};s.VERSION="2.4.3",s.noConflict=function(){return e.Marionette=r,e.Mn=i,this},t.Marionette=s,s.Deferred=t.$.Deferred,s.extend=t.Model.extend,s.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},s.mergeOptions=function(e,t){if(!e)return;n.extend(this,n.pick(e,t))},s.getOption=function(e,t){if(!e||!t)return;return e.options&&e.options[t]!==undefined?e.options[t]:e[t]},s.proxyGetOption=function(e){return s.getOption(this,e)},s._getValue=function(e,t,r){return n.isFunction(e)&&(e=r?e.apply(t,r):e.call(t)),e},s.normalizeMethods=function(e){return n.reduce(e,function(e,t,r){return n.isFunction(t)||(t=this[t]),t&&(e[r]=t),e},{},this)},s.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},s.normalizeUIKeys=function(e,t){return n.reduce(e,function(e,n,r){var i=s.normalizeUIString(r,t);return e[i]=n,e},{})},s.normalizeUIValues=function(e,t,r){return n.each(e,function(i,o){n.isString(i)?e[o]=s.normalizeUIString(i,t):n.isObject(i)&&n.isArray(r)&&(n.extend(i,s.normalizeUIValues(n.pick(i,r),t)),n.each(r,function(e){var r=i[e];n.isString(r)&&(i[e]=s.normalizeUIString(r,t))}))}),e},s.actAsCollection=function(e,t){var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(r,function(r){e[r]=function(){var e=n.values(n.result(this,t)),i=[e].concat(n.toArray(arguments));return n[r].apply(n,i)}})};var o=s.deprecate=function(e,t){n.isObject(e)&&(e=e.prev+" is going to be removed in the future. "+"Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),(t===undefined||!t)&&!o._cache[e]&&(o._warn("Deprecation warning: "+e),o._cache[e]=!0)};o._warn=typeof console!="undefined"&&(console.warn||console.log)||function(){},o._cache={},s._triggerMethod=function(){function t(e,t,n){return n.toUpperCase()}var e=/(^|:)(\w)/gi;return function(r,i,s){var o=arguments.length<3;o&&(s=i,i=s[0]);var u="on"+i.replace(e,t),a=r[u],f;return n.isFunction(a)&&(f=a.apply(r,o?n.rest(s):s)),n.isFunction(r.trigger)&&(o+s.length>1?r.trigger.apply(r,o?s:[i].concat(n.drop(s,0))):r.trigger(i)),f}}(),s.triggerMethod=function(e){return s._triggerMethod(this,arguments)},s.triggerMethodOn=function(e){var t=n.isFunction(e.triggerMethod)?e.triggerMethod:s.triggerMethod;return t.apply(e,n.rest(arguments))},s.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,r()}function n(){e._isRendered=!0,r()}function r(){e._isShown&&e._isRendered&&s.isNodeAttached(e.el)&&s.triggerMethodOn(e,"dom:refresh",e)}if(e._isDomRefreshMonitored)return;e._isDomRefreshMonitored=!0,e.on({show:t,render:n})},function(e){function t(t,r,i,s){var o=s.split(/\s+/);n.each(o,function(n){var s=t[n];if(!s)throw new e.Error('Method "'+n+'" was configured as an event handler, but does not exist.');t.listenTo(r,i,s)})}function r(e,t,n,r){e.listenTo(t,n,r)}function i(e,t,r,i){var s=i.split(/\s+/);n.each(s,function(n){var i=e[n];e.stopListening(t,r,i)})}function s(e,t,n,r){e.stopListening(t,n,r)}function o(t,r,i,s,o){if(!r||!i)return;if(!n.isObject(i))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});i=e._getValue(i,t),n.each(i,function(e,i){n.isFunction(e)?s(t,r,i,e):o(t,r,i,e)})}e.bindEntityEvents=function(e,n,i){o(e,n,i,r,t)},e.unbindEntityEvents=function(e,t,n){o(e,t,n,s,i)},e.proxyBindEntityEvents=function(t,n){return e.bindEntityEvents(this,t,n)},e.proxyUnbindEntityEvents=function(t,n){return e.unbindEntityEvents(this,t,n)}}(s);var u=["description","fileName","lineNumber","name","message","number"];return s.Error=s.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+s.VERSION+"/",constructor:function(e,t){n.isObject(e)?(t=e,e=t.message):t||(t={});var r=Error.call(this,e);n.extend(this,n.pick(r,u),n.pick(t,u)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,s.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),s.Error.extend=s.extend,s.Callbacks=function(){this._deferred=s.Deferred(),this._callbacks=[]},n.extend(s.Callbacks.prototype,{add:function(e,t){var r=n.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),r.then(function(n){t&&(n.context=t),e.call(n.context,n.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=s.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),s.Controller=function(e){this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},s.Controller.extend=s.extend,n.extend(s.Controller.prototype,t.Events,{destroy:function(){return s._triggerMethod(this,"before:destroy",arguments),s._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption}),s.Object=function(e){this.options=n.extend({},n.result(this,"options"),e),this.initialize.apply(this,arguments)},s.Object.extend=s.extend,n.extend(s.Object.prototype,t.Events,{initialize:function(){},destroy:function(){return this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Region=s.Object.extend({constructor:function(e){this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el;if(!this.el)throw new s.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),s.Object.call(this,e)},show:function(e,t){if(!this._ensureElement())return;this._ensureViewIsIntact(e),s.MonitorDOMRefresh(e);var r=t||{},i=e!==this.currentView,o=!!r.preventDestroy,u=!!r.forceShow,a=!!this.currentView,f=i&&!o,l=i||u;a&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&delete this.currentView._parent,f?this.empty():a&&l&&this.currentView.off("destroy",this.empty,this);if(l){e.once("destroy",this.empty,this),this._renderView(e),e._parent=this,a&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),s.triggerMethodOn(e,"before:show",e,this,t),a&&this.triggerMethod("swapOut",this.currentView,this,t);var c=s.isNodeAttached(this.el),h=[],p=n.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},r);return c&&p.triggerBeforeAttach&&(h=this._displayedViews(e),this._triggerAttach(h,"before:")),this.attachHtml(e),this.currentView=e,c&&p.triggerAttach&&(h=this._displayedViews(e),this._triggerAttach(h)),a&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),s.triggerMethodOn(e,"show",e,this,t),this}return this},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var r=(t||"")+"attach";n.each(e,function(e){s.triggerMethodOn(e,r,e,this)},this)},_displayedViews:function(e){return n.union([e],n.result(e,"_getNestedViews")||[])},_renderView:function(e){e.supportsRenderLifecycle||s.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||s.triggerMethodOn(e,"render",e)},_ensureElement:function(){n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]);if(!this.$el||this.$el.length===0){if(this.getOption("allowMissingEl"))return!1;throw new s.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new s.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,s._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,n=e||{},r=!!n.preventDestroy;if(!t)return;return t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),r||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,r&&this.$el.contents().detach(),this},_destroyView:function(){var e=this.currentView;if(e.isDestroyed)return;e.supportsDestroyLifecycle||s.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():(e.remove(),e.isDestroyed=!0),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"destroy",e)},attachView:function(e){return this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(n.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(n.isFunction(e))return this._buildRegionFromRegionClass(e);throw new s.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var r=e.regionClass||t,i=n.omit(e,"selector","regionClass");return e.selector&&!i.el&&(i.el=e.selector),new r(i)},_buildRegionFromRegionClass:function(e){return new e}}),s.RegionManager=s.Controller.extend({constructor:function(e){this._regions={},this.length=0,s.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=s._getValue(e,this,arguments),n.reduce(e,function(e,r,i){return n.isString(r)&&(r={selector:r}),r.selector&&(r=n.defaults({},r,t)),e[i]=this.addRegion(i,r),e},{},this)},addRegion:function(e,t){var n;return t instanceof s.Region?n=t:n=s.Region.buildRegion(t,s.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return n.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return n.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),s.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),s.actAsCollection(s.RegionManager.prototype,"_regions"),s.TemplateCache=function(e){this.templateId=e},n.extend(s.TemplateCache,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new s.TemplateCache(e),this.templateCaches[e]=n),n.load(t)},clear:function(){var e,t=n.toArray(arguments),r=t.length;if(r>0)for(e=0;e<r;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(s.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,n){var r=t.$(e);if(!r.length)throw new s.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return r.html()},compileTemplate:function(e,t){return n.template(e,t)}}),s.Renderer={render:function(e,t){if(!e)throw new s.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var r=n.isFunction(e)?e:s.TemplateCache.get(e);return r(t)}},s.View=t.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(e){this.render=n.bind(this.render,this),e=s._getValue(e,this),this.options=n.extend({},n.result(this,"options"),e),this._behaviors=s.Behaviors(this),t.View.call(this,this.options),s.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,n.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=s._getValue(t,this),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"_uiBindings");return s.normalizeUIKeys(e,t||n.result(this,"ui"))},normalizeUIValues:function(e,t){var r=n.result(this,"ui"),i=n.result(this,"_uiBindings");return s.normalizeUIValues(e,i||r,t)},configureTriggers:function(){if(!this.triggers)return;var e=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(e,function(e,t,n){return e[n]=this._buildViewTrigger(t),e},{},this)},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var r=s._getValue(e||this.events,this);r=this.normalizeUIKeys(r),n.isUndefined(e)&&(this.events=r);var i={},o=n.result(this,"behaviorEvents")||{},u=this.configureTriggers(),a=n.result(this,"behaviorTriggers")||{};n.extend(i,o,r,u,a),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(!this.ui)return;this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(e,function(e,t){this.ui[t]=this.$(e)},this)},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){if(!this.ui||!this._uiBindings)return;n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings},_buildViewTrigger:function(e){var t=n.defaults({},e,{preventDefault:!0,stopPropagation:!0}),r=n.isObject(e)?t.event:e;return function(e){e&&(e.preventDefault&&t.preventDefault&&e.preventDefault(),e.stopPropagation&&t.stopPropagation&&e.stopPropagation());var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,n)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=s._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),e},_triggerEventOnBehaviors:function(e){var t=s._triggerMethod,n=this._behaviors;for(var r=0,i=n&&n.length;r<i;r++)t(n[r],e)},_triggerEventOnParentLayout:function(e,t){var r=this._parentLayoutView();if(!r)return;var i=s.getOption(r,"childViewEventPrefix"),o=i+":"+e,u=[this].concat(t);s._triggerMethod(r,o,u);var a=s.getOption(r,"childEvents"),f=r.normalizeMethods(a);f&&n.isFunction(f[e])&&f[e].apply(r,u)},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?n.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_getAncestors:function(){var e=[],t=this._parent;while(t)e.push(t),t=t._parent;return e},_parentLayoutView:function(){var e=this._getAncestors();return n.find(e,function(e){return e instanceof s.LayoutView})},normalizeMethods:s.normalizeMethods,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.ItemView=s.View.extend({constructor:function(){s.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e===!1)return;if(!e)throw new s.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),n=s.Renderer.render(e,t,this);return this.attachElContent(n),this},attachElContent:function(e){return this.$el.html(e),this}}),s.CollectionView=s.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(e){this.once("render",this._initialEvents),this._initChildViewStorage(),s.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e=this._isShown&&s.isNodeAttached(this.el),t;this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),e&&this._triggerBeforeAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),e&&this._triggerAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,r){var i=n.drop(arguments,3);n.each(e,function(e){s.triggerMethodOn.apply(e,[e,r,e,t].concat(i))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,r){var i=r.at!==undefined&&(r.index||t.indexOf(e));if(this.getOption("filter")||i===!1)i=n.indexOf(this._filteredSortedModels(i),e);if(this._shouldAddChild(e,i)){this.destroyEmptyView();var s=this.getChildView(e);this.addChild(e,s,i)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){s.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){s.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels(),r=n.find(t,function(t){return!e.findByModel(t)});if(r)this.render();else{var i=n.map(t,function(t,n){var r=e.findByModel(t);return r._index=n,r.el});this.triggerMethod("before:reorder"),this._appendReorderedChildren(i),this.triggerMethod("reorder")}},resortView:function(){s.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=n.find(e,function(e,t){var n=this.children.findByModel(e);return!n||n._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();n.each(t,function(t,n){e=this.getChildView(t),this.addChild(t,e,n)},this)},_filteredSortedModels:function(e){var t=this.getViewComparator(),r=this.collection.models;e=Math.min(Math.max(e,0),r.length-1);if(t){var i;e&&(i=r[e],r=r.slice(0,e).concat(r.slice(e+1))),r=this._sortModelsBy(r,t),i&&r.splice(e,0,i)}return this.getOption("filter")&&(r=n.filter(r,function(e,t){return this._shouldAddChild(e,t)},this)),r},_sortModelsBy:function(e,t){return typeof t=="string"?n.sortBy(e,function(e){return e.get(t)},this):t.length===1?n.sortBy(e,t,this):e.sort(n.bind(t,this))},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new t.Model;this.addEmptyView(n,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var r=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el),i,o=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(o)&&(o=o.call(this,e,this._emptyViewIndex));var u=this.buildChildView(e,t,o);u._parent=this,this.proxyChildEvents(u),u.once("render",function(){this._isShown&&s.triggerMethodOn(u,"before:show",u),r&&this._triggerBeforeAttach&&(i=this._getViewAndNested(u),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(u),this.renderChildView(u,this._emptyViewIndex),r&&this._triggerAttach&&(i=this._getViewAndNested(u),this._triggerMethodMany(i,this,"attach")),this._isShown&&s.triggerMethodOn(u,"show",u)},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new s.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,n){var r=this.getOption("childViewOptions");r=s._getValue(r,this,[e,n]);var i=this.buildChildView(e,t,r);return this._updateIndices(i,!0,n),this.triggerMethod("before:add:child",i),this._addChildView(i,n),this.triggerMethod("add:child",i),i._parent=this,i},_updateIndices:function(e,t,n){if(!this.getOption("sort"))return;t&&(e._index=n),this.children.each(function(n){n._index>=e._index&&(n._index+=t?1:-1)})},_addChildView:function(e,t){var n=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el),r;this.proxyChildEvents(e),e.once("render",function(){this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"before:show",e),n&&this._triggerBeforeAttach&&(r=this._getViewAndNested(e),this._triggerMethodMany(r,this,"before:attach"))},this),this.children.add(e),this.renderChildView(e,t),n&&this._triggerAttach&&(r=this._getViewAndNested(e),this._triggerMethodMany(r,this,"attach")),this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.supportsRenderLifecycle||s.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||s.triggerMethodOn(e,"render",e),this.attachHtml(this,e,t),e},buildChildView:function(e,t,r){var i=n.extend({model:e},r),o=new t(i);return s.MonitorDOMRefresh(o),o},removeChildView:function(e){return e?(this.triggerMethod("before:remove:child",e),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():e.remove(),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"destroy",e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1),e):e},isEmpty:function(){return!this.collection||this.collection.length===0},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return n.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,n){e.isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,t){var n,r=this.getOption("sort")&&t<this.children.length-1;return r&&(n=this.children.find(function(e){return e._index===t+1})),n?(n.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),s.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},r=!0,i=this.children.map(n.identity);return n.isUndefined(t.checkEmpty)||(r=t.checkEmpty),this.children.each(this.removeChildView,this),r&&this.checkEmpty(),i},_shouldAddChild:function(e,t){var r=this.getOption("filter");return!n.isFunction(r)||r.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var r=n.toArray(arguments),i=r[0],s=this.normalizeMethods(n.result(this,"childEvents"));r[0]=t+":"+i,r.splice(1,0,e),typeof s!="undefined"&&n.isFunction(s[i])&&s[i].apply(this,r.slice(1)),this.triggerMethod.apply(this,r)})},_getImmediateChildren:function(){return n.values(this.children._views)},_getViewAndNested:function(e){return[e].concat(n.result(e,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),s.CompositeView=s.CollectionView.extend({constructor:function(){s.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var e={};return this.model&&(e=n.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&s.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),n=s.Renderer.render(t,e,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var n=this.getChildViewContainer(e);n.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(!e.$childViewContainer){var n,r=s.getOption(e,"childViewContainer");if(r){var i=s._getValue(r,e);i.charAt(0)==="@"&&e.ui?n=e.ui[i.substr(4)]:n=e.$(i);if(n.length<=0)throw new s.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else n=e.$el;return e.$childViewContainer=n,n}return e.$childViewContainer},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=undefined)}}),s.LayoutView=s.ItemView.extend({regionClass:s.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),s.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),s.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),s.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t){return this.getRegion(e).show(t)},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=s._getValue(this.regions,this,[e])||{};var r=this.getOption.call(e,"regions");r=s._getValue(r,this,[e]),n.extend(t,r),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new s.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),s.Behavior=s.Object.extend({constructor:function(e,t){this.view=t,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,e),this.ui=n.extend({},n.result(t,"ui"),n.result(this,"ui")),s.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),s.Behaviors=function(e,t){function r(e,n){return t.isObject(e.behaviors)?(n=r.parseBehaviors(e,n||t.result(e,"behaviors")),r.wrap(e,n,t.keys(i)),n):{}}function s(e,t){this._view=e,this._behaviors=t,this._triggers={}}function o(e){return e._uiBindings||e.ui}var n=/^(\S+)\s*(.*)$/,i={behaviorTriggers:function(e,t){var n=new s(this,t);return n.buildBehaviorTriggers()},behaviorEvents:function(r,i){var s={};return t.each(i,function(r,i){var u={},a=t.clone(t.result(r,"events"))||{};a=e.normalizeUIKeys(a,o(r));var f=0;t.each(a,function(e,s){var o=s.match(n),a=o[1]+"."+[this.cid,i,f++," "].join(""),l=o[2],c=a+l,h=t.isFunction(e)?e:r[e];u[c]=t.bind(h,r)},this),s=t.extend(s,u)},this),s}};return t.extend(r,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,n){return t.behaviorClass?t.behaviorClass:e._getValue(r.behaviorsLookup,this,[t,n])[n]},parseBehaviors:function(e,n){return t.chain(n).map(function(n,i){var s=r.getBehaviorClass(n,i),o=new s(n,e),u=r.parseBehaviors(e,t.result(o,"behaviors"));return[o].concat(u)}).flatten().value()},wrap:function(e,n,r){t.each(r,function(r){e[r]=t.partial(i[r],e[r],n)})}}),t.extend(s.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,r){var i=t.clone(t.result(n,"triggers"))||{};i=e.normalizeUIKeys(i,o(n)),t.each(i,t.bind(this._setHandlerForBehavior,this,n,r))},_setHandlerForBehavior:function(e,t,n,r){var i=r.replace(/^\S+/,function(e){return e+"."+"behaviortriggers"+t});this._triggers[i]=this._view._buildViewTrigger(n)}}),r}(s,n),s.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var n=this.getOption("appRoutes"),r=this._getController();this.processAppRoutes(r,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},_processOnRoute:function(e,t){if(n.isFunction(this.onRoute)){var r=n.invert(this.getOption("appRoutes"))[e];this.onRoute(e,r,t)}},processAppRoutes:function(e,t){if(!t)return;var r=n.keys(t).reverse();n.each(r,function(n){this._addAppRoute(e,n,t[n])},this)},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,r){var i=e[r];if(!i)throw new s.Error('Method "'+r+'" was not found on the controller');this.route(t,r,n.bind(i,e))},mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,triggerMethod:s.triggerMethod,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Application=s.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new s.Callbacks,this.submodules={},n.extend(this,e),this._initChannel(),s.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var r=s.Module.getClass(t),i=n.toArray(arguments);return i.unshift(this),r.create.apply(r,i)},getRegionManager:function(){return new s.RegionManager},_initializeRegions:function(e){var t=n.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var r=s.getOption(e,"regions");return n.isFunction(r)&&(r=r.call(this,e)),n.extend(t,r),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){s._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,s._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){s._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],s._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),s.Module=function(e,t,r){this.moduleName=e,this.options=n.extend({},this.options,r),this.initialize=r.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,n.isFunction(this.initialize)&&this.initialize(e,t,this.options)},s.Module.extend=s.extend,n.extend(s.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){if(this._isInitialized)return;n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e)},stop:function(){if(!this._isInitialized)return;this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(undefined,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop")},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,r){if(!e)return;var i=n.flatten([this,this.app,t,s,t.$,n,r]);e.apply(this,i)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new s.Callbacks,this._finalizerCallbacks=new s.Callbacks},triggerMethod:s.triggerMethod}),n.extend(s.Module,{create:function(e,t,r){var i=e,s=n.drop(arguments,3);t=t.split(".");var o=t.length,u=[];return u[o-1]=r,n.each(t,function(t,n){var o=i;i=this._getModule(o,t,e,r),this._addModuleDefinition(o,i,u[n],s)},this),i},_getModule:function(e,t,r,i,s){var o=n.extend({},i),u=this.getClass(i),a=e[t];return a||(a=new u(t,r,o),e[t]=a,e.submodules[t]=a),a},getClass:function(e){var t=s.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,r){var i=this._getDefine(n),s=this._getStartWithParent(n,t);i&&t.addDefinition(i,r),this._addStartWithParent(e,t,s)},_getStartWithParent:function(e,t){var r;return n.isFunction(e)&&e.prototype instanceof s.Module?(r=t.constructor.prototype.startWithParent,n.isUndefined(r)?!0:r):n.isObject(e)?(r=e.startWithParent,n.isUndefined(r)?!0:r):!0},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof s.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n;if(!t.startWithParent||!!t.startWithParentIsConfigured)return;t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)})}}),s}),define("polyfills/bind",["underscore"],function(e){typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(){return e.bind.apply(null,[this].concat(Array.prototype.slice.call(arguments)))})}),define("app",["marionette","polyfills/bind"],function(e){var t=new e.Application;return t}),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt={}.hasOwnProperty,wt=function(e,t){function r(){this.constructor=e}for(var n in t)bt.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},Et=[].slice,St=function(e,t){return function(){return e.apply(t,arguments)}};e={toString:function(){return"Bacon"}},e.version="0.7.74",c=(typeof global!="undefined"&&global!==null?global:this).Error,it=function(){},Q=function(e,t){return t},W=function(e,t){return e},D=function(e){return e.slice(0)},N=function(e,t){if(!t)throw new c(e)},M=function(e){if(e instanceof v&&!(e instanceof m))throw new c("Observable is not a Property : "+e)},k=function(e){if(!(e instanceof l))throw new c("not an EventStream : "+e)},O=function(e){if(!(e instanceof v))throw new c("not an Observable : "+e)},L=function(e){return N("not a function : "+e,E.isFunction(e))},$=function(e){return e instanceof Array},K=function(e){return e instanceof v},C=function(e){if(!$(e))throw new c("not an array : "+e)},A=function(e){return N("no arguments supported",e.length===0)},_=function(e){if(typeof e!="string")throw new c("not a string : "+e)},E={indexOf:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){var n,r,i,s;for(n=r=0,i=e.length;r<i;n=++r){s=e[n];if(t===s)return n}return-1},indexWhere:function(e,t){var n,r,i,s;for(n=r=0,i=e.length;r<i;n=++r){s=e[n];if(t(s))return n}return-1},head:function(e){return e[0]},always:function(e){return function(){return e}},negate:function(e){return function(t){return!e(t)}},empty:function(e){return e.length===0},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){var n,r,i,s;n=[];for(r=0,i=t.length;r<i;r++)s=t[r],e(s)&&n.push(s);return n},map:function(e,t){var n,r,i,s;i=[];for(n=0,r=t.length;n<r;n++)s=t[n],i.push(e(s));return i},each:function(e,t){var n,r;for(n in e){if(!bt.call(e,n))continue;r=e[n],t(n,r)}return void 0},toArray:function(e){return $(e)?e:[e]},contains:function(e,t){return E.indexOf(e,t)!==-1},id:function(e){return e},last:function(e){return e[e.length-1]},all:function(e,t){var n,r,i;t==null&&(t=E.id);for(n=0,r=e.length;n<r;n++){i=e[n];if(!t(i))return!1}return!0},any:function(e,t){var n,r,i;t==null&&(t=E.id);for(n=0,r=e.length;n<r;n++){i=e[n];if(t(i))return!0}return!1},without:function(e,t){return E.filter(function(t){return t!==e},t)},remove:function(e,t){var n;n=E.indexOf(t,e);if(n>=0)return t.splice(n,1)},fold:function(e,t,n){var r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],t=n(t,s);return t},flatMap:function(e,t){return E.fold(t,[],function(t,n){return t.concat(e(n))})},cached:function(e){var t;return t=d,function(){return t===d&&(t=e(),e=void 0),t}},isFunction:function(e){return typeof e=="function"},toString:function(e){var t,n,r,i;try{return ot++,e==null?"undefined":E.isFunction(e)?"function":$(e)?ot>5?"[..]":"["+E.map(E.toString,e).toString()+"]":(e!=null?e.toString:void 0)!=null&&e.toString!==Object.prototype.toString?e.toString():typeof e=="object"?ot>5?"{..}":(n=function(){var n;n=[];for(r in e){if(!bt.call(e,r))continue;i=function(){try{return e[r]}catch(n){return t=n,t}}(),n.push(E.toString(r)+":"+E.toString(i))}return n}(),"{"+n+"}"):e}finally{ot--}}},ot=0,e._=E,w=e.UpdateBarrier=function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return l=void 0,c=[],h={},n=[],r=0,t=function(e){return l?n.push(e):e()},p=function(e,t){var n;return l?(n=h[e.id],n==null?(n=h[e.id]=[t],c.push(e)):n.push(t)):t()},s=function(){while(c.length>0)u(0);return void 0},u=function(e){var t,n,r,i,s,u;i=c[e],s=i.id,u=h[s],c.splice(e,1),delete h[s],o(i);for(n=0,r=u.length;n<r;n++)t=u[n],t();return void 0},o=function(e){var t,n,r,i,s;n=e.internalDeps();for(i=0,s=n.length;i<s;i++)t=n[i],o(t),h[t.id]&&(r=E.indexOf(c,t),u(r));return void 0},f=function(e,t,i,o){var u,a;if(l)return i.apply(t,o);l=e;try{a=i.apply(t,o),s()}finally{l=void 0;while(r<n.length)u=n[r],r++,u();r=0,n=[]}return a},i=function(){return l?l.id:void 0},d=function(n,r){var i,s,o,u;return u=!1,s=!1,i=function(){return s=!0},o=function(){return u=!0,i()},i=n.dispatcher.subscribe(function(n){return t(function(){var t;if(!u){t=r(n);if(t===e.noMore)return o()}})}),s&&i(),o},a=function(){return c.length>0},{whenDoneWith:p,hasWaiters:a,inTransaction:f,currentEventId:i,wrappedSubscribe:d,afterTransaction:t}}(),b=function(){function e(e,t,n){this.obs=e,this.sync=t,this.lazy=n!=null?n:!1,this.queue=[]}return e.prototype.subscribe=function(e){return this.obs.dispatcher.subscribe(e)},e.prototype.toString=function(){return this.obs.toString()},e.prototype.markEnded=function(){return this.ended=!0},e.prototype.consume=function(){return this.lazy?{value:E.always(this.queue[0])}:this.queue[0]},e.prototype.push=function(e){return this.queue=[e]},e.prototype.mayHave=function(){return!0},e.prototype.hasAtLeast=function(){return this.queue.length},e.prototype.flatten=!0,e}(),i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return wt(t,e),t.prototype.consume=function(){return this.queue.shift()},t.prototype.push=function(e){return this.queue.push(e)},t.prototype.mayHave=function(e){return!this.ended||this.queue.length>=e},t.prototype.hasAtLeast=function(e){return this.queue.length>=e},t.prototype.flatten=!1,t}(b),t=function(e){function t(e){t.__super__.constructor.call(this,e,!0)}return wt(t,e),t.prototype.consume=function(){var e;return e=this.queue,this.queue=[],{value:function(){return e}}},t.prototype.push=function(e){return this.queue.push(e.value())},t.prototype.hasAtLeast=function(){return!0},t}(b),b.isTrigger=function(e){return e instanceof b?e.sync:e instanceof l},b.fromObservable=function(e){return e instanceof b?e:e instanceof m?new b(e,!1):new i(e,!0)},s=function(){function e(e,t,n){this.context=e,this.method=t,this.args=n}return e.prototype.deps=function(){return this.cached||(this.cached=R([this.context].concat(this.args)))},e.prototype.toString=function(){return E.toString(this.context)+"."+E.toString(this.method)+"("+E.map(E.toString,this.args)+")"},e}(),j=function(){var e,t,n;return t=arguments[0],n=arguments[1],e=3<=arguments.length?Et.call(arguments,2):[],(t||n)instanceof s?t||n:new s(t,n,e)},gt=function(e,t){return t.desc=e,t},R=function(e){return $(e)?E.flatMap(R,e):K(e)?[e]:e instanceof b?[e.obs]:[]},e.Desc=s,e.Desc.empty=new e.Desc("","",[]),yt=function(e){return function(){var t,n,r,i;return r=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],typeof r=="object"&&t.length&&(n=r,i=t[0],r=function(){return n[i].apply(n,arguments)},t=t.slice(1)),e.apply(null,[r].concat(Et.call(t)))}},Z=function(e){return e=Array.prototype.slice.call(e),et.apply(null,e)},st=function(e,t){return function(){var n;return n=1<=arguments.length?Et.call(arguments,0):[],e.apply(null,t.concat(n))}},vt=function(e){return function(t){return function(n){var r;return n==null?void 0:(r=n[t],E.isFunction(r)?r.apply(n,e):r)}}},ht=function(e,t){var n,r;return r=e.slice(1).split("."),n=E.map(vt(t),r),function(t){var r,i;for(r=0,i=n.length;r<i;r++)e=n[r],t=e(t);return t}},J=function(e){return typeof e=="string"&&e.length>1&&e.charAt(0)==="."},et=yt(function(){var e,t;return t=arguments[0],e=2<=arguments.length?Et.call(arguments,1):[],E.isFunction(t)?e.length?st(t,e):t:J(t)?ht(t,e):E.always(t)}),Y=function(e,t){return et.apply(null,[e].concat(Et.call(t)))},B=function(e,t,n,r){var i;return t instanceof m?(i=t.sampledBy(e,function(e,t){return[e,t]}),r.call(i,function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1],n})):(t=Y(t,n),r.call(e,t))},lt=function(e){var t;if(E.isFunction(e))return e;if(J(e))return t=pt(e),function(e,n){return e[t](n)};throw new c("not a function or a field key: "+e)},pt=function(e){return e.slice(1)},y=function(){function e(e){this.value=e}return e.prototype.getOrElse=function(){return this.value},e.prototype.get=function(){return this.value},e.prototype.filter=function(t){return t(this.value)?new e(this.value):d},e.prototype.map=function(t){return new e(t(this.value))},e.prototype.forEach=function(e){return e(this.value)},e.prototype.isDefined=!0,e.prototype.toArray=function(){return[this.value]},e.prototype.inspect=function(){return"Some("+this.value+")"},e.prototype.toString=function(){return this.inspect()},e}(),d={getOrElse:function(e){return e},filter:function(){return d},map:function(){return d},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},dt=function(e){return e instanceof y||e===d?e:new y(e)},e.noMore=["<no-more>"],e.more=["<more>"],I=0,f=function(){function e(){this.id=++I}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(){return!0},e.prototype.inspect=function(){return this.toString()},e.prototype.log=function(){return this.toString()},e}(),p=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);t.__super__.constructor.call(this),!n&&E.isFunction(e)||e instanceof t?(this.valueF=e,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=e)}return wt(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.value=function(){return this.valueF instanceof t?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},t.prototype.fmap=function(e){var t,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return e(n)})):(t=this,this.apply(function(){return e(t.value())}))},t.prototype.apply=function(e){return new t(e)},t.prototype.filter=function(e){return e(this.value())},t.prototype.toString=function(){return E.toString(this.value())},t.prototype.log=function(){return this.value()},t}(f),h=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);t.__super__.constructor.call(this,e,n)}return wt(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return new t(e)},t.prototype.toNext=function(){return new p(this)},t}(p),u=function(e){function t(){if(!(this instanceof t))return new t}return wt(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<end>"},t}(f),a=function(e){function t(e){if(!(this instanceof t))return new t(e);this.error=e}return wt(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<error> "+E.toString(this.error)},t}(f),e.Event=f,e.Initial=h,e.Next=p,e.End=u,e.Error=a,V=function(e){return new h(e,!0)},rt=function(e){return new p(e,!0)},F=function(){return new u},ct=function(e){return e instanceof f?e:rt(e)},X=0,at=function(){},v=function(){function e(e){this.desc=e,this.id=++X,this.initialDesc=this.desc}return e.prototype.subscribe=function(e){return w.wrappedSubscribe(this,e)},e.prototype.subscribeInternal=function(e){return this.dispatcher.subscribe(e)},e.prototype.onValue=function(){var e;return e=Z(arguments),this.subscribe(function(t){if(t.hasValue())return e(t.value())})},e.prototype.onValues=function(e){return this.onValue(function(t){return e.apply(null,t)})},e.prototype.onError=function(){var e;return e=Z(arguments),this.subscribe(function(t){if(t.isError())return e(t.error)})},e.prototype.onEnd=function(){var e;return e=Z(arguments),this.subscribe(function(t){if(t.isEnd())return e()})},e.prototype.name=function(e){return this._name=e,this},e.prototype.withDescription=function(){return this.desc=j.apply(null,arguments),this},e.prototype.toString=function(){return this._name?this._name:this.desc.toString()},e.prototype.internalDeps=function(){return this.initialDesc.deps()},e}(),v.prototype.assign=v.prototype.onValue,v.prototype.forEach=v.prototype.onValue,v.prototype.inspect=v.prototype.toString,e.Observable=v,r=function(){function e(e){var t,n,r;e==null&&(e=[]),this.unsubscribe=St(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(t=0,n=e.length;t<n;t++)r=e[t],this.add(r)}return e.prototype.add=function(e){var t,n,r;if(this.unsubscribed)return;return t=!1,n=it,this.starting.push(e),r=function(r){return function(){if(r.unsubscribed)return;return t=!0,r.remove(n),E.remove(e,r.starting)}}(this),n=e(this.unsubscribe,r),!this.unsubscribed&&!t?this.subscriptions.push(n):n(),E.remove(e,this.starting),n},e.prototype.remove=function(e){if(this.unsubscribed)return;if(E.remove(e,this.subscriptions)!==void 0)return e()},e.prototype.unsubscribe=function(){var e,t,n,r;if(this.unsubscribed)return;this.unsubscribed=!0,n=this.subscriptions;for(e=0,t=n.length;e<t;e++)r=n[e],r();return this.subscriptions=[],this.starting=[]},e.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},e.prototype.empty=function(){return this.count()===0},e}(),e.CompositeUnsubscribe=r,o=function(){function t(e,t){this._subscribe=e,this._handleEvent=t,this.subscribe=St(this.subscribe,this),this.handleEvent=St(this.handleEvent,this),this.subscriptions=[],this.queue=[]}return t.prototype.pushing=!1,t.prototype.ended=!1,t.prototype.prevError=void 0,t.prototype.unsubSrc=void 0,t.prototype.hasSubscribers=function(){return this.subscriptions.length>0},t.prototype.removeSub=function(e){return this.subscriptions=E.without(e,this.subscriptions)},t.prototype.push=function(e){return e.isEnd()&&(this.ended=!0),w.inTransaction(e,this,this.pushIt,[e])},t.prototype.pushToSubscriptions=function(t){var n,r,i,s,o,u;try{u=this.subscriptions;for(r=0,i=u.length;r<i;r++)o=u[r],s=o.sink(t),(s===e.noMore||t.isEnd())&&this.removeSub(o);return!0}catch(a){throw n=a,this.pushing=!1,this.queue=[],n}},t.prototype.pushIt=function(t){if(!this.pushing){if(t===this.prevError)return;t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;while(this.queue.length)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?e.more:(this.unsubscribeFromSource(),e.noMore)}return this.queue.push(t),e.more},t.prototype.handleEvent=function(e){return this._handleEvent?this._handleEvent(e):this.push(e)},t.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},t.prototype.subscribe=function(e){var t;return this.ended?(e(F()),it):(L(e),t={sink:e},this.subscriptions.push(t),this.subscriptions.length===1&&(this.unsubSrc=this._subscribe(this.handleEvent),L(this.unsubSrc)),function(e){return function(){e.removeSub(t);if(!e.hasSubscribers())return e.unsubscribeFromSource()}}(this))},t}(),e.Dispatcher=o,l=function(t){function n(e,t,r){if(!(this instanceof n))return new n(e,t,r);E.isFunction(e)&&(r=t,t=e,e=s.empty),n.__super__.constructor.call(this,e),L(t),this.dispatcher=new o(t,r),at(this)}return wt(n,t),n.prototype.toProperty=function(t){var n,r;return r=arguments.length===0?d:dt(function(){return t}),n=this.dispatcher,new m(new e.Desc(this,"toProperty",[t]),function(t){var i,s,o,u;return i=!1,u=it,s=e.more,o=function(){if(!i)return r.forEach(function(n){i=!0,s=t(new h(n));if(s===e.noMore)return u(),u=it})},u=n.subscribe(function(n){if(n.hasValue())return i&&n.isInitial()?e.more:(n.isInitial()||o(),i=!0,r=new y(n),t(n));n.isEnd()&&(s=o());if(s!==e.noMore)return t(n)}),o(),u})},n.prototype.toEventStream=function(){return this},n.prototype.withHandler=function(t){return new n(new e.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)},n}(v),e.EventStream=l,e.never=function(){return new l(j(e,"never"),function(e){return e(F()),it})},e.when=function(){var t,n,r,i,s,o,u,a,f,c,h,p,d,v,m,g,y,S,x,T;if(arguments.length===0)return e.never();u=arguments.length,T="when: expecting arguments in the form (Observable+,function)+",N(T,u%2===0),S=[],d=[],n=0,v=[];while(n<u){v[n]=arguments[n],v[n+1]=arguments[n+1],p=E.toArray(arguments[n]),t=P(arguments[n+1]),h={f:t,ixs:[]},x=!1;for(s=0,a=p.length;s<a;s++){y=p[s],r=E.indexOf(S,y),x||(x=b.isTrigger(y)),r<0&&(S.push(y),r=S.length-1),m=h.ixs;for(o=0,f=m.length;o<f;o++)i=m[o],i.index===r&&i.count++;h.ixs.push({index:r,count:1})}N("At least one EventStream required",x||!p.length),p.length>0&&d.push(h),n+=2}return S.length?(S=E.map(b.fromObservable,S),c=E.any(S,function(e){return e.flatten})&&H(E.map(function(e){return e.obs},S)),g=new l(new e.Desc(e,"when",v),function(t){var r,i,s,o,u,a,f;return f=[],s=!1,o=function(e){var t,r,i;i=e.ixs;for(t=0,r=i.length;t<r;t++){n=i[t];if(!S[n.index].hasAtLeast(n.count))return!1}return!0},i=function(e){return!e.sync||e.ended},r=function(e){var t,r,i;i=e.ixs;for(t=0,r=i.length;t<r;t++){n=i[t];if(!S[n.index].mayHave(n.count))return!0}},u=function(e){return!e.source.flatten},a=function(a){return function(l){var h,p,v;return p=function(){return w.whenDoneWith(g,h)},v=function(){var r,i,s,a,l,c;if(!(f.length>0))return e.more;l=e.more,c=f.pop();for(i=0,s=d.length;i<s;i++){a=d[i];if(o(a))return r=function(){var e,t,r,i;r=a.ixs,i=[];for(t=0,e=r.length;t<e;t++)n=r[t],i.push(S[n.index].consume());return i}(),l=t(c.e.apply(function(){var e,t;return t=function(){var t,n,i;i=[];for(n=0,t=r.length;n<t;n++)e=r[n],i.push(e.value());return i}(),a.f.apply(a,t)})),f.length&&(f=E.filter(u,f)),l===e.noMore?l:v()}},h=function(){var n;return n=v(),s&&(E.all(S,i)||E.all(d,r))&&(n=e.noMore,t(F())),n===e.noMore&&l(),n},a.subscribe(function(n){var r;return n.isEnd()?(s=!0,a.markEnded(),p()):n.isError()?r=t(n):(a.push(n),a.sync&&(f.push({source:a,e:n}),c||w.hasWaiters()?p():h())),r===e.noMore&&l(),r||e.more})}},(new e.CompositeUnsubscribe(function(){var e,t,n;n=[];for(e=0,t=S.length;e<t;e++)y=S[e],n.push(a(y));return n}())).unsubscribe})):e.never()},H=function(e,t){var n;return t==null&&(t=[]),n=function(e){var r;return E.contains(t,e)?!0:(r=e.internalDeps(),r.length?(t.push(e),E.any(r,n)):(t.push(e),!1))},E.any(e,n)},P=function(e){return E.isFunction(e)?e:E.always(e)},e.groupSimultaneous=function(){var n,r,i;return i=1<=arguments.length?Et.call(arguments,0):[],i.length===1&&$(i[0])&&(i=i[0]),r=function(){var e,r,s;s=[];for(e=0,r=i.length;e<r;e++)n=i[e],s.push(new t(n));return s}(),gt(new e.Desc(e,"groupSimultaneous",i),e.when(r,function(){var e;return e=1<=arguments.length?Et.call(arguments,0):[],e}))},g=function(t){function n(e,t,r){this.property=e,this.subscribe=St(this.subscribe,this),n.__super__.constructor.call(this,t,r),this.current=d,this.currentValueRootId=void 0,this.propertyEnded=!1}return wt(n,t),n.prototype.push=function(e){return e.isEnd()&&(this.propertyEnded=!0),e.hasValue()&&(this.current=new y(e),this.currentValueRootId=w.currentEventId()),n.__super__.push.call(this,e)},n.prototype.maybeSubSource=function(t,n){return n===e.noMore?it:this.propertyEnded?(t(F()),it):o.prototype.subscribe.call(this,t)},n.prototype.subscribe=function(t){var n,r,i,s;return r=!1,i=e.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(n=w.currentEventId(),s=this.currentValueRootId,!this.propertyEnded&&s&&n&&n!==s?(w.whenDoneWith(this.property,function(e){return function(){if(e.currentValueRootId===s)return t(V(e.current.get().value()))}}(this)),this.maybeSubSource(t,i)):(w.inTransaction(void 0,this,function(){return i=t(V(this.current.get().value()))},[]),this.maybeSubSource(t,i))):this.maybeSubSource(t,i)},n}(o),m=function(t){function n(e,t,r){n.__super__.constructor.call(this,e),L(t),this.dispatcher=new g(this,t,r),at(this)}return wt(n,t),n.prototype.changes=function(){return new l(new e.Desc(this,"changes",[]),function(e){return function(t){return e.dispatcher.subscribe(function(e){if(!e.isInitial())return t(e)})}}(this))},n.prototype.withHandler=function(t){return new n(new e.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)},n.prototype.toProperty=function(){return A(arguments),this},n.prototype.toEventStream=function(){return new l(new e.Desc(this,"toEventStream",[]),function(e){return function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()&&(e=e.toNext()),t(e)})}}(this))},n}(v),e.Property=m,e.constant=function(t){return new m(new e.Desc(e,"constant",[t]),function(e){return e(V(t)),e(F()),it})},e.fromBinder=function(t,n){return n==null&&(n=E.id),new l(new e.Desc(e,"fromBinder",[t,n]),function(r){var i,s,o,u;return u=!1,i=!1,s=function(){if(!u)return typeof o!="undefined"&&o!==null?(o(),u=!0):i=!0},o=t(function(){var t,i,o,u,a,l;t=1<=arguments.length?Et.call(arguments,0):[],l=n.apply(this,t),$(l)&&E.last(l)instanceof f||(l=[l]),a=e.more;for(o=0,u=l.length;o<u;o++){i=l[o],a=r(i=ct(i));if(a===e.noMore||i.isEnd())return s(),a}return a}),i&&s(),s})},q=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],U=function(e){var t,n,r,i;for(t=0,n=q.length;t<n;t++){i=q[t],r=[e[i[0]],e[i[1]]];if(r[0]&&r[1])return r}throw new a("No suitable event methods in "+e)},e.fromEventTarget=function(t,n,r){var i,s,o;return i=U(t),s=i[0],o=i[1],gt(new e.Desc(e,"fromEvent",[t,n]),e.fromBinder(function(e){return s.call(t,n,e),function(){return o.call(t,n,e)}},r))},e.fromEvent=e.fromEventTarget,e.Observable.prototype.map=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],B(this,n,t,function(t){return gt(new e.Desc(this,"map",[t]),this.withHandler(function(e){return this.push(e.fmap(t))}))})},x=function(e){return $(e[0])?e[0]:Array.prototype.slice.call(e)},T=function(e){return E.isFunction(e[0])?[x(Array.prototype.slice.call(e,1)),e[0]]:[x(Array.prototype.slice.call(e,0,e.length-1)),E.last(e)]},e.combineAsArray=function(){var t,n,r,i,s,o,u;u=x(arguments);for(t=n=0,r=u.length;n<r;t=++n)o=u[t],K(o)||(u[t]=e.constant(o));return u.length?(s=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++)i=u[e],n.push(new b(i,!0));return n}(),gt(new e.Desc(e,"combineAsArray",u),e.when(s,function(){var e;return e=1<=arguments.length?Et.call(arguments,0):[],e}).toProperty())):e.constant([])},e.onValues=function(){var t,n,r;return r=2<=arguments.length?Et.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],e.combineAsArray(r).onValues(t)},e.combineWith=function(){var t,n,r;return n=T(arguments),r=n[0],t=n[1],gt(new e.Desc(e,"combineWith",[t].concat(Et.call(r))),e.combineAsArray(r).map(function(e){return t.apply(null,e)}))},e.Observable.prototype.combine=function(t,n){var r;return r=lt(n),gt(new e.Desc(this,"combine",[t,n]),e.combineAsArray(this,t).map(function(e){return r(e[0],e[1])}))},e.Observable.prototype.withStateMachine=function(t,n){var r;return r=t,gt(new e.Desc(this,"withStateMachine",[t,n]),this.withHandler(function(t){var i,s,o,u,a,f,l;i=n(r,t),u=i[0],f=i[1],r=u,l=e.more;for(s=0,o=f.length;s<o;s++){a=f[s],l=this.push(a);if(l===e.noMore)return l}return l}))},e.Observable.prototype.skipDuplicates=function(t){return t==null&&(t=function(e,t){return e===t}),gt(new e.Desc(this,"skipDuplicates",[]),this.withStateMachine(d,function(e,n){return n.hasValue()?n.isInitial()||e===d||!t(e.get(),n.value())?[new y(n.value()),[n]]:[e,[]]:[e,[n]]}))},e.Observable.prototype.awaiting=function(t){return gt(new e.Desc(this,"awaiting",[t]),e.groupSimultaneous(this,t).map(function(e){var t,n;return t=e[0],n=e[1],n.length===0}).toProperty(!1).skipDuplicates())},e.Observable.prototype.not=function(){return gt(new e.Desc(this,"not",[]),this.map(function(e){return!e}))},e.Property.prototype.and=function(t){return gt(new e.Desc(this,"and",[t]),this.combine(t,function(e,t){return e&&t}))},e.Property.prototype.or=function(t){return gt(new e.Desc(this,"or",[t]),this.combine(t,function(e,t){return e||t}))},e.scheduler={setTimeout:function(e,t){return setTimeout(e,t)},setInterval:function(e,t){return setInterval(e,t)},clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)},now:function(){return(new Date).getTime()}},e.EventStream.prototype.bufferWithTime=function(t){return gt(new e.Desc(this,"bufferWithTime",[t]),this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},e.EventStream.prototype.bufferWithCount=function(t){return gt(new e.Desc(this,"bufferWithCount",[t]),this.bufferWithTimeOrCount(void 0,t))},e.EventStream.prototype.bufferWithTimeOrCount=function(t,n){var r;return r=function(e){if(e.values.length===n)return e.flush();if(t!==void 0)return e.schedule()},gt(new e.Desc(this,"bufferWithTimeOrCount",[t,n]),this.buffer(t,r,r))},e.EventStream.prototype.buffer=function(t,n,r){var i,s,o;return n==null&&(n=it),r==null&&(r=it),i={scheduled:null,end:void 0,values:[],flush:function(){var t,n;this.scheduled&&(e.scheduler.clearTimeout(this.scheduled),this.scheduled=null);if(this.values.length>0){n=this.values,this.values=[],t=this.push(rt(n));if(this.end!=null)return this.push(this.end);if(t!==e.noMore)return r(this)}else if(this.end!=null)return this.push(this.end)},schedule:function(){if(!this.scheduled)return this.scheduled=t(function(e){return function(){return e.flush()}}(this))}},o=e.more,E.isFunction(t)||(s=t,t=function(t){return e.scheduler.setTimeout(t,s)}),gt(new e.Desc(this,"buffer",[]),this.withHandler(function(e){return i.push=function(e){return function(t){return e.push(t)}}(this),e.isError()?o=this.push(e):e.isEnd()?(i.end=e,i.scheduled||i.flush()):(i.values.push(e.value()),n(i)),o}))},e.Observable.prototype.filter=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],M(n),B(this,n,t,function(t){return gt(new e.Desc(this,"filter",[t]),this.withHandler(function(n){return n.filter(t)?this.push(n):e.more}))})},e.once=function(t){return new l(new s(e,"once",[t]),function(e){return e(ct(t)),e(F()),it})},e.EventStream.prototype.concat=function(t){var n;return n=this,new l(new e.Desc(n,"concat",[t]),function(e){var r,i;return i=it,r=n.dispatcher.subscribe(function(n){return n.isEnd()?i=t.dispatcher.subscribe(e):e(n)}),function(){return r(),i()}})},e.Observable.prototype.flatMap=function(){return z(this,nt(arguments))},e.Observable.prototype.flatMapFirst=function(){return z(this,nt(arguments),!0)},z=function(t,n,i,s){var o,u,a;return a=[t],o=[],u=new l(new e.Desc(t,"flatMap"+(i?"First":""),[n]),function(u){var a,f,l,c,p;return l=new r,c=[],p=function(t){var r;return r=tt(n(t.value())),o.push(r),l.add(function(t,n){return r.dispatcher.subscribe(function(i){var s;return i.isEnd()?(E.remove(r,o),f(),a(n),e.noMore):(i instanceof h&&(i=i.toNext()),s=u(i),s===e.noMore&&t(),s)})})},f=function(){var e;e=c.shift();if(e)return p(e)},a=function(e){e();if(l.empty())return u(F())},l.add(function(n,r){return t.dispatcher.subscribe(function(t){return t.isEnd()?a(r):t.isError()?u(t):i&&l.count()>1?e.more:l.unsubscribed?e.noMore:s&&l.count()>s?c.push(t):p(t)})}),l.unsubscribe}),u.internalDeps=function(){return o.length?a.concat(o):a},u},nt=function(e){return e.length===1&&K(e[0])?E.always(e[0]):Z(e)},tt=function(t){return K(t)?t:e.once(t)},e.Observable.prototype.flatMapWithConcurrencyLimit=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],gt(new e.Desc(this,"flatMapWithConcurrencyLimit",[n].concat(Et.call(t))),z(this,nt(t),!1,n))},e.Observable.prototype.flatMapConcat=function(){return gt(new e.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0)),this.flatMapWithConcurrencyLimit.apply(this,[1].concat(Et.call(arguments))))},e.later=function(t,n){return gt(new e.Desc(e,"later",[t,n]),e.fromBinder(function(r){var i,s;return s=function(){return r([n,F()])},i=e.scheduler.setTimeout(s,t),function(){return e.scheduler.clearTimeout(i)}}))},e.Observable.prototype.bufferingThrottle=function(t){return gt(new e.Desc(this,"bufferingThrottle",[t]),this.flatMapConcat(function(n){return e.once(n).concat(e.later(t).filter(!1))}))},e.Property.prototype.bufferingThrottle=function(){return e.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},n=function(t){function n(){this.guardedSink=St(this.guardedSink,this),this.subscribeAll=St(this.subscribeAll,this),this.unsubAll=St(this.unsubAll,this);if(!(this instanceof n))return new n;this.sink=void 0,this.subscriptions=[],this.ended=!1,n.__super__.constructor.call(this,new e.Desc(e,"Bus",[]),this.subscribeAll)}return wt(n,t),n.prototype.unsubAll=function(){var e,t,n,r;n=this.subscriptions;for(e=0,t=n.length;e<t;e++)r=n[e],typeof r.unsub=="function"&&r.unsub();return void 0},n.prototype.subscribeAll=function(e){var t,n,r,i;if(this.ended)e(F());else{this.sink=e,r=D(this.subscriptions);for(t=0,n=r.length;t<n;t++)i=r[t],this.subscribeInput(i)}return this.unsubAll},n.prototype.guardedSink=function(t){return function(n){return function(r){return r.isEnd()?(n.unsubscribeInput(t),e.noMore):n.sink(r)}}(this)},n.prototype.subscribeInput=function(e){return e.unsub=e.input.dispatcher.subscribe(this.guardedSink(e.input))},n.prototype.unsubscribeInput=function(e){var t,n,r,i,s;i=this.subscriptions;for(t=n=0,r=i.length;n<r;t=++n){s=i[t];if(s.input===e){typeof s.unsub=="function"&&s.unsub(),this.subscriptions.splice(t,1);return}}},n.prototype.plug=function(e){var t;O(e);if(this.ended)return;return t={input:e},this.subscriptions.push(t),this.sink!=null&&this.subscribeInput(t),function(t){return function(){return t.unsubscribeInput(e)}}(this)},n.prototype.end=function(){return this.ended=!0,this.unsubAll(),typeof this.sink=="function"?this.sink(F()):void 0},n.prototype.push=function(e){if(!this.ended)return typeof this.sink=="function"?this.sink(rt(e)):void 0},n.prototype.error=function(e){return typeof this.sink=="function"?this.sink(new a(e)):void 0},n}(l),e.Bus=n,G=function(t,n){return yt(function(){var r,i,s;return i=arguments[0],r=2<=arguments.length?Et.call(arguments,1):[],s=st(n,[function(e,t){return i.apply(null,Et.call(e).concat([t]))}]),gt(new e.Desc(e,t,[i].concat(Et.call(r))),e.combineAsArray(r).flatMap(s))})},e.fromCallback=G("fromCallback",function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],e.fromBinder(function(e){return Y(n,t)(e),it},function(e){return[e,F()]})}),e.fromNodeCallback=G("fromNodeCallback",function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],e.fromBinder(function(e){return Y(n,t)(e),it},function(e,t){return e?[new a(e),F()]:[t,F()]})}),e.combineTemplate=function(t){var n,r,i,s,o,u,a,f,l,c,h;return a=[],h=[],u=function(e){return e[e.length-1]},c=function(e,t,n){return u(e)[t]=n},n=function(e,t){return function(n,r){return c(n,e,r[t])}},o=function(e,t){return function(n){return c(n,e,t)}},f=function(e){return $(e)?[]:{}},l=function(e,t){return function(n){var r;return r=f(t),c(n,e,r),n.push(r)}},i=function(e,t){var r;return K(t)?(h.push(t),a.push(n(e,h.length-1))):t!==Object(t)||typeof t=="function"||t instanceof RegExp||t instanceof Date?a.push(o(e,t)):(r=function(e){return e.pop()},a.push(l(e,t)),s(t),a.push(r))},s=function(e){return E.each(e,i)},s(t),r=function(e){var n,r,i,s,o;o=f(t),n=[o];for(i=0,s=a.length;i<s;i++)r=a[i],r(n,e);return o},gt(new e.Desc(e,"combineTemplate",[t]),e.combineAsArray(h).map(r))},S=function(t,n){var r;return r=new l(j(t,"justInitValue"),function(n){var i,s;return s=void 0,i=t.dispatcher.subscribe(function(t){return t.isEnd()||(s=t),e.noMore}),w.whenDoneWith(r,function(){return s!=null&&n(s),n(F())}),i}),r.concat(n).toProperty()},e.Observable.prototype.mapEnd=function(){var t;return t=Z(arguments),gt(new e.Desc(this,"mapEnd",[t]),this.withHandler(function(n){return n.isEnd()?(this.push(rt(t(n))),this.push(F()),e.noMore):this.push(n)}))},e.Observable.prototype.skipErrors=function(){return gt(new e.Desc(this,"skipErrors",[]),this.withHandler(function(t){return t.isError()?e.more:this.push(t)}))},e.EventStream.prototype.takeUntil=function(t){var n;return n={},gt(new e.Desc(this,"takeUntil",[t]),e.groupSimultaneous(this.mapEnd(n),t.skipErrors()).withHandler(function(r){var i,s,o,u,a,f;if(!r.hasValue())return this.push(r);u=r.value(),i=u[0],t=u[1];if(t.length)return this.push(F());a=e.more;for(s=0,o=i.length;s<o;s++)f=i[s],f===n?a=this.push(F()):a=this.push(rt(f));return a}))},e.Property.prototype.takeUntil=function(t){var n;return n=this.changes().takeUntil(t),gt(new e.Desc(this,"takeUntil",[t]),S(this,n))},e.Observable.prototype.flatMapLatest=function(){var t,n;return t=nt(arguments),n=this.toEventStream(),gt(new e.Desc(this,"flatMapLatest",[t]),n.flatMap(function(e){return tt(t(e)).takeUntil(n)}))},e.Property.prototype.delayChanges=function(e,t){return gt(e,S(this,t(this.changes())))},e.EventStream.prototype.delay=function(t){return gt(new e.Desc(this,"delay",[t]),this.flatMap(function(n){return e.later(t,n)}))},e.Property.prototype.delay=function(t){return this.delayChanges(new e.Desc(this,"delay",[t]),function(e){return e.delay(t)})},e.EventStream.prototype.debounce=function(t){return gt(new e.Desc(this,"debounce",[t]),this.flatMapLatest(function(n){return e.later(t,n)}))},e.Property.prototype.debounce=function(t){return this.delayChanges(new e.Desc(this,"debounce",[t]),function(e){return e.debounce(t)})},e.EventStream.prototype.debounceImmediate=function(t){return gt(new e.Desc(this,"debounceImmediate",[t]),this.flatMapFirst(function(n){return e.once(n).concat(e.later(t).filter(!1))}))},e.Observable.prototype.decode=function(t){return gt(new e.Desc(this,"decode",[t]),this.combine(e.combineTemplate(t),function(e,t){return t[e]}))},e.Observable.prototype.scan=function(t,n){var r,i,s,o;return n=lt(n),r=dt(t),i=!1,o=function(t){return function(o){var u,a,f,l;return u=!1,l=it,a=e.more,f=function(){if(!u)return r.forEach(function(t){u=i=!0,a=o(new h(function(){return t}));if(a===e.noMore)return l(),l=it})},l=t.dispatcher.subscribe(function(t){var s,l;if(t.hasValue())return i&&t.isInitial()?e.more:(t.isInitial()||f(),u=i=!0,l=r.getOrElse(void 0),s=n(l,t.value()),r=new y(s),o(t.apply(function(){return s})));t.isEnd()&&(a=f());if(a!==e.noMore)return o(t)}),w.whenDoneWith(s,f),l}}(this),s=new m(new e.Desc(this,"scan",[t,n]),o)},e.Observable.prototype.diff=function(t,n){return n=lt(n),gt(new e.Desc(this,"diff",[t,n]),this.scan([t],function(e,t){return[t,n(e[0],t)]}).filter(function(e){return e.length===2}).map(function(e){return e[1]}))},e.Observable.prototype.doAction=function(){var t;return t=Z(arguments),gt(new e.Desc(this,"doAction",[t]),this.withHandler(function(e){return e.hasValue()&&t(e.value()),this.push(e)}))},e.Observable.prototype.doError=function(){var t;return t=Z(arguments),gt(new e.Desc(this,"doError",[t]),this.withHandler(function(e){return e.isError()&&t(e.error),this.push(e)}))},e.Observable.prototype.doLog=function(){var t;return t=1<=arguments.length?Et.call(arguments,0):[],gt(new e.Desc(this,"doLog",t),this.withHandler(function(e){return typeof console!="undefined"&&console!==null&&typeof console.log=="function"&&console.log.apply(console,Et.call(t).concat([e.log()])),this.push(e)}))},e.Observable.prototype.endOnError=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],n==null&&(n=!0),B(this,n,t,function(t){return gt(new e.Desc(this,"endOnError",[]),this.withHandler(function(e){return e.isError()&&t(e.error)?(this.push(e),this.push(F())):this.push(e)}))})},v.prototype.errors=function(){return gt(new e.Desc(this,"errors",[]),this.filter(function(){return!1}))},mt=function(e){return[e,F()]},e.fromPromise=function(t,n,r){return r==null&&(r=mt),gt(new e.Desc(e,"fromPromise",[t]),e.fromBinder(function(e){var r;return(r=t.then(e,function(t){return e(new a(t))}))!=null&&typeof r.done=="function"&&r.done(),function(){if(n)return typeof t.abort=="function"?t.abort():void 0}},r))},e.Observable.prototype.mapError=function(){var t;return t=Z(arguments),gt(new e.Desc(this,"mapError",[t]),this.withHandler(function(e){return e.isError()?this.push(rt(t(e.error))):this.push(e)}))},e.Observable.prototype.flatMapError=function(t){return gt(new e.Desc(this,"flatMapError",[t]),this.mapError(function(e){return new a(e)}).flatMap(function(n){return n instanceof a?t(n.error):e.once(n)}))},e.EventStream.prototype.sampledBy=function(t,n){return gt(new e.Desc(this,"sampledBy",[t,n]),this.toProperty().sampledBy(t,n))},e.Property.prototype.sampledBy=function(t,n){var r,i,s,o,u;return n!=null?n=lt(n):(r=!0,n=function(e){return e.value()}),u=new b(this,!1,r),s=new b(t,!0,r),o=e.when([u,s],n),i=t instanceof m?o.toProperty():o,gt(new e.Desc(this,"sampledBy",[t,n]),i)},e.Property.prototype.sample=function(t){return gt(new e.Desc(this,"sample",[t]),this.sampledBy(e.interval(t,{})))},e.Observable.prototype.map=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],n instanceof m?n.sampledBy(this,W):B(this,n,t,function(t){return gt(new e.Desc(this,"map",[t]),this.withHandler(function(e){return this.push(e.fmap(t))}))})},e.Observable.prototype.fold=function(t,n){return gt(new e.Desc(this,"fold",[t,n]),this.scan(t,n).sampledBy(this.filter(!1).mapEnd().toProperty()))},v.prototype.reduce=v.prototype.fold,e.fromPoll=function(t,n){return gt(new e.Desc(e,"fromPoll",[t,n]),e.fromBinder(function(n){var r;return r=e.scheduler.setInterval(n,t),function(){return e.scheduler.clearInterval(r)}},n))},e.Observable.prototype.groupBy=function(t,n){var r,i;return n==null&&(n=e._.id),i={},r=this,r.filter(function(e){return!i[t(e)]}).map(function(s){var o,u,a,f;return u=t(s),f=r.filter(function(e){return t(e)===u}),o=e.once(s).concat(f),a=n(o,s).withHandler(function(e){this.push(e);if(e.isEnd())return delete i[u]}),i[u]=a})},e.fromArray=function(t){var n;return C(t),t.length?(n=0,new l(new e.Desc(e,"fromArray",[t]),function(r){var i,s,o,u,a;return a=!1,u=e.more,o=!1,s=!1,i=function(){var f;s=!0;if(o)return;o=!0;while(s)s=!1,u!==e.noMore&&!a&&(f=t[n++],u=r(ct(f)),u!==e.noMore&&(n===t.length?r(F()):w.afterTransaction(i)));return o=!1},i(),function(){return a=!0}})):gt(new e.Desc(e,"fromArray",t),e.never())},e.EventStream.prototype.holdWhen=function(t){var n,i,s;return i=!1,n=[],s=this,new l(new e.Desc(this,"holdWhen",[t]),function(e){var o,u,a;return o=new r,a=!1,u=function(t){typeof t=="function"&&t();if(o.empty()&&a)return e(F())},o.add(function(r,s){return t.subscribeInternal(function(t){var r,o,a,f,l;if(!t.hasValue())return t.isEnd()?u(s):e(t);i=t.value();if(!i){f=n,n=[],a=[];for(r=0,o=f.length;r<o;r++)l=f[r],a.push(e(rt(l)));return a}})}),o.add(function(t,r){return s.subscribeInternal(function(t){return i&&t.hasValue()?n.push(t.value()):t.isEnd()&&n.length?u(r):e(t)})}),a=!0,u(),o.unsubscribe})},e.interval=function(t,n){return n==null&&(n={}),gt(new e.Desc(e,"interval",[t,n]),e.fromPoll(t,function(){return rt(n)}))},e.$={},e.$.asEventStream=function(t,n,r){var i;return E.isFunction(n)&&(i=[n,void 0],r=i[0],n=i[1]),gt(new e.Desc(this.selector||this,"asEventStream",[t]),e.fromBinder(function(e){return function(r){return e.on(t,n,r),function(){return e.off(t,n,r)}}}(this),r))},(ut=typeof jQuery!=="undefined"&&jQuery!==null?jQuery:typeof Zepto!=="undefined"&&Zepto!==null?Zepto:void 0)!=null&&(ut.fn.asEventStream=e.$.asEventStream),e.Observable.prototype.log=function(){var e;return e=1<=arguments.length?Et.call(arguments,0):[],this.subscribe(function(t){return typeof console!="undefined"&&console!==null?typeof console.log=="function"?console.log.apply(console,Et.call(e).concat([t.log()])):void 0:void 0}),this},e.EventStream.prototype.merge=function(t){var n;return k(t),n=this,gt(new e.Desc(n,"merge",[t]),e.mergeAll(this,t))},e.mergeAll=function(){var t;return t=x(arguments),t.length?new l(new e.Desc(e,"mergeAll",t),function(n){var r,i,s;return r=0,s=function(i){return function(s){return i.dispatcher.subscribe(function(i){var o;return i.isEnd()?(r++,r===t.length?n(F()):e.more):(o=n(i),o===e.noMore&&s(),o)})}},i=E.map(s,t),(new e.CompositeUnsubscribe(i)).unsubscribe}):e.never()},e.repeatedly=function(t,n){var r;return r=0,gt(new e.Desc(e,"repeatedly",[t,n]),e.fromPoll(t,function(){return n[r++%n.length]}))},e.repeat=function(t){var n;return n=0,e.fromBinder(function(r){var i,s,o,u,a;return i=!1,o=e.more,a=function(){},s=function(e){return e.isEnd()?i?u():i=!0:o=r(e)},u=function(){var u;i=!0;while(i&&o!==e.noMore)u=t(n++),i=!1,u?a=u.subscribeInternal(s):r(F());return i=!0},u(),function(){return a()}})},e.retry=function(t){var n,r,i,s,o,u,a;if(!E.isFunction(t.source))throw new c("'source' option has to be a function");return a=t.source,u=t.retries||0,o=t.maxRetries||u,n=t.delay||function(){return 0},s=t.isRetryable||function(){return!0},i=!1,r=null,gt(new e.Desc(e,"retry",[t]),e.repeat(function(){var t,f,l;return i?null:(l=function(){return a().endOnError().withHandler(function(e){if(!e.isError())return e.hasValue()&&(r=null,i=!0),this.push(e);r=e;if(!(s(r.error)&&u>0))return i=!0,this.push(e)})},r?(t={error:r.error,retriesDone:o-u},f=e.later(n(t)).filter(!1),u-=1,f.concat(e.once().flatMap(l))):l())}))},e.sequentially=function(t,n){var r;return r=0,gt(new e.Desc(e,"sequentially",[t,n]),e.fromPoll(t,function(){var e;return e=n[r++],r<n.length?e:r===n.length?[e,F()]:F()}))},e.Observable.prototype.skip=function(t){return gt(new e.Desc(this,"skip",[t]),this.withHandler(function(n){return n.hasValue()?t>0?(t--,e.more):this.push(n):this.push(n)}))},e.Observable.prototype.take=function(t){return t<=0?e.never():gt(new e.Desc(this,"take",[t]),this.withHandler(function(n){return n.hasValue()?(t--,t>0?this.push(n):(t===0&&this.push(n),this.push(F()),e.noMore)):this.push(n)}))},e.EventStream.prototype.skipUntil=function(t){var n;return n=t.take(1).map(!0).toProperty(!1),gt(new e.Desc(this,"skipUntil",[t]),this.filter(n))},e.EventStream.prototype.skipWhile=function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],M(n),r=!1,B(this,n,t,function(t){return gt(new e.Desc(this,"skipWhile",[t]),this.withHandler(function(n){return r||!n.hasValue()||!t(n.value())?(n.hasValue()&&(r=!0),this.push(n)):e.more}))})},e.Observable.prototype.slidingWindow=function(t,n){return n==null&&(n=0),gt(new e.Desc(this,"slidingWindow",[t,n]),this.scan([],function(e,n){return e.concat([n]).slice(-t)}).filter(function(e){return e.length>=n}))},e.spy=function(e){return ft.push(e)},ft=[],at=function(e){var t,n,r;if(ft.length&&!at.running)try{at.running=!0;for(t=0,n=ft.length;t<n;t++)r=ft[t],r(e)}finally{delete at.running}return void 0},e.Property.prototype.startWith=function(t){return gt(new e.Desc(this,"startWith",[t]),this.scan(t,function(e,t){return t}))},e.EventStream.prototype.startWith=function(t){return gt(new e.Desc(this,"startWith",[t]),e.once(t).concat(this))},e.Observable.prototype.takeWhile=function(){var t,n;return n=arguments[0],t=2<=arguments.length?Et.call(arguments,1):[],M(n),B(this,n,t,function(t){return gt(new e.Desc(this,"takeWhile",[t]),this.withHandler(function(n){return n.filter(t)?this.push(n):(this.push(F()),e.noMore)}))})},e["try"]=function(t){return function(n){var r;try{return e.once(t(n))}catch(i){return r=i,new e.Error(r)}}},e.update=function(){var t,n,r,i;n=arguments[0],i=2<=arguments.length?Et.call(arguments,1):[],r=function(e){return function(){var t;return t=1<=arguments.length?Et.call(arguments,0):[],function(n){return e.apply(null,[n].concat(t))}}},t=i.length-1;while(t>0)i[t]instanceof Function||(i[t]=function(e){return function(){return e}}(i[t])),i[t]=r(i[t]),t-=2;return gt(new e.Desc(e,"update",[n].concat(Et.call(i))),e.when.apply(e,i).scan(n,function(e,t){return t(e)}))},e.zipAsArray=function(){var t;return t=x(arguments),gt(new e.Desc(e,"zipAsArray",t),e.zipWith(t,function(){var e;return e=1<=arguments.length?Et.call(arguments,0):[],e}))},e.zipWith=function(){var t,n,r;return n=T(arguments),r=n[0],t=n[1],r=E.map(function(e){return e.toEventStream()},r),gt(new e.Desc(e,"zipWith",[t].concat(Et.call(r))),e.when(r,t))},e.Observable.prototype.zip=function(t,n){return n==null&&(n=Array),gt(new e.Desc(this,"zip",[t]),e.zipWith([this,t],n))},e.Observable.prototype.first=function(){return gt(new e.Desc(this,"first",[]),this.take(1))},e.Observable.prototype.last=function(){var t;return gt(new e.Desc(this,"last",[]),this.withHandler(function(n){if(n.isEnd())return t&&this.push(t),this.push(F()),e.noMore;t=n}))},e.EventStream.prototype.throttle=function(t){return gt(new e.Desc(this,"throttle",[t]),this.bufferWithTime(t).map(function(e){return e[e.length-1]}))},e.Property.prototype.throttle=function(t){return this.delayChanges(new e.Desc(this,"throttle",[t]),function(e){return e.throttle(t)})},v.prototype.firstToPromise=function(t){var n=this;if(typeof t!="function"){if(typeof Promise!="function")throw new c("There isn't default Promise, use shim or parameter");t=Promise}return new t(function(t,r){return n.subscribe(function(n){return n.hasValue()&&t(n.value()),n.isError()&&r(n.error),e.noMore})})},v.prototype.toPromise=function(e){return this.last().firstToPromise(e)},typeof define!="undefined"&&define!==null&&define.amd!=null?(define("bacon",[],function(){return e}),typeof this!="undefined"&&this!==null&&(this.Bacon=e)):typeof module!="undefined"&&module!==null&&module.exports!=null?(module.exports=e,e.Bacon=e):this.Bacon=e}.call(this),!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(".dropdown-backdrop").remove(),e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",r),s.toggleClass("open")),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery),define("bootstrap",function(){}),define("Common/App/show/layoutview/AppView",["backbone","bacon","config","bootstrap"],function(e,t,n){return e.Marionette.LayoutView.extend({template:!1,el:"body",regions:{header:"header",main:"[data-main-region]",footer:"footer",modal:"[data-modal-region]"},events:{keydown:"onKeydown"},initialize:function(e){this.title=e.title,this.pageTitlePrefix=e.pageTitlePrefix},setWithNavbarFixedTop:function(e){this.$el[e?"addClass":"removeClass"]("with-navbar-fixed-top")},setTitle:function(e){$("head > title").text(e)},setPageCopy:function(e){$("#ep-analysis-page-copy-row > .span7").html(e)},onKeydown:function(e){e.which===8&&_.indexOf(["INPUT","TEXTAREA"],e.target.tagName)===-1&&e.preventDefault()},onError:function(e){}})}),function(e,t){typeof exports=="object"&&typeof require=="function"?module.exports=t(require("backbone")):typeof define=="function"&&define.amd?define("backbone.localstorage",["backbone"],function(n){return t(n||e.Backbone)}):t(Backbone)}(this,function(e){function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}function n(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function r(e){return e===Object(e)}function i(e,t){var n=e.length;while(n--)if(e[n]===t)return!0;return!1}function s(e,t){for(var n in t)e[n]=t[n];return e}function o(e,t){if(e==null)return void 0;var n=e[t];return typeof n=="function"?e[t]():n}return e.LocalStorage=window.Store=function(e,t){if(!this.localStorage)throw"Backbone.localStorage: Environment does not support localStorage.";this.name=e,this.serializer=t||{serialize:function(e){return r(e)?JSON.stringify(e):e},deserialize:function(e){return e&&JSON.parse(e)}};var n=this.localStorage().getItem(this.name);this.records=n&&n.split(",")||[]},s(e.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(e){return!e.id&&e.id!==0&&(e.id=n(),e.set(e.idAttribute,e.id)),this.localStorage().setItem(this._itemName(e.id),this.serializer.serialize(e)),this.records.push(e.id.toString()),this.save(),this.find(e)},update:function(e){this.localStorage().setItem(this._itemName(e.id),this.serializer.serialize(e));var t=e.id.toString();return i(this.records,t)||(this.records.push(t),this.save()),this.find(e)},find:function(e){return this.serializer.deserialize(this.localStorage().getItem(this._itemName(e.id)))},findAll:function(){var e=[];for(var t=0,n,r;t<this.records.length;t++)n=this.records[t],r=this.serializer.deserialize(this.localStorage().getItem(this._itemName(n))),r!=null&&e.push(r);return e},destroy:function(e){this.localStorage().removeItem(this._itemName(e.id));var t=e.id.toString();for(var n=0,r;n<this.records.length;n++)this.records[n]===t&&this.records.splice(n,1);return this.save(),e},localStorage:function(){return localStorage},_clear:function(){var e=this.localStorage(),t=new RegExp("^"+this.name+"-");e.removeItem(this.name);for(var n in e)t.test(n)&&e.removeItem(n);this.records.length=0},_storageSize:function(){return this.localStorage().length},_itemName:function(e){return this.name+"-"+e}}),e.LocalStorage.sync=window.Store.sync=e.localSync=function(t,n,r){var i=o(n,"localStorage")||o(n.collection,"localStorage"),s,u,a=e.$?e.$.Deferred&&e.$.Deferred():e.Deferred&&e.Deferred();try{switch(t){case"read":s=n.id!=undefined?i.find(n):i.findAll();break;case"create":s=i.create(n);break;case"update":s=i.update(n);break;case"delete":s=i.destroy(n)}}catch(f){f.code===22&&i._storageSize()===0?u="Private browsing is unsupported":u=f.message}return s?(r&&r.success&&(e.VERSION==="0.9.10"?r.success(n,s,r):r.success(s)),a&&a.resolve(s)):(u=u?u:"Record Not Found",r&&r.error&&(e.VERSION==="0.9.10"?r.error(n,u,r):r.error(u)),a&&a.reject(u)),r&&r.complete&&r.complete(s),a&&a.promise()},e.ajaxSync=e.sync,e.getSyncMethod=function(t,n){var r=n&&n.ajaxSync;return!r&&(o(t,"localStorage")||o(t.collection,"localStorage"))?e.localSync:e.ajaxSync},e.sync=function(t,n,r){return e.getSyncMethod(n,r).apply(this,[t,n,r])},e.LocalStorage}),define("Common/App/models/AppModel",["backbone","config","backbone.localstorage"],function(e,t){var n=e.Model.extend({localStorage:new e.LocalStorage(t["app.model.localStorage"]),defaults:{nbVisits:0,mode:"simple"},initialize:function(e){this.fetch(),this.set(e),this.save()},isModeAdvanced:function(){return this.get("mode")==="advanced"},isModeSimple:function(){return this.get("mode")==="simple"},setMode:function(e){this.set("mode",e),this.save()},isEnv:function(e){return this.get("env")===e}});return n}),define("Common/Pages/models/PageLocalModel",["backbone","config","backbone.localstorage"],function(e,t){var n=e.Model.extend({localStorage:new e.LocalStorage(t["page.model.localStorage"]),defaults:{analysisMeanLoadTime:3e3},initialize:function(){this.fetch()},setAnalysisMeanLoadTime:function(e){var t="analysisMeanLoadTime";this.set(t,parseInt((parseInt(this.get(t))+e)/2))}});return n}),define("Common/Pages/models/PageModel",["backbone","./PageLocalModel"],function(e,t){var n=e.Model.extend({idAttribute:"name",initialize:function(e,t){this.eventBus=t.eventBus,this.initializeLocalModel()},initializeLocalModel:function(){this.localModel=new t({id:this.get("name")})},getCommands:function(){return e.Wreqr.radio.channel("global").commands},sync:function(t,n,r){if(t==="read")return e.sync.apply(e,arguments)}});return n}),define("AnalysisPageServer/Parameters/models/ParameterModel",["backbone","bacon"],function(e,t){var n=e.Model.extend({parent:null,children:null,initialize:function(e,t){this.parent=t.parent,this.getCommands().execute("parameters:show.if:initialize",this),this.getCommands().execute("parameters:display.callback:initialize",this),this.getCommands().execute("parameters:persistent:initialize",this),this.getCommands().execute("parameters:conditional-persistent:initialize",this),this.getCommands().execute("parameters:show.if.advanced:initialize",this),this.initializeParentIsActiveProperty(),this.initializeIsActiveProperty(),this.initializeHasValueProperty(),this.listenTo(this.collection,"add",this.onCollectionAdd),this.waitWithMajorInitialization()},getCommands:function(){return e.Wreqr.radio.channel("global").commands},getReqRes:function(){return e.Wreqr.radio.channel("global").reqres},initializeHasValueProperty:function(){this.hasValueProperty=t.fromEvent(this,"change:value",function(e){return e.hasValue()}).toProperty(this.hasValue()),this.hasValueProperty.takeUntil(this.getDestroyES()).onValue(function(){})},_reduceBooleanFactors:function(e){return _.reduce(e,function(e,t){return e&&t},!0)},initializeIsActiveProperty:function(){this.isActiveProperty=t.combineAsArray(this.parentIsActiveProperty,this.advancedProperty,this.showIfProperty,this.displayCallbackProperty).map(this,"_reduceBooleanFactors"),this.isActiveProperty.takeUntil(this.getDestroyES()).onValue(function(){})},initializeParentIsActiveProperty:function(){this.parent?this.parentIsActiveProperty=this.parent.isActive():this.parentIsActiveProperty=t.constant(!0)},waitWithMajorInitialization:function(){this.isInitialized=t.combineAsArray(this.collection.modelsParsed.filter(_.isEqual,!0),this.asEventStream("collection:add")).map(!0).startWith(!1),this.isInitialized.filter(_.isEqual,!0).takeUntil(this.getDestroyES()).take(1).onValue(this,"_timeShiftedInitialize")},_timeShiftedInitialize:function(){this.getCommands().execute("parameters:display.callback:run",this),this.getCommands().execute("parameters:show.if:run",this),this.getCommands().execute("parameters:listen-to-set-value",this),this.initializeChildren&&this.initializeChildren(),this.trigger("initialize:fully")},getDestroyES:function(){return this.asEventStream("destroy").take(1)},sync:function(t){if(t==="read")return e.sync.apply(e,arguments)},hasValue:function(){return this.has("value")&&this.getValue()!==""},setValue:function(e,t){t=t||{},this.set("value",e,t),this.trigger("set:value",this,e,t)},unsetValue:function(e){e=e||{},this.unset("value",e),this.trigger("set:value",this,void 0,_.extend({unset:!0},e))},getValue:function(){return this.get("value")},reset:function(){this.unsetValue()},isComplex:function(){return!1},anyParentIsAdvanced:function(){return _.some(this.getParents(),function(e){return e.get("advanced")})},isActive:function(){return this.isActiveProperty},_isReadyMap:function(e){return e.isActive?!this.get("required")||this.isComplex()?!0:e.hasValue:!0},isReady:function(){return t.combineTemplate({isActive:this.isActive(),hasValue:this.hasValueProperty}).map(this,"_isReadyMap")},getParents:function(){var e=this.parent,t=[];while(e)t.push(e),e=e.parent;return t},_toJSONMapper:function(e,t,n){var r=!t||t&&t.length===1,i;return n?r?this.getValue():(i={},_.each(t,function(e){i[e]=this.get(e)},this),i):"__inactive__"},conditionalToJSON:function(e,t){return this.isActive().take(1).map(this,"_toJSONMapper",e,t)},fromJSON:function(e,t,n){if(e===void 0)return;var r=!t||t&&t.length===1;r?(this.setValue(e,n),this.trigger("value:from:json",this,e)):_.each(t,function(t){this.set(t,e[t])},this)},getDependenciesNames:function(){var e=this.getPersistentDependenciesNames();return e=e.concat(this.getDisplayCallbackDependenciesNames()),this.getShowIfDependencyName()&&e.push(this.getShowIfDependencyName()),_.uniq(e)},getDependencies:function(){if(this._dependenciesCache)return this._dependenciesCache;var e=this.getDependenciesNames();return this._dependenciesCache=_.map(e,function(e){return this.getReqRes().request("parameters:get-closest",this,{name:e})},this),this._dependenciesCache},getPersistentDependenciesNames:function(){var e=_.clone(this.get("persistent_dependencies"))||[];return _.isArray(e)?e:[e]},getPersistentDependencies:function(){if(this._persistentDependenciesCache)return this._persistentDependenciesCache;var e=this.getPersistentDependenciesNames();return this._persistentDependenciesCache=_.map(e,function(e){return this.getReqRes().request("parameters:get-closest",this,{name:e})},this),this._persistentDependenciesCache},getDisplayCallbackDependenciesNames:function(){var e=_.clone(this.get("display.callback"));return e&&e.dependent?_.values(e.dependent):[]},getDisplayCallbackDependencies:function(){if(this._displayCallbackDependenciesCache)return this._displayCallbackDependenciesCache;var e=this.getDisplayCallbackDependenciesNames();return this._displayCallbackDependenciesCache=_.map(e,function(e){return this.getReqRes().request("parameters:get-closest",this,{name:e})},this),this._displayCallbackDependenciesCache},getShowIfDependencyName:function(){var e=_.clone(this.get("show.if"));return e&&e.name?e.name:null},getShowIfDependency:function(){if(this._showIfDependencyCache)return this._showIfDependencyCache;var e=this.getShowIfDependencyName();return this._showIfDependencyCache=this.getReqRes().request("parameters:get-closest",this,{name:e}),this._showIfDependencyCache},onCollectionAdd:function(e){this===e&&this.trigger("collection:add",this)}});return n}),define("AnalysisPageServer/Parameters/Combobox/models/ComboboxParameterModel",["backbone","bacon","AnalysisPageServer/Parameters/models/ParameterModel"],function(e,t,n){var r=n.extend({defaults:function(){return{value:null}},initialize:function(){n.prototype.initialize.apply(this,arguments),this.getCommands().execute("parameters:combobox:suggestions:initialize",this),this.on({"change:suggestions":this.onChangeSuggestions,"fetch:suggestions:fail":this.onFetchSuggestionsFail})},_timeShiftedInitialize:function(){n.prototype._timeShiftedInitialize.call(this)},getSuggestions:function(){this.getCommands().execute("parameters:combobox:suggestions:fetch",this)},_toJSONMapper:function(e,t,n){var r=!t||t&&t.length===1,i;return n?(r&&(e==="url"?(i={v:this.getValue(),r:this.get("readable")},this.get("selfDependent")&&(i.s=this.get("searchTerm"))):i=this.getValue()),i):"__inactive__"},conditionalToJSON:function(e,t){return this.isActive().take(1).map(this,"_toJSONMapper",e,t)},fromJSON:function(e,t,n){if(!e||_.isEmpty(e))return;var r=!t||t&&t.length===1;r?(e.r&&this.set("readable",e.r),e.v&&this.setValue(e.v,n),e.v&&this.trigger("value:from:json",this,e.v)):_.each(t,function(t){this.set(t,e[t])},this)},reset:function(){this.unsetValue(),this.unset("readable"),this.unset("suggestions"),this.get("selfDependent")&&this.unset("searchTerm")},destroy:function(){this.stopListening(),n.prototype.destroy.call(this)},getDependenciesNames:function(){var e=n.prototype.getDependenciesNames.call(this);return e=e.concat(this.getComboboxDependenciesNames()),_.uniq(e)},getComboboxDependenciesNames:function(){return _.values(this.get("dependent"))},getComboboxDependencies:function(){if(this._comboboxDependenciesCache)return this._comboboxDependenciesCache;var e=this.getComboboxDependenciesNames();return this._comboboxDependenciesCache=_.map(e,function(e){return this.getReqRes().request("parameters:get-closest",this,{name:e})},this),this._comboboxDependenciesCache}});return r}),define("AnalysisPageServer/Parameters/Combobox/models/selfDependentMixin",[],function(){return function(e){return[{initialize:function(t,n){e.prototype.initialize.call(this,t,n),this.set("selfDependent",!0),this.set("externallyDependent",_.size(t.dependent)>1),this.on("change:searchTerm",this.onSearchTermChanged)},setSearchTerm:function(e,t){e&&e.length>1&&this.set("searchTerm",e,t)},isSearchTermAvailable:function(){return this.get("searchTerm")},onSearchTermChanged:function(e,t,n){n.viewTriggered&&this.getSuggestions()},onChangeSuggestions:function(){},onFetchSuggestionsFail:function(){}},{}]}}),define("AnalysisPageServer/Parameters/Combobox/models/nonSelfDependentMixin",[],function(){return function(e){return[{initialize:function(t,n){e.prototype.initialize.call(this,t,n),this.set("selfDependent",!1),this.set("externallyDependent",_.size(t.dependent)>0)},onChangeSuggestions:function(e,t,n){var r;_.size(this.get("suggestions"))>0&&!this.hasValueInSuggestions()&&!this.get("allow_multiple")&&(r=this.get("suggestions")[0],this.set("readable",r.long_name,{viewTriggered:!0}),this.setValue(r.id,{viewTriggered:!0}))},onFetchSuggestionsFail:function(){this.setValue("",{viewTriggered:!0})}},{}]}}),define("AnalysisPageServer/Parameters/Combobox/models/multipleMixin",["backbone"],function(e){return function(e){return[{defaults:function(){return{value:[],readable:[]}},hasValueInSuggestions:function(){return _.reduce(this.get("suggestions"),function(e,t){return e||_.indexOf(this.getValue(),t.id)>-1},!1,this)},updateFromView:function(e,t){var n,r,i;i=_.map(this.getValue(),function(e){return e&&e.toString()}),n=_.map(e.val,function(t){return r=_.indexOf(i,t&&t.toString()),r===-1&&e.added?e.added.text:this.get("readable")[r]},this),this.set("readable",n,t),this.setValue(e.val,t)},selectAll:function(e){this.set("readable",_.map(this.get("suggestions"),function(e){return e.long_name}),e),this.setValue(_.map(this.get("suggestions"),function(e){return e.id}),e)},deselectAll:function(){this.set("readable",[]),this.setValue([])},reset:function(){this.setValue([]),this.set("readable",[]),this.unset("suggestions"),this.get("selfDependent")&&this.unset("searchTerm")}},{}]}}),define("AnalysisPageServer/Parameters/Combobox/models/nonMultipleMixin",["backbone"],function(e){return function(e){return[{hasValueInSuggestions:function(){return _.reduce(this.get("suggestions"),function(e,t){return e||this.getValue()==t.id},!1,this)},updateFromView:function(e,t){e.added?(this.set("readable",e.added.text,t),this.setValue(e.added.id,t)):e.removed&&(e.removed.text===this.get("readable")&&this.unset("readable",t),e.removed.id===this.getValue()&&this.unsetValue(t))}},{}]}}),define("AnalysisPageServer/Parameters/Combobox/models/createComboboxParameterModel",["./ComboboxParameterModel","./selfDependentMixin","./nonSelfDependentMixin","./multipleMixin","./nonMultipleMixin"],function(e,t,n,r,i){return function(s,o){var u=e;return _.indexOf(_.values(s.dependent),s.name)>-1?u=u.extend.apply(u,t(u)):u=u.extend.apply(u,n(u)),s.allow_multiple?u=u.extend.apply(u,r(u)):u=u.extend.apply(u,i(u)),new u(s,o)}}),function(e){define("backbone.eventstreams",["backbone","bacon"],function(){return function(){(function(){var e=[].slice;Backbone.EventStream={listenToEventStream:function(t,n,r){var i;return r==null&&(r=_.identity),i=this,new Bacon.EventStream(function(s){var o,u;return o=function(){var t,n;t=1<=arguments.length?e.call(arguments,0):[],n=s(new Bacon.Next(r.apply(null,t)));if(n===Bacon.noMore)return u()},u=function(){return i.stopListening(t,n,o)},i.listenTo(t,n,o),u})},asEventStream:function(t,n){var r;return n==null&&(n=_.identity),r=this,new Bacon.EventStream(function(i){var s,o;return s=function(){var t,r;t=1<=arguments.length?e.call(arguments,0):[],r=i(new Bacon.Next(n.apply(null,t)));if(r===Bacon.noMore)return o()},o=function(){return r.off(t,s)},r.on(t,s,this),o})}},_.extend(Backbone,Backbone.EventStream),_.extend(Backbone.Model.prototype,Backbone.EventStream),_.extend(Backbone.Collection.prototype,Backbone.EventStream),_.extend(Backbone.Router.prototype,Backbone.EventStream),_.extend(Backbone.History.prototype,Backbone.EventStream),_.extend(Backbone.View.prototype,Backbone.EventStream),Backbone.BaconProperty={toModel:function(){var e,t;return t=new Backbone.Model(this.take(1)),e=function(e){return t.set(e)},this.onValue(e),t}},_.extend(Bacon.Property.prototype,Backbone.BaconProperty)}).call(this)}.apply(e,arguments)})}(this),define("AnalysisPageServer/Parameters/models/ParameterChildrenCollection",["backbone","bacon","config","backbone.eventstreams"],function(e,t,n){var r=e.Collection.extend({initialize:function(e,t){},parse:function(e,t){return _.values(e)},_toJSONMapper:function(e){return _.reduce(this.getRoots(),function(t,n,r){return e[r]!==void 0&&e[r]!=="__inactive__"&&(t[n.get("name")]=e[r]),t},{})},conditionalToJSON:function(e,n){return t.combineAsArray(_.map(this.getRoots(),function(t){return t.conditionalToJSON(e,n)})).map(this,"_toJSONMapper")},fromJSON:function(e,t){_.map(this.getRoots(),function(n){return n.fromJSON(e[n.get("name")],t,{globalSetValue:!0})})},getFirstUnready:function(){return this.find(function(e){return!e.isReady()})},getAdvanced:function(){return this.where({advanced:1})},hasAdvanced:function(){return _.size(this.getAdvanced())>0},_getActiveMapper:function(e){return this.reduce(function(t,n,r){return e[r]&&t.push(n),t},[])},getActive:function(){return t.combineAsArray(this.map(function(e){return e.isActive().take(1)})).map(this,"_getActiveMapper")},_isReadyMapper:function(e){return _.reduce(e,function(e,t){return e&&t},!0)},isReady:function(){return t.combineAsArray(this.map(function(e){return e.isReady()})).map(this,"_isReadyMapper")},getPersistent:function(){return this.filter(function(e){return e.get("persistent")})}});return r}),define("AnalysisPageServer/Parameters/models/ArrayParameterModel",["bacon","./ParameterModel","./ParameterChildrenCollection"],function(e,t,n){return t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments),this.children=new n},initializeChildren:function(){for(var e=0;e<this.get("start");e++)this.addChild();this._childrenInitialized=!0,this._jsonToParse&&(this.fromJSON(this._jsonToParse),delete this._jsonToParse)},addChild:function(){if(!this.isMax()){var e=this.collection.getLastDescendantOf(this);e=e||this;var t=this.collection.indexOf(e)+1,n=this.collection.add(_.clone(this.get("prototype")),{at:t,parent:this});return this.children.add(n),n}},destroyLastChild:function(){if(!this.isMin()){var e=this.children.pop();e.destroy()}},isStart:function(){return this.children.size()<=this.get("start")},isMin:function(){return this.children.size()<=this.get("min")},isMax:function(){return this.children.size()>=this.get("max")},destroy:function(){var e;while(e=this.children.pop())e.destroy();this.children.reset(),t.prototype.destroy.call(this)},isComplex:function(){return!0},_toJSONMapper:function(e){return _.reduce(e,function(e,t,n){var r=this.children.at(n);return r&&t!=="__inactive__"&&e.push(t),e},[],this)},conditionalToJSON:function(t,n){return e.combineAsArray(this.children.map(function(e){return e.conditionalToJSON(t,n)})).map(this,"_toJSONMapper")},fromJSON:function(e,t,n){if(!_.isArray(e))return;if(!this._childrenInitialized){this._jsonToParse=e;return}var r=_.reduce(e,function(e,t){return t!==""&&!_.isEmpty(t)&&e.push(t),e},[]),i=this.children.size()-_.size(r);if(i>0)for(var s=0;s<i;s++)this.destroyLastChild();var o;_.each(r,function(e,r){o=this.children.at(r),o||(o=this.addChild()),o.fromJSON(e,t,n)},this)}})}),define("AnalysisPageServer/Parameters/models/CompoundParameterModel",["bacon","./ParameterModel","./ParameterChildrenCollection"],function(e,t,n){var r=t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments),this.children=new n},initializeChildren:function(){_.each(this.get("children"),function(e){this.addChild(e)},this),this._childrenInitialized=!0,this._jsonToParse&&(this.fromJSON(this._jsonToParse),delete this._jsonToParse)},addChild:function(e){var t=this.collection.getLastDescendantOf(this);t=t||this;var n=this.collection.indexOf(t)+1,r=this.collection.add(e,{at:n,parent:this});this.children.add(r)},destroy:function(){var e;while(e=this.children.pop())e.destroy();this.children.reset(),t.prototype.destroy.call(this)},isComplex:function(){return!0},_toJSONMapper:function(e){return _.reduce(e,function(e,t,n){var r=this.children.at(n);return r&&t!=="__inactive__"&&(e[r.get("name")]=t),e},{},this)},conditionalToJSON:function(t,n){return e.combineAsArray(this.children.map(function(e){return e.conditionalToJSON(t,n)})).map(this,"_toJSONMapper")},fromJSON:function(e,t,n){e&&!_.isEmpty(e)&&(this._childrenInitialized?this.children.each(function(r){r.fromJSON(e[r.get("name")],t,n)}):this._jsonToParse=e)}});return r}),define("AnalysisPageServer/Parameters/Select/models/SelectParameterModel",["backbone","AnalysisPageServer/Parameters/models/ParameterModel"],function(e,t){return t.extend({})}),define("AnalysisPageServer/Parameters/Select/models/multipleMixin",["backbone"],function(e){return function(e){return[{defaults:function(){return{value:[]}},selectAll:function(e){this.setValue(_.map(this.get("choices"),function(e,t){return t}),e)},deselectAll:function(){this.setValue([])},reset:function(){this.setValue([])}},{}]}}),define("AnalysisPageServer/Parameters/Select/models/nonMultipleMixin",["backbone"],function(e){return function(e){return[{},{}]}}),define("AnalysisPageServer/Parameters/Select/models/createSelectParameterModel",["./SelectParameterModel","./multipleMixin","./nonMultipleMixin"],function(e,t,n){return function(r,i){var s=e;return r.allow_multiple?s=s.extend.apply(s,t(s)):s=s.extend.apply(s,n(s)),new s(r,i)}}),define("AnalysisPageServer/Parameters/models/FileParameterModel",["bacon","./ParameterModel"],function(e,t){return t.extend({initialize:function(){this.set(this.getFileKeyName(),_.uniqueId("file-")),t.prototype.initialize.apply(this,arguments)},getFileKeyName:function(){return"___APS_fileContentId___"},getFileKey:function(){return this.get(this.getFileKeyName())},hasValue:function(){return!!this.file},setValue:function(e,t){t=t||{};var n=this.file;this.file=e,n!==this.file&&this.trigger("change:value",this,e,t),this.trigger("set:value",this,e,t)},unsetValue:function(e){e=e||{},delete this.file,this.trigger("set:value",this,void 0,_.extend({unset:!0},e))},getValue:function(){return this.file},_toJSONMapper:function(e,t,n){var r=!t||t&&t.length===1,i;return n?(r?(i={},i[this.getFileKeyName()]=this.getFileKey()):(i={},_.each(t,function(e){i[e]=this.get(e)},this)),i):"__inactive__"}})}),define("AnalysisPageServer/Parameters/models/ParameterCollection",["backbone","bacon","config","./ParameterModel","../Combobox/models/createComboboxParameterModel","./ArrayParameterModel","./CompoundParameterModel","../Select/models/createSelectParameterModel","./FileParameterModel","backbone.eventstreams"],function(e,t,n,r,i,s,o,u,a){var f=e.Collection.extend({url:n["parameter.collection.url"],initialize:function(e,t){this.pageModel=t.pageModel,this.on({add:this.onAdd,remove:this.onRemove}),this.modelsParsed=this.asEventStream("sync").map(!0).toProperty(!1)},model:function(e,t){switch(e.type){case"compound":return new o(e,t);case"array":return new s(e,t);case"file":return new a(e,t);case"combobox":return i(e,t);case"select":return u(e,t);default:return new r(e,t)}},sync:function(t,n,r){return r.page=r.page||this.pageModel.get("name"),e.Collection.prototype.sync.call(this,t,n,r)},parse:function(e,t){return _.values(e)},_toJSONMapper:function(e){return _.reduce(this.getRoots(),function(t,n,r){return e[r]!==void 0&&e[r]!=="__inactive__"&&(t[n.get("name")]=e[r]),t},{})},conditionalToJSON:function(e,n){return t.combineAsArray(_.map(this.getRoots(),function(t){return t.conditionalToJSON(e,n)})).map(this,"_toJSONMapper")},fromJSON:function(e,t){_.map(this.getRoots(),function(n){return n.fromJSON(e[n.get("name")],t,{})})},getRoots:function(){return this.filter(function(e){return!e.parent})},getCommonParents:function(e,t){return _.intersection(e.getParents(),t.getParents())},getLastDescendantOf:function(e){var t=null,n=null,r=this.indexOf(e);if(r<0)return null;n=this.at(++r);while(n&&_.indexOf(n.getParents(),e)>-1)t=n,n=this.at(++r);return t},getAdvanced:function(){return this.where({advanced:1})},hasAdvanced:function(){return _.size(this.getAdvanced())>0},_reduceBooleanValues:function(e){return this.reduce(function(t,n,r){return e[r]&&t.push(n),t},[])},getActive:function(){return t.combineAsArray(this.map(function(e){return e.isActive()})).map(this,"_reduceBooleanValues")},getReady:function(){return t.combineAsArray(this.map(function(e){return e.isReady()})).map(this,"_reduceBooleanValues")},getUnready:function(){var e=this;return this.getReady().map(function(t){return e.filter(function(e){return t.indexOf(e)===-1})})},onAdd:function(e){this.listenTo(e,"value:from:json",this.onModelValueFromJson)},onRemove:function(e){this.stopListening(e)},onModelValueFromJson:function(e,t){this.trigger("parameter:value:from:json",e,t)},_isReadyMapper:function(e){return _.reduce(e,function(e,t){return e&&t},!0)},isReady:function(){return t.combineAsArray(this.map(function(e){return e.isReady()})).map(this,"_isReadyMapper")},getPersistent:function(){return this.filter(function(e){return e.get("persistent")})},getFiles:function(){return this.where({type:"file"})}});return f}),define("functions/fixedEncodeURIComponent",[],function(){return function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}}),define("client/Client",["functions/fixedEncodeURIComponent"],function(e){function t(){}return t.prototype={url_base:"",host:"",port:"",url:function(t,n,r){var i="";typeof this.host!="undefined"&&this.host!=""&&(i="http://"+this.host,typeof this.port!="undefined"&&this.port!=""&&(i=i+":"+this.port),i+="/"),typeof this.url_base!="undefined"&&(i+=t.indexOf(this.url_base)==0?"":this.url_base),i+=t;if(n||typeof r!="undefined")i+="?";n&&(i+="page="+e(n)+";");for(var s in r)i+=s+"="+e(r[s])+";";return i},encodeParams:function(e){return _.each(e,function(t,n){if(t instanceof File)return;t=t===void 0?String(null):t.toString(),e[n]=t.replace(/%/g,"%25").replace(/ /g,"%20")}),e},responseIsError:function(e){return String(e).indexOf("ERROR")===0||String(e).indexOf("<pre>ERROR")===0||String(e).indexOf("<PRE>ERROR")===0}},t}),define("client/RClient",["client/Client"],function(e){function t(e){this.url_base=e}function n(){}return n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.prototype.encodeParams=function(t){return t=e.prototype.encodeParams.call(this,t),_.each(t,function(e,n){if(e instanceof File)return;t[n]=e.toString().replace(/\+/g,"%2B")}),t},t.prototype.decoratePostParams=function(e,t,n){e.page=t,_.each(e,function(t,n){try{t instanceof File||(e[n]=JSON.stringify(t))}catch(r){e[n]=""}}),e.device=!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect?"png":"svg";var r=parseInt(7);e.height=r,e.width=parseInt(r*4/3),e.decoder="url",e.textarea_wrap=$("<input type='file'/>").get(0).files===undefined,e=this.encodeParams(e);var i=new FormData;return _.each(e,function(e,t){i.append(t,e)}),_.each(n,function(e){i.append(e.getFileKey(),e.getValue())}),i},t}),define("client/RestClient",["client/Client"],function(e){function t(e){this.url_base=e}function n(){}return n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t}),define("client/createClient",["./RClient","./RestClient","config"],function(e,t,n){return function(r){switch(r){case"R":return new e(n["client.R.url"]);case"REST":return new t(n["client.REST.url"])}}}),define("Common/Pages/models/AnalysisPageModel",["./PageModel","bacon","AnalysisPageServer/Parameters/models/ParameterCollection","client/createClient"],function(e,t,n,r){var i=e.extend({defaults:{label:"",sidebarVisible:!0,tableVisible:!0,tableRows:30},initialize:function(t,i){this.rClient=r("R"),this.restClient=r("REST"),this.parameters=new n(null,{pageModel:this}),e.prototype.initialize.apply(this,arguments)},getDestroyES:function(){return this.asEventStream("destroy").take(1)},isDataset:function(){return this.get("apss")},saveParameters:function(e){this.localModel.set("parameters",e),this.localModel.save()},abortFetchAnalysis:function(){this.trigger("abort:analysis-request")},initializeParameters:function(){!this.isDataset()&&this.localModel.get("parameters")&&this.parameters.fromJSON(this.localModel.get("parameters"))}});return i}),define("Common/Pages/models/PageCollection",["backbone","./PageModel","./AnalysisPageModel","config","client/createClient"],function(e,t,n,r,i){return e.Collection.extend({url:r["page.collection.url"],initialize:function(e,t){this.rClient=i("R"),this.appModel=t.appModel,this.parentPageModel=t.parentPageModel},model:function(e,r){return!e.hidden||e.name==="IP"?new n(e,r):new t(e,r)},modelId:function(e){return e[t.prototype.idAttribute]},sync:function(t){if(t==="read")return e.sync.apply(e,arguments)},fetch:function(t){return t.url=this.rClient.url(this.url),e.Collection.prototype.fetch.call(this,t)},activePage:null,getActive:function(){return this.activePage},setActive:function(e){if(!e)return;typeof e=="string"&&(e=this.findWhere({name:e}));var t=this.activePage;this.activePage=e,e!==t&&(t&&t.set("active",!1),e.set("active",!0),this.trigger("page:activate",t,e))},getInMenu:function(){return this.filter(function(e){return e.get("in_menu")})}})}),function(e){function n(e,t){return function(){e.apply(t,arguments)}}function i(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof e!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(e,n(o,this),n(u,this))}function s(e){var n=this;if(this._state===null){this._deferreds.push(e);return}t(function(){var t=n._state?e.onFulfilled:e.onRejected;if(t===null){(n._state?e.resolve:e.reject)(n._value);return}var r;try{r=t(n._value)}catch(i){e.reject(i);return}e.resolve(r)})}function o(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&(typeof e=="object"||typeof e=="function")){var t=e.then;if(typeof t=="function"){l(n(t,e),n(o,this),n(u,this));return}}this._state=!0,this._value=e,a.call(this)}catch(r){u.call(this,r)}}function u(e){this._state=!1,this._value=e,a.call(this)}function a(){for(var e=0,t=this._deferreds.length;e<t;e++)s.call(this,this._deferreds[e]);this._deferreds=null}function f(e,t,n,r){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r}function l(e,t,n){var r=!1;try{e(function(e){if(r)return;r=!0,t(e)},function(e){if(r)return;r=!0,n(e)})}catch(i){if(r)return;r=!0,n(i)}}var t=i.immediateFn||typeof setImmediate=="function"&&setImmediate||function(e){setTimeout(e,1)},r=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=this;return new i(function(r,i){s.call(n,new f(e,t,r,i))})},i.all=function(){var e=Array.prototype.slice.call(arguments.length===1&&r(arguments[0])?arguments[0]:arguments);return new i(function(t,n){function i(s,o){try{if(o&&(typeof o=="object"||typeof o=="function")){var u=o.then;if(typeof u=="function"){u.call(o,function(e){i(s,e)},n);return}}e[s]=o,--r===0&&t(e)}catch(a){n(a)}}if(e.length===0)return t([]);var r=e.length;for(var s=0;s<e.length;s++)i(s,e[s])})},i.resolve=function(e){return e&&typeof e=="object"&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},typeof module!="undefined"&&module.exports?module.exports=i:e.Promise||(e.Promise=i)}(this),define("promise-polyfill",["promise-polyfill/Promise"],function(e){return e}),define("promise-polyfill/Promise",function(){}),define("requirejs-text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.14",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.lastIndexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i[0]==="﻿"&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("requirejs-text!templates.html",[],function(){return'<!-- \r\n    HTML file to reference templates: they were taken from main html file\r\n    thus this way.\r\n-->\r\n<div>\r\n        <script id="ep-list-tmpl" type="text/template">\r\n            <ul class="<%= className %>">\r\n                <%= items %>\r\n            </ul>\r\n        </script>\r\n        <script id="ep-list-item-tmpl" type="text/template">\r\n            <% if (! notA) { %><a <% if (name) { %>data-name="<%= name %>"<% } %> <% if (id) { %>data-id="<%= id %>"<% } %> href="#"<% } %>>\r\n                <% if (strong) { %><strong><%= label %></strong><% } %>\r\n                <% if (! strong) { %><%= label %><% } %>\r\n            <% if (! notA) { %></a><% } %>\r\n        </script>\r\n        <script id="ep-select-option-tmpl" type="text/mustache">\r\n            <option value="{{id}}" {{#selected}}selected{{/selected}} {{#attrs}}{{name}}="{{value}}"{{/attrs}}>{{&label}}</option>\r\n        </script>\r\n        <script id="aps-landing-page-tmpl" type="text/template">\r\n            <div data-tool-overview-region></div>\r\n        </script>\r\n        <script id="ep-landing-page-tmpl" type="text/template">\r\n            <div class="row-fluid ep-caption">\r\n                <div class="span10 offset1 text-center lead">\r\n                    <p>\r\n                        <strong>ExpressionPlot</strong> is a portal into microarray and RNA-Seq gene expression\r\n                            data both generated at Genentech and imported from outside sources.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="row-fluid">\r\n                <div class="offset1 span10">\r\n                    <div data-study-form-region class="ep-landing-row-forms light-blue"></div>\r\n                </div>\r\n            </div>\r\n            <div data-tool-overview-region></div>\r\n            <div class="row-fluid">\r\n                <div class="span10 offset1">\r\n                    <p class="text-center lead">Projects Table</p>\r\n                    <div data-projects-table-region>\r\n                        <p class="text-center">loading...</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-landing-forms-tmpl" type="text/mustache">\r\n            <div class="row-fluid">\r\n                <div class="offset1 span10">\r\n                    <div class="ep-landing-row-forms light-blue"></div>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-header-tools-menu-tmpl" type="text/template">\r\n            <a href="#" class="dropdown-toggle" data-toggle="dropdown">\r\n                Tools <span class="caret"></span>\r\n            </a>\r\n            <ul class="dropdown-menu"></ul>\r\n        </script>\r\n        <script id="ep-tool-overview-tmpl" type="text/template">\r\n            <div class="ep-landing-tool-overview offset1 span10 light-blue">\r\n                <div class="row-fluid">\r\n                    <div class="span5"></div>\r\n                    <div class="span7"></div>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-tool-overview-list-tmpl" type="text/template">\r\n            <% _.each(items, function(item) { %>\r\n                <li><a href="#" data-name="<%= item.name %>"><strong><%= item.label %></strong></a></li>\r\n            <% }) %>\r\n        </script>\r\n        <script id="ep-tool-overview-body-tmpl" type="text/template">\r\n            <% _.each(items, function(item) { %>\r\n            <div data-name="<%= item.name %>" class="media">\r\n                <% if (item.thumbnail) { %>\r\n                <a class="pull-left" href="#">\r\n                    <img class="media-object" src="<%= item.thumbnail %>">\r\n                </a>\r\n                <% } %>\r\n                <div class="media-body">\r\n                    <h4 class="media-heading"><%= item.label %></h4>\r\n                    <%= item.description %>\r\n                </div>\r\n            </div>\r\n            <% }) %>\r\n        </script>\r\n        <script id="aps-primary-page-tmpl" type="text/template">\r\n            <div class="row-fluid">\r\n                <div class="span12">\r\n                    <p data-caption class="text-center lead"><%= label %></p>\r\n                    <p data-description class="text-center lead"><%= description %></p>\r\n                </div>\r\n            </div>\r\n            <div data-parameters-region></div>\r\n        </script>\r\n        <script id="ep-analysis-primary-form-tmpl" type="text/template">\r\n            <form class="ep-analysis-primary-form clearfix light-blue">\r\n                <div data-parameters-region></div>\r\n                <div class="form-actions">\r\n                    <button type="button" class="btn hide ep-form-advanced-toggle"><i class="fa fa-cogs"></i></button>\r\n                    <button type="button" class="btn ep-form-cancel" disabled>Cancel</button>\r\n                    <button type="submit" class="btn btn-primary" disabled>Submit</button>\r\n                    <div class="progress">\r\n                        <div class="bar"></div>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </script>\r\n        <script id="ep-analysis-secondary-form-tmpl" type="text/template">\r\n            <form class="ep-analysis-secondary-form clearfix">\r\n                <div data-parameters-region></div>\r\n                <div class="form-actions">\r\n                    <button type="button" class="btn hide ep-form-advanced-toggle"><i class="fa fa-cogs"></i></button>\r\n                    <button type="button" class="btn ep-form-cancel" disabled>Cancel</button>\r\n                    <button type="submit" class="btn btn-primary">Resubmit</button>\r\n                    <div class="progress">\r\n                        <div class="bar"></div>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </script>\r\n        <script id="ep-analysis-landing-form-tmpl" type="text/template">\r\n            <form class="ep-landing-search-form form-horizontal clearfix">\r\n                <div data-parameters-region></div>\r\n            </form>\r\n        </script>\r\n        <script id="ep-form-landing-combobox-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n            <div class="controls">\r\n                <button class="btn btn-primary btn-large" type="submit">\r\n                    <i class="icon-arrow-right icon-white"></i>\r\n                </button>\r\n                <input id="<%= baseId %>" type="text" name="<%= name %>" value="<%= value %>" class="" placeholder="<%= prompt %>" autocomplete="off" />\r\n                <div data-loader-region></div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-form-text-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n            <% if (primary) { %><div class="help-block">\r\n                <span><%= desc %></span></div><% } %>\r\n            <div class="controls">\r\n                <input id="<%= baseId %>" type="text" name="<%= name %>" value="<%= value %>" class="<%= size %>" placeholder="<%= prompt %>" autocomplete="off" />\r\n                <div data-loader-region></div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-form-select-radio-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n            <% if (primary) { %><div class="help-block">\r\n                <span><%= desc %></span></div><% } %>\r\n            <div class="controls">\r\n                <% _.each(choices, function(choice) { %>\r\n                    <label class="checkbox inline">\r\n                        <input type="radio" name="<%= choice.name %>" value="<%= value %>" <% if (selected) { %>checked<% } %> />\r\n                        <%= label %>\r\n                    </label>\r\n                <% }) %>\r\n            </div>\r\n        </script>\r\n        <script id="ep-form-bool-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n            <% if (primary) { %><div class="help-block">\r\n                <span><%= desc %></span></div><% } %>\r\n            <div class="controls">\r\n                <button id="<%= baseId %>" type="button" name="<%= name %>" class="btn <%= size %> <% if (active) { %>active<% } %> <%= buttonClass %>">\r\n                    <%= buttonLabel %>\r\n                </button>\r\n            </div>\r\n        </script>\r\n        <script id="ep-form-array-tmpl" type="text/mustache">\r\n            <div class="control-array-label">\r\n                <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n                <% if (primary) { %><div class="help-block"><span><%= desc %></span></div><% } %>\r\n                    <button type="button" class="btn ep-array-remove-child"><i class="icon-minus"></i></button>\r\n                    <button type="button" class="btn ep-array-add-child"><i class="icon-plus"></i></button>\r\n            </div>\r\n            <div data-children-region></div>\r\n        </script>\r\n        <script id="ep-form-compound-tmpl" type="text/template">\r\n            <div class="control-array-label">\r\n                <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n                <% if (primary) { %><div class="help-block"><span><%= desc %></span></div><% } %>\r\n            </div>\r\n            <div data-children-region></div>\r\n        </script>\r\n        <script id="ep-form-slider-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %> <span class="muted"><%= value %></span></label>\r\n            <% if (primary) { %><div class="help-block">\r\n                <span><%= desc %></span></div><% } %>\r\n            <div class="controls">\r\n                <span class=""><%= min %></span>\r\n                <input id=""<%= baseId %>" name="<%= name %>" class="<%= size %>" type="range" min="<%= min %>" max="<%= max %>" step="<%= step %>" value="<%= value %>" />\r\n                <span class=""><%= max %></span> \r\n            </div>\r\n        </script>\r\n        <script id="ep-form-file-tmpl" type="text/template">\r\n            <label class="control-label" for="<%= baseId %>"><%= label %></label>\r\n            <% if (primary) { %><div class="help-block">\r\n                <span><%= desc %></span></div><% } %>\r\n            <div class="controls">\r\n                <input id="<%= baseId %>" type="file" name="<%= name %>" value="<%= value %>" class="<%= size %>" placeholder="<%= prompt %>" autocomplete="off" />\r\n            </div>\r\n        </script>\r\n        <script id="ep-analysis-array-list-item-tmpl" type="text/template">\r\n                <dt><%= label %></dt>\r\n                <dd data-content></dd>\r\n        </script>\r\n        <script id="ep-analysis-array-tabs-navitem-tmpl" type="text/template">\r\n            <a href="#" data-toggle="tab"><%= label %></a>\r\n        </script>\r\n        <script id="ep-analysis-array-tabs-tmpl" type="text/template">\r\n            <div data-nav>\r\n            </div>\r\n            <div data-content>\r\n            </div>\r\n        </script>\r\n        <script id="ep-analysis-table-tmpl" type="text/template">\r\n            <% if (! withPlot) { %>\r\n            <h5 class="ep-table-info">\r\n                <span class="text-info"></span>\r\n                <button class="btn btn-mini ep-download-csv">\r\n                    <i class="icon-download"></i> .csv\r\n                </button>\r\n            </h5>\r\n            <% } %>\r\n            <div data-table-thead></div>\r\n            <div data-table-tbody></div>\r\n        </script>\r\n        <script id="ep-analysis-tbody-tmpl" type="text/template">\r\n            <div data-chunk-region></div>\r\n        </script>\r\n        <script id="ep-analysis-thead-tmpl" type="text/template">\r\n            <thead><tr></tr></thead>\r\n        </script>\r\n        <script id="ep-analysis-thead-item-tmpl" type="text/template">\r\n            <div class="ep-th">\r\n                <div class="ep-th-label">\r\n                    <span class="ep-ext-label"><%= label %></span>\r\n                    <span class="ep-visible-label"><%= label %></span>\r\n                </div>\r\n                <div class="ep-th-actions">\r\n                    <i class="icon-white icon-filter" data-filter-action></i>\r\n                    <i class="icon-white icon-arrow-up" data-sort-action></i>\r\n                </div>\r\n            </div>\r\n            <div data-filters-region class="hide ep-th-filters"></div>\r\n        </script>\r\n        <script id="ep-analysis-thead-summary-tmpl" type="text/template">\r\n            <ul class="unstyled">\r\n                <% _.each(items, function(count, name) { %>\r\n                    <li>\r\n                        <%- name %>: <%= count %>\r\n                    </li>\r\n                <% }) %>\r\n            </ul>\r\n        </script>\r\n        <script id="ep-analysis-table-chunk-tmpl" type="text/template">\r\n            <table class="table table-bordered table-striped table-hover">\r\n                <thead>\r\n                    <% _.each(meta, function() { %>\r\n                        <th></th>\r\n                    <% }) %>\r\n                </thead>\r\n                <tbody>\r\n                    <% _.each(items, function(item) { %>\r\n                    <tr id="<%= item.id %>-row">\r\n                        <% _.each(item.data, function(cell) { %>\r\n                        <td>\r\n                            <span class="ep-ext-label"><%= cell %></span>\r\n                            <%= cell %>\r\n                        </td>\r\n                        <% }) %>\r\n                    </tr>\r\n                    <% }) %>\r\n                </tbody>\r\n            </table>\r\n        </script>\r\n        <script id="ep-analysis-plot-tmpl" type="text/template">\r\n            <div class="row-fluid ep-analysis-plot">\r\n                <div class="span7 ep-plot-inner" data-main>\r\n                    <div data-menu-region class="ep-side-menu"></div>\r\n                    <div data-plot-region class="ep-svg-container"></div>\r\n                </div>\r\n                <div class="span5 ep-analysis-sidebar" data-sidebar-region></div>\r\n            </div>\r\n            <div class="row-fluid">\r\n                <div class="span12" data-table-region></div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-progressbar-tmpl" type="text/template">\r\n            <div class="bar"></div>\r\n        </script>\r\n        <script id="ep-analysis-plot-menu-tmpl" type="text/template">\r\n            <button class="btn btn-small" title="Toggle Fullscreen" data-go-fullscreen>\r\n                <i class="fa fa-expand fa-fw"></i>\r\n            </button>\r\n            <div class="btn-group btn-group-vertical">\r\n                <button class="btn btn-small" title="Tag Mode" data-tag-mode>\r\n                    <i class="fa fa-tags fa-fw"></i>\r\n                </button>\r\n                <button class="btn btn-small active" title="Pan Mode" data-pan-mode>\r\n                    <i class="fa fa-arrows fa-fw"></i>\r\n                </button>\r\n            </div>\r\n            <div class="btn-group btn-group-vertical ">  \r\n                <button class="btn btn-small" title="Zooming" data-zoom-in>\r\n                    <i class="fa fa-search-plus fa-fw"></i>\r\n                 </button>    \r\n                <button class="btn btn-small" title="Zooming" data-zoom-out>\r\n                    <i class="fa fa-search-minus fa-fw"></i>\r\n                </button>    \r\n                <button class="btn btn-small" title="Zooming" data-reset>\r\n                    <i class="fa fa-circle-o fa-fw"></i>\r\n                </button>\r\n            </div>\r\n            <div class="btn-group btn-group-vertical dropdown">  \r\n                <button class="btn btn-small" title="Download" data-download>\r\n                    <i class="fa fa-download fa-fw"></i>\r\n                </button>\r\n                <ul class="dropdown-menu">\r\n                    <li><a href="#" class="ep-download" data-download-csv>.csv</a></li>\r\n                    <li><a href="#" class="ep-download" data-download-png>.png</a></li>\r\n                    <li><a href="#" class="ep-download" data-download-svg>.svg</a></li>\r\n                </ul>\r\n            </div>\r\n            <div class="hide">\r\n                <div data-go-fullscreen-desc>\r\n                    View your plot in full screen.\r\n                </div>\r\n                <div data-tag-mode-desc>\r\n                    <div>\r\n                        Choose \'Tag Mode\' to add data tags and filter selected points in your plot.\r\n                    </div>\r\n                </div>\r\n                <div data-pan-mode-desc>\r\n                    <ul>\r\n                        <li>Double click or scroll wheel to zoom in.</li>\r\n                        <li>Drag to pan.</li>\r\n                        <li>Shift-double click to zoom out.</li>\r\n                        <li>Or use incremental zoom \r\n                            <i class=\'fa fa-search-plus\'></i>,\r\n                            <i class=\'fa fa-search-minus\'></i> and reset\r\n                            <i class=\'fa fa-circle-o\'></i>\r\n                            buttons to control zoom.\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div data-zoom-in-desc>\r\n                    Zoom in (\'+\' key)\r\n                </div>\r\n                <div data-zoom-out-desc>\r\n                    Zoom out (\'-\' key)\r\n                </div>\r\n                <div data-reset-desc>\r\n                    Reset zoom (\'0\' key)\r\n                </div>\r\n                <div data-download-desc>\r\n                    Download data table as .csv or plot as .png or .svg.\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="aps-analysis-plot-sidebar-tmpl" type="text/template">\r\n            <div data-warnings-el class="accordion-group hide">\r\n            </div>\r\n            <div data-parameters-el class="accordion-group">\r\n            </div>\r\n            <div data-filters-el class="accordion-group">\r\n            </div>\r\n            <div data-tagging-el class="accordion-group">\r\n            </div>\r\n        </script>\r\n        <script id="apss-analysis-plot-sidebar-tmpl" type="text/template">\r\n            <div data-filters-el class="accordion-group">\r\n            </div>\r\n            <div data-tagging-el class="accordion-group">\r\n            </div>\r\n        </script>\r\n        <script id="ep-analysis-plot-sidebar-warnings-tmpl" type="text/template">\r\n            <div class="accordion-heading">\r\n                <a class="accordion-toggle" href="#">\r\n                    <i class="icon-chevron-down"></i> \r\n                    <span class="label label-warning">Warnings</span>\r\n                </a>\r\n            </div>\r\n            <div class="accordion-body collapse in">\r\n                <div class="accordion-inner">\r\n                <ul class="unstyled">\r\n                <% _.each(items, function(item) { %>\r\n                    <li><div class="alert"><%= item.warning %></div></li>\r\n                <% }) %>\r\n                </ul>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-analysis-plot-sidebar-parameters-tmpl" type="text/template">\r\n            <div class="accordion-heading">\r\n                <a class="accordion-toggle" href="#">\r\n                    <i class="icon-chevron-<% if (opened) { %>down<% } else { %>right<% } %>"></i> \r\n                    Analysis Parameters\r\n                </a>\r\n            </div>\r\n            <div class="accordion-body collapse <% if (opened) { %>in<% } %>">\r\n                <div data-inner-region class="accordion-inner light-blue"></div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-parameters-summary-tmpl" type="text/template">\r\n            <ul class="unstyled">\r\n            </ul>\r\n            <% if (withModify) { %>\r\n                <button data-modify class="btn btn-warning pull-right">Modify</button>\r\n            <% } %>\r\n        </script>\r\n        <script id="ep-parameters-summary-item-tmpl" type="text/template">\r\n            <dl class="<% if (isRoot) { %>dl-horizontal<% } %>">\r\n                <dt><%= readableLabel %></dt>\r\n                <dd>\r\n                    <%= readableValue %>\r\n                    <ul class="unstyled"></ul>\r\n                </dd>\r\n            </dl>\r\n        </script>\r\n        <script id="ep-analysis-plot-sidebar-filters-tmpl" type="text/template">\r\n            <div class="accordion-heading">\r\n                <a class="accordion-toggle" href="#">\r\n                    <i class="icon-chevron-right"></i> \r\n                    <span data-label>Filters: None</span>\r\n                    <span data-nb-filters class="pull-right"></span>\r\n                </a>\r\n            </div>\r\n            <div class="accordion-body collapse">\r\n                <div class="accordion-inner">\r\n                <ul data-inner-region class="unstyled"></ul>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-analysis-plot-sidebar-filters-item-tmpl" type="text/template">\r\n            <dl class="dl-horizontal">\r\n                <dt>\r\n                    <span class="ep-ext-label label label-default"><%= label %></span>\r\n                    <%= label %>\r\n                </dt>\r\n                <dd data-filters-region></dd>\r\n            </dl>\r\n        </script>\r\n        <script id="ep-analysis-plot-sidebar-tagging-tmpl" type="text/template">\r\n            <div class="accordion-heading">\r\n                <a class="accordion-toggle" href="#">\r\n                    <i class="icon-chevron-right"></i> \r\n                    Tag Points\r\n                </a>\r\n            </div>\r\n            <div class="accordion-body collapse">\r\n                <div class="accordion-inner">\r\n                    <div class="row-fluid">\r\n                        <div class="span6">\r\n                        <select class="span">\r\n                            <option selected>Select a field for tagging</option>\r\n                            <% _.each(items, function(metaItem, i) { %>\r\n                            <option value="<%= i %>">\r\n                                <%= metaItem.label %>\r\n                            </option>\r\n                            <% }) %>\r\n                        </select>\r\n                        <ul class="">\r\n                            <li>\r\n                                Highlight a group of points or click on a single point to tag.\r\n                            </li>\r\n                            <li>\r\n                                Hold down shift to append your tags.\r\n                            </li>\r\n                            <li>\r\n                                Filter out the untagged points with the "Filter Tagged" button.\r\n                            </li>\r\n                        </ul>\r\n                        </div>\r\n                        <div class="span6">\r\n                            <ul class="unstyled text-center">\r\n                                <li><p>Add the selected data field to the plot.</p></li>\r\n                                <li>\r\n                                <div class="btn-group">\r\n                                    <button data-tag class="btn btn-small"><i class="icon-tag"></i> Tag All Visible</button>\r\n                                    <button data-clear class="btn btn-small" disabled><i class="icon-remove"></i> Clear All</button>\r\n                                </div>\r\n                                </li>\r\n                                <li><i>or</i></li>\r\n                                <li>\r\n                                <div class="btn-group">\r\n                                    <button data-filter-tagged class="btn btn-small" disabled><i class="icon-filter"></i> Filter Tagged</button>\r\n                                    <button data-release class="btn btn-small" disabled><i class="icon-remove"></i> Release</button>\r\n                                </div>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-btn-tmpl" type="text/mustache">\r\n            <button class="btn {{btnClass}}">{{#icon}}<i class="{{icon}}"></i> {{/icon}}{{&label}}</button>\r\n        </script>\r\n        <script id="ep-btn-group-tmpl" type="text/mustache">\r\n            <div class="btn-group {{#vertical}}btn-group-vertical{{/vertical}} {{groupClass}}">\r\n                {{#btns}}\r\n                    {{&.}}\r\n                {{/btns}}\r\n            </div>\r\n        </script>\r\n        <script id="ep-popover" type="text/template">\r\n             <div class="popover fade in">\r\n             <% if (arrow) { %><div class="arrow"></div><% } %>\r\n                <h3 class="popover-title">\r\n                    <% if (close) { %><button class="close">&times;</button><% } %>\r\n                    <%= title %>\r\n                </h3>\r\n                <div class="popover-content">\r\n                    <p><%= content %></p>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-numeric-filter-tmpl" type="text/template">\r\n            <span class="add-on"><% if (le) { %>&le;<% } %><% if (ge) { %>&ge;<% } %></span>\r\n            <input type="text" class="input-mini" />\r\n            <button class="btn btn-link">Clear</button>\r\n        </script>\r\n        <script id="ep-character-filter-tmpl" type="text/template">\r\n            <span class="add-on">contains</span>\r\n            <input type="text" class="input-mini" />\r\n            <button class="btn btn-link">Clear</button>\r\n        </script>\r\n        <script id="ep-dl-tmpl" type="text/template">\r\n            <dl class="<% if (horizontal) { %>dl-horizontal<% } %>">\r\n                <% _.each(items, function(item) { %>\r\n                <dt><%= item.label %></dt>\r\n                <dd>\r\n                    <%= item.value %>\r\n                </dd>\r\n                <% }) %>\r\n            </dl>\r\n        </script>\r\n        <script id="ep-load-indicator-tmpl" type="text/template">\r\n            <div class="ep-load-indicator ep-load-indicator-bowlG">\r\n                <div class="ep-load-indicator-bowl_ringG">\r\n                    <div class="ep-load-indicator-ball_holderG">\r\n                        <div class="ep-load-indicator-ballG">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </script>\r\n        <script id="ep-alert-tmpl" type="text/template">\r\n            <div class="alert <% if (title) { %>alert-block<% } %> <% if (type) { %>alert-<%= type %><% } %>">\r\n              <% if  (withClose) { %><button type="button" class="close" data-dismiss="alert">&times;</button><% } %>\r\n              <% if (title) { %><h4><%= title %></h4><% } %>\r\n              <%= text %>\r\n            </div>\r\n        </script>\r\n        <script id="ep-modal-tmpl" type="text/template">\r\n            <div class="modal-header">\r\n                <% if (withClose) { %>\r\n                    <button type="button" class="close" aria-hidden="true">&times;</button>\r\n                <% } %>\r\n                <h3><%= title %></h3>\r\n            </div>\r\n            <div class="modal-body" data-body-region></div>\r\n            <div class="modal-footer">\r\n                <% if (progressBar) { %><div class="progress"><div class="bar"></div></div><% } %>\r\n                <% if (cancelBtnLabel) { %><a data-cancel href="#" class="btn btn-cancel"><%= cancelBtnLabel %></a><% } %>\r\n                <% if (doBtnLabel) { %><a data-primary href="#" class="btn btn-primary"><%= doBtnLabel %></a><% } %>\r\n                <% if (altBtnLabel) { %><a data-alt-1 href="#" class="btn btn-primary"><%= altBtnLabel %></a><% } %>\r\n            </div>\r\n        </script>\r\n        <script id="apss-dataset-tmpl" type="text/template">\r\n            <div class="row-fluid">\r\n                <div class="span12">\r\n                    <p data-caption class="text-center lead"><%= label %></p>\r\n                </div>\r\n            </div>\r\n            <div data-analysis-region></div>\r\n        </script>\r\n</div>\r\n'}),define("TemplateCache.mod",["marionette","requirejs-text!templates.html"],function(e,t){var n=$(t);e.TemplateCache.prototype.loadTemplate=function(t){var r=n.find(t).html();if(!r||r.length===0)throw new e.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return r}}),function(e){function n(e){var n=e.length,r=t.type(e);return r==="function"||t.isWindow(e)?!1:e.nodeType===1&&n?!0:r==="array"||n===0||typeof n=="number"&&n>0&&n-1 in e}if(e.jQuery)return;var t=function(e,n){return new t.fn.init(e,n)};t.isWindow=function(e){return e!=null&&e==e.window},t.type=function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?i[o.call(e)]||"object":typeof e},t.isArray=Array.isArray||function(e){return t.type(e)==="array"},t.isPlainObject=function(e){var n;if(!e||t.type(e)!=="object"||e.nodeType||t.isWindow(e))return!1;try{if(e.constructor&&!s.call(e,"constructor")&&!s.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(n in e);return n===undefined||s.call(e,n)},t.each=function(e,t,r){var i,s=0,o=e.length,u=n(e);if(r)if(u)for(;s<o;s++){i=t.apply(e[s],r);if(i===!1)break}else for(s in e){i=t.apply(e[s],r);if(i===!1)break}else if(u)for(;s<o;s++){i=t.call(e[s],s,e[s]);if(i===!1)break}else for(s in e){i=t.call(e[s],s,e[s]);if(i===!1)break}return e},t.data=function(e,n,i){if(i===undefined){var s=e[t.expando],o=s&&r[s];if(n===undefined)return o;if(o&&n in o)return o[n]}else if(n!==undefined){var s=e[t.expando]||(e[t.expando]=++t.uuid);return r[s]=r[s]||{},r[s][n]=i,i}},t.removeData=function(e,n){var i=e[t.expando],s=i&&r[i];s&&t.each(n,function(e,t){delete s[t]})},t.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[a]||{},a++),typeof u!="object"&&t.type(u)!=="function"&&(u={}),a===f&&(u=this,a--);for(;a<f;a++)if((s=arguments[a])!=null)for(i in s){e=u[i],r=s[i];if(u===r)continue;l&&r&&(t.isPlainObject(r)||(n=t.isArray(r)))?(n?(n=!1,o=e&&t.isArray(e)?e:[]):o=e&&t.isPlainObject(e)?e:{},u[i]=t.extend(l,o,r)):r!==undefined&&(u[i]=r)}return u},t.queue=function(e,r,i){function s(e,t){var r=t||[];return e!=null&&(n(Object(e))?function(e,t){var n=+t.length,r=0,i=e.length;while(r<n)e[i++]=t[r++];if(n!==n)while(t[r]!==undefined)e[i++]=t[r++];return e.length=i,e}(r,typeof e=="string"?[e]:e):[].push.call(r,e)),r}if(!e)return;r=(r||"fx")+"queue";var o=t.data(e,r);return i?(!o||t.isArray(i)?o=t.data(e,r,s(i)):o.push(i),o):o||[]},t.dequeue=function(e,n){t.each(e.nodeType?[e]:e,function(e,r){n=n||"fx";var i=t.queue(r,n),s=i.shift();s==="inprogress"&&(s=i.shift()),s&&(n==="fx"&&i.unshift("inprogress"),s.call(r,function(){t.dequeue(r,n)}))})},t.fn=t.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){var e=this.offsetParent||document;while(e&&!e.nodeType.toLowerCase==="html"&&e.style.position==="static")e=e.offsetParent;return e||document}var n=this[0],e=e.apply(n),r=this.offset(),i=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:t(e).offset();return r.top-=parseFloat(n.style.marginTop)||0,r.left-=parseFloat(n.style.marginLeft)||0,e.style&&(i.top+=parseFloat(e.style.borderTopWidth)||0,i.left+=parseFloat(e.style.borderLeftWidth)||0),{top:r.top-i.top,left:r.left-i.left}}};var r={};t.expando="velocity"+(new Date).getTime(),t.uuid=0;var i={},s=i.hasOwnProperty,o=i.toString,u="Boolean Number String Function Array Date RegExp Object Error".split(" ");for(var a=0;a<u.length;a++)i["[object "+u[a]+"]"]=u[a].toLowerCase();t.fn.init.prototype=t.fn,e.Velocity={Utilities:t}}(window),function(e){typeof module=="object"&&typeof module.exports=="object"?module.exports=e():typeof define=="function"&&define.amd?define("velocity",e):e()}(function(){return function(e,t,n,r){function o(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function u(e){return a.isWrapped(e)?e=[].slice.call(e):a.isNode(e)&&(e=[e]),e}function d(e){var t=f.data(e,"velocity");return t===null?r:t}function v(e){return function(t){return Math.round(t*e)*(1/e)}}function m(e,n,r,i){function d(e,t){return 1-3*t+3*e}function v(e,t){return 3*t-6*e}function m(e){return 3*e}function g(e,t,n){return((d(t,n)*e+v(t,n))*e+m(t))*e}function y(e,t,n){return 3*d(t,n)*e*e+2*v(t,n)*e+m(t)}function b(t,n){for(var i=0;i<s;++i){var o=y(n,e,r);if(o===0)return n;var u=g(n,e,r)-t;n-=u/o}return n}function w(){for(var t=0;t<f;++t)p[t]=g(t*l,e,r)}function E(t,n,i){var s,o,f=0;do o=n+(i-n)/2,s=g(o,e,r)-t,s>0?i=o:n=o;while(Math.abs(s)>u&&++f<a);return o}function S(t){var n=0,i=1,s=f-1;for(;i!=s&&p[i]<=t;++i)n+=l;--i;var u=(t-p[i])/(p[i+1]-p[i]),a=n+u*l,c=y(a,e,r);return c>=o?b(t,a):c==0?a:E(t,n,n+l)}function T(){x=!0,(e!=n||r!=i)&&w()}var s=4,o=.001,u=1e-7,a=10,f=11,l=1/(f-1),c="Float32Array"in t;if(arguments.length!==4)return!1;for(var h=0;h<4;++h)if(typeof arguments[h]!="number"||isNaN(arguments[h])||!isFinite(arguments[h]))return!1;e=Math.min(e,1),r=Math.min(r,1),e=Math.max(e,0),r=Math.max(r,0);var p=c?new Float32Array(f):new Array(f),x=!1,N=function(t){return x||T(),e===n&&r===i?t:t===0?0:t===1?1:g(S(t),n,i)};N.getControlPoints=function(){return[{x:e,y:n},{x:r,y:i}]};var C="generateBezier("+[e,n,r,i]+")";return N.toString=function(){return C},N}function y(e,t){var n=e;return a.isString(e)?p.Easings[e]||(n=!1):a.isArray(e)&&e.length===1?n=v.apply(null,e):a.isArray(e)&&e.length===2?n=g.apply(null,e.concat([t])):a.isArray(e)&&e.length===4?n=m.apply(null,e):n=!1,n===!1&&(p.Easings[p.defaults.easing]?n=p.defaults.easing:n=h),n}function S(e){if(e){var t=(new Date).getTime(),n=p.State.calls.length;n>1e4&&(p.State.calls=o(p.State.calls));for(var i=0;i<n;i++){if(!p.State.calls[i])continue;var s=p.State.calls[i],u=s[0],l=s[2],c=s[3],h=!!c,v=null;c||(c=p.State.calls[i][3]=t-16);var m=Math.min((t-c)/l.duration,1);for(var g=0,y=u.length;g<y;g++){var w=u[g],T=w.element;if(!d(T))continue;var N=!1;if(l.display!==r&&l.display!==null&&l.display!=="none"){if(l.display==="flex"){var C=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];f.each(C,function(e,t){b.setPropertyValue(T,"display",t)})}b.setPropertyValue(T,"display",l.display)}l.visibility!==r&&l.visibility!=="hidden"&&b.setPropertyValue(T,"visibility",l.visibility);for(var k in w)if(k!=="element"){var L=w[k],A,O=a.isString(L.easing)?p.Easings[L.easing]:L.easing;if(m===1)A=L.endValue;else{var M=L.endValue-L.startValue;A=L.startValue+M*O(m,l,M);if(!h&&A===L.currentValue)continue}L.currentValue=A;if(k==="tween")v=A;else{if(b.Hooks.registered[k]){var _=b.Hooks.getRoot(k),D=d(T).rootPropertyValueCache[_];D&&(L.rootPropertyValue=D)}var P=b.setPropertyValue(T,k,L.currentValue+(parseFloat(A)===0?"":L.unitType),L.rootPropertyValue,L.scrollData);b.Hooks.registered[k]&&(b.Normalizations.registered[_]?d(T).rootPropertyValueCache[_]=b.Normalizations.registered[_]("extract",null,P[1]):d(T).rootPropertyValueCache[_]=P[1]),P[0]==="transform"&&(N=!0)}}l.mobileHA&&d(T).transformCache.translate3d===r&&(d(T).transformCache.translate3d="(0px, 0px, 0px)",N=!0),N&&b.flushTransformCache(T)}l.display!==r&&l.display!=="none"&&(p.State.calls[i][2].display=!1),l.visibility!==r&&l.visibility!=="hidden"&&(p.State.calls[i][2].visibility=!1),l.progress&&l.progress.call(s[1],s[1],m,Math.max(0,c+l.duration-t),c,v),m===1&&x(i)}}p.State.isTicking&&E(S)}function x(e,t){if(!p.State.calls[e])return!1;var n=p.State.calls[e][0],i=p.State.calls[e][1],s=p.State.calls[e][2],o=p.State.calls[e][4],u=!1;for(var a=0,l=n.length;a<l;a++){var c=n[a].element;!t&&!s.loop&&(s.display==="none"&&b.setPropertyValue(c,"display",s.display),s.visibility==="hidden"&&b.setPropertyValue(c,"visibility",s.visibility));if(s.loop!==!0&&(f.queue(c)[1]===r||!/\.velocityQueueEntryFlag/i.test(f.queue(c)[1]))&&d(c)){d(c).isAnimating=!1,d(c).rootPropertyValueCache={};var h=!1;f.each(b.Lists.transforms3D,function(e,t){var n=/^scale/.test(t)?1:0,i=d(c).transformCache[t];d(c).transformCache[t]!==r&&(new RegExp("^\\("+n+"[^.]")).test(i)&&(h=!0,delete d(c).transformCache[t])}),s.mobileHA&&(h=!0,delete d(c).transformCache.translate3d),h&&b.flushTransformCache(c),b.Values.removeClass(c,"velocity-animating")}if(!t&&s.complete&&!s.loop&&a===l-1)try{s.complete.call(i,i)}catch(v){setTimeout(function(){throw v},1)}o&&s.loop!==!0&&o(i),d(c)&&s.loop===!0&&!t&&(f.each(d(c).tweensContainer,function(e,t){/^rotate/.test(e)&&parseFloat(t.endValue)===360&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&parseFloat(t.endValue)===100&&t.unitType==="%"&&(t.endValue=0,t.startValue=100)}),p(c,"reverse",{loop:!0,delay:s.delay})),s.queue!==!1&&f.dequeue(c,s.queue)}p.State.calls[e]=!1;for(var m=0,g=p.State.calls.length;m<g;m++)if(p.State.calls[m]!==!1){u=!0;break}u===!1&&(p.State.isTicking=!1,delete p.State.calls,p.State.calls=[])}var i=function(){if(n.documentMode)return n.documentMode;for(var e=7;e>4;e--){var t=n.createElement("div");t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->";if(t.getElementsByTagName("span").length)return t=null,e}return r}(),s=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var n=(new Date).getTime(),r;return r=Math.max(0,16-(n-e)),e=n+r,setTimeout(function(){t(n+r)},r)}}(),a={isString:function(e){return typeof e=="string"},isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},isFunction:function(e){return Object.prototype.toString.call(e)==="[object Function]"},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return typeof e=="object"&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==r&&(e.length===0||typeof e[0]=="object"&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},f,l=!1;e.fn&&e.fn.jquery?(f=e,l=!0):f=t.Velocity.Utilities;if(i<=8&&!l)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(i<=7){jQuery.fn.velocity=jQuery.fn.animate;return}var c=400,h="swing",p={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:f,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:c,easing:h,begin:r,complete:r,progress:r,display:r,visibility:r,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){f.data(e,"velocity",{isSVG:a.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==r?(p.State.scrollAnchor=t,p.State.scrollPropertyLeft="pageXOffset",p.State.scrollPropertyTop="pageYOffset"):(p.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,p.State.scrollPropertyLeft="scrollLeft",p.State.scrollPropertyTop="scrollTop");var g=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,n,r){var i={x:t.x+r.dx*n,v:t.v+r.dv*n,tension:t.tension,friction:t.friction};return{dx:i.v,dv:e(i)}}function n(n,r){var i={dx:n.v,dv:e(n)},s=t(n,r*.5,i),o=t(n,r*.5,s),u=t(n,r,o),a=1/6*(i.dx+2*(s.dx+o.dx)+u.dx),f=1/6*(i.dv+2*(s.dv+o.dv)+u.dv);return n.x=n.x+a*r,n.v=n.v+f*r,n}return function r(e,t,i){var s={x:-1,v:0,tension:null,friction:null},o=[0],u=0,a=1e-4,f=.016,l,c,h;e=parseFloat(e)||500,t=parseFloat(t)||20,i=i||null,s.tension=e,s.friction=t,l=i!==null,l?(u=r(e,t),c=u/i*f):c=f;for(;;){h=n(h||s,c),o.push(1+h.x),u+=16;if(!(Math.abs(h.x)>a&&Math.abs(h.v)>a))break}return l?function(e){return o[e*(o.length-1)|0]}:u}}();p.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(e*4.5*Math.PI)*Math.exp(-e*6)}},f.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){p.Easings[t[0]]=m.apply(null,t[1])});var b=p.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/ig},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<b.Lists.colors.length;e++){var t=b.Lists.colors[e]==="color"?"0 0 0 1":"255 255 255 1";b.Hooks.templates[b.Lists.colors[e]]=["Red Green Blue Alpha",t]}var n,r,s;if(i)for(n in b.Hooks.templates){r=b.Hooks.templates[n],s=r[0].split(" ");var o=r[1].match(b.RegEx.valueSplit);s[0]==="Color"&&(s.push(s.shift()),o.push(o.shift()),b.Hooks.templates[n]=[s.join(" "),o.join(" ")])}for(n in b.Hooks.templates){r=b.Hooks.templates[n],s=r[0].split(" ");for(var e in s){var u=n+s[e],a=e;b.Hooks.registered[u]=[n,a]}}},getRoot:function(e){var t=b.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return b.RegEx.valueUnwrap.test(t)&&(t=t.match(b.RegEx.valueUnwrap)[1]),b.Values.isCSSNullValue(t)&&(t=b.Hooks.templates[e][1]),t},extractValue:function(e,t){var n=b.Hooks.registered[e];if(n){var r=n[0],i=n[1];return t=b.Hooks.cleanRootPropertyValue(r,t),t.toString().match(b.RegEx.valueSplit)[i]}return t},injectValue:function(e,t,n){var r=b.Hooks.registered[e];if(r){var i=r[0],s=r[1],o,u;return n=b.Hooks.cleanRootPropertyValue(i,n),o=n.toString().match(b.RegEx.valueSplit),o[s]=t,u=o.join(" "),u}return n}},Normalizations:{registered:{clip:function(e,t,n){switch(e){case"name":return"clip";case"extract":var r;return b.RegEx.wrappedValueAlreadyExtracted.test(n)?r=n:(r=n.toString().match(b.RegEx.valueUnwrap),r=r?r[1].replace(/,(\s+)?/g," "):n),r;case"inject":return"rect("+n+")"}},blur:function(e,t,n){switch(e){case"name":return p.State.isFirefox?"filter":"-webkit-filter";case"extract":var r=parseFloat(n);if(!r&&r!==0){var i=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);i?r=i[1]:r=0}return r;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(e,t,n){if(i<=8)switch(e){case"name":return"filter";case"extract":var r=n.toString().match(/alpha\(opacity=(.*)\)/i);return r?n=r[1]/100:n=1,n;case"inject":return t.style.zoom=1,parseFloat(n)>=1?"":"alpha(opacity="+parseInt(parseFloat(n)*100,10)+")"}else switch(e){case"name":return"opacity";case"extract":return n;case"inject":return n}}},register:function(){!(i<=9)&&!p.State.isGingerbread&&(b.Lists.transformsBase=b.Lists.transformsBase.concat(b.Lists.transforms3D));for(var e=0;e<b.Lists.transformsBase.length;e++)(function(){var t=b.Lists.transformsBase[e];b.Normalizations.registered[t]=function(e,n,i){switch(e){case"name":return"transform";case"extract":return d(n)===r||d(n).transformCache[t]===r?/^scale/i.test(t)?1:0:d(n).transformCache[t].replace(/[()]/g,"");case"inject":var s=!1;switch(t.substr(0,t.length-1)){case"translate":s=!/(%|px|em|rem|vw|vh|\d)$/i.test(i);break;case"scal":case"scale":p.State.isAndroid&&d(n).transformCache[t]===r&&i<1&&(i=1),s=!/(\d)$/i.test(i);break;case"skew":s=!/(deg|\d)$/i.test(i);break;case"rotate":s=!/(deg|\d)$/i.test(i)}return s||(d(n).transformCache[t]="("+i+")"),d(n).transformCache[t]}}})();for(var e=0;e<b.Lists.colors.length;e++)(function(){var t=b.Lists.colors[e];b.Normalizations.registered[t]=function(e,n,s){switch(e){case"name":return t;case"extract":var o;if(b.RegEx.wrappedValueAlreadyExtracted.test(s))o=s;else{var u,a={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(s)?a[s]!==r?u=a[s]:u=a.black:b.RegEx.isHex.test(s)?u="rgb("+b.Values.hexToRgb(s).join(" ")+")":/^rgba?\(/i.test(s)||(u=a.black),o=(u||s).toString().match(b.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return!(i<=8)&&o.split(" ").length===3&&(o+=" 1"),o;case"inject":return i<=8?s.split(" ").length===4&&(s=s.split(/\s+/).slice(0,3).join(" ")):s.split(" ").length===3&&(s+=" 1"),(i<=8?"rgb":"rgba")+"("+s.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}})()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";if(i||p.State.isAndroid&&!p.State.isChrome)t+="|transform";return(new RegExp("^("+t+")$","i")).test(e)},prefixCheck:function(e){if(p.State.prefixMatches[e])return[p.State.prefixMatches[e],!0];var t=["","Webkit","Moz","ms","O"];for(var n=0,r=t.length;n<r;n++){var i;n===0?i=e:i=t[n]+e.replace(/^\w/,function(e){return e.toUpperCase()});if(a.isString(p.State.prefixElement.style[i]))return p.State.prefixMatches[e]=i,[i,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,r;return e=e.replace(t,function(e,t,n,r){return t+t+n+n+r+r}),r=n.exec(e),r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:[0,0,0]},isCSSNullValue:function(e){return e==0||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,n,s,o){function u(e,n){var s=0;if(i<=8)s=f.css(e,n);else{var a=!1;/^(width|height)$/.test(n)&&b.getPropertyValue(e,"display")===0&&(a=!0,b.setPropertyValue(e,"display",b.Values.getDisplayType(e)));function l(){a&&b.setPropertyValue(e,"display","none")}if(!o){if(n==="height"&&b.getPropertyValue(e,"boxSizing").toString().toLowerCase()!=="border-box"){var c=e.offsetHeight-(parseFloat(b.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(b.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(b.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(b.getPropertyValue(e,"paddingBottom"))||0);return l(),c}if(n==="width"&&b.getPropertyValue(e,"boxSizing").toString().toLowerCase()!=="border-box"){var h=e.offsetWidth-(parseFloat(b.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(b.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(b.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(b.getPropertyValue(e,"paddingRight"))||0);return l(),h}}var p;d(e)===r?p=t.getComputedStyle(e,null):d(e).computedStyle?p=d(e).computedStyle:p=d(e).computedStyle=t.getComputedStyle(e,null),n==="borderColor"&&(n="borderTopColor"),i===9&&n==="filter"?s=p.getPropertyValue(n):s=p[n];if(s===""||s===null)s=e.style[n];l()}if(s==="auto"&&/^(top|right|bottom|left)$/i.test(n)){var v=u(e,"position");if(v==="fixed"||v==="absolute"&&/top|left/i.test(n))s=f(e).position()[n]+"px"}return s}var a;if(b.Hooks.registered[n]){var l=n,c=b.Hooks.getRoot(l);s===r&&(s=b.getPropertyValue(e,b.Names.prefixCheck(c)[0])),b.Normalizations.registered[c]&&(s=b.Normalizations.registered[c]("extract",e,s)),a=b.Hooks.extractValue(l,s)}else if(b.Normalizations.registered[n]){var h,v;h=b.Normalizations.registered[n]("name",e),h!=="transform"&&(v=u(e,b.Names.prefixCheck(h)[0]),b.Values.isCSSNullValue(v)&&b.Hooks.templates[n]&&(v=b.Hooks.templates[n][1])),a=b.Normalizations.registered[n]("extract",e,v)}if(!/^[\d-]/.test(a))if(d(e)&&d(e).isSVG&&b.Names.SVGAttribute(n))if(/^(height|width)$/i.test(n))try{a=e.getBBox()[n]}catch(m){a=0}else a=e.getAttribute(n);else a=u(e,b.Names.prefixCheck(n)[0]);return b.Values.isCSSNullValue(a)&&(a=0),p.debug>=2&&console.log("Get "+n+": "+a),a},setPropertyValue:function(e,n,r,s,o){var u=n;if(n==="scroll")o.container?o.container["scroll"+o.direction]=r:o.direction==="Left"?t.scrollTo(r,o.alternateValue):t.scrollTo(o.alternateValue,r);else if(b.Normalizations.registered[n]&&b.Normalizations.registered[n]("name",e)==="transform")b.Normalizations.registered[n]("inject",e,r),u="transform",r=d(e).transformCache[n];else{if(b.Hooks.registered[n]){var a=n,f=b.Hooks.getRoot(n);s=s||b.getPropertyValue(e,f),r=b.Hooks.injectValue(a,r,s),n=f}b.Normalizations.registered[n]&&(r=b.Normalizations.registered[n]("inject",e,r),n=b.Normalizations.registered[n]("name",e)),u=b.Names.prefixCheck(n)[0];if(i<=8)try{e.style[u]=r}catch(l){p.debug&&console.log("Browser does not support ["+r+"] for ["+u+"]")}else d(e)&&d(e).isSVG&&b.Names.SVGAttribute(n)?e.setAttribute(n,r):e.style[u]=r;p.debug>=2&&console.log("Set "+n+" ("+u+"): "+r)}return[u,r]},flushTransformCache:function(e){var t="";if((i||p.State.isAndroid&&!p.State.isChrome)&&d(e).isSVG){function n(t){return parseFloat(b.getPropertyValue(e,t))}var r={translate:[n("translateX"),n("translateY")],skewX:[n("skewX")],skewY:[n("skewY")],scale:n("scale")!==1?[n("scale"),n("scale")]:[n("scaleX"),n("scaleY")],rotate:[n("rotateZ"),0,0]};f.each(d(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),r[e]&&(t+=e+"("+r[e].join(" ")+")"+" ",delete r[e])})}else{var s,o;f.each(d(e).transformCache,function(n){s=d(e).transformCache[n];if(n==="transformPerspective")return o=s,!0;i===9&&n==="rotateZ"&&(n="rotate"),t+=n+s+" "}),o&&(t="perspective"+o+" "+t)}b.setPropertyValue(e,"transform",t)}};b.Hooks.register(),b.Normalizations.register(),p.hook=function(e,t,n){var i=r;return e=u(e),f.each(e,function(e,s){d(s)===r&&p.init(s);if(n===r)i===r&&(i=p.CSS.getPropertyValue(s,t));else{var o=p.CSS.setPropertyValue(s,t,n);o[0]==="transform"&&p.CSS.flushTransformCache(s),i=o}}),i};var w=function(){function e(){return s?C.promise||null:o}function H(){function u(u){if(i.begin&&E===0)try{i.begin.call(h,h)}catch(l){setTimeout(function(){throw l},1)}if(k==="scroll"){var c=/^x$/i.test(i.axis)?"Left":"Top",w=parseFloat(i.offset)||0,x,T,N;i.container?a.isWrapped(i.container)||a.isNode(i.container)?(i.container=i.container[0]||i.container,x=i.container["scroll"+c],N=x+f(e).position()[c.toLowerCase()]+w):i.container=null:(x=p.State.scrollAnchor[p.State["scrollProperty"+c]],T=p.State.scrollAnchor[p.State["scrollProperty"+(c==="Left"?"Top":"Left")]],N=f(e).offset()[c.toLowerCase()]+w),s={scroll:{rootPropertyValue:!1,startValue:x,currentValue:x,endValue:N,unitType:"",easing:i.easing,scrollData:{container:i.container,direction:c,alternateValue:T}},element:e},p.debug&&console.log("tweensContainer (scroll): ",s.scroll,e)}else if(k==="reverse"){if(!d(e).tweensContainer){f.dequeue(e,i.queue);return}d(e).opts.display==="none"&&(d(e).opts.display="auto"),d(e).opts.visibility==="hidden"&&(d(e).opts.visibility="visible"),d(e).opts.loop=!1,d(e).opts.begin=null,d(e).opts.complete=null,m.easing||delete i.easing,m.duration||delete i.duration,i=f.extend({},d(e).opts,i);var L=f.extend(!0,{},d(e).tweensContainer);for(var A in L)if(A!=="element"){var O=L[A].startValue;L[A].startValue=L[A].currentValue=L[A].endValue,L[A].endValue=O,a.isEmptyObject(m)||(L[A].easing=i.easing),p.debug&&console.log("reverse tweensContainer ("+A+"): "+JSON.stringify(L[A]),e)}s=L}else if(k==="start"){var L;d(e).tweensContainer&&d(e).isAnimating===!0&&(L=d(e).tweensContainer);function M(t,n){var s=r,o=r,u=r;if(a.isArray(t)){s=t[0];if(!a.isArray(t[1])&&/^[\d-]/.test(t[1])||a.isFunction(t[1])||b.RegEx.isHex.test(t[1]))u=t[1];else if(a.isString(t[1])&&!b.RegEx.isHex.test(t[1])||a.isArray(t[1]))o=n?t[1]:y(t[1],i.duration),t[2]!==r&&(u=t[2])}else s=t;return n||(o=o||i.easing),a.isFunction(s)&&(s=s.call(e,E,g)),a.isFunction(u)&&(u=u.call(e,E,g)),[s||0,o,u]}f.each(v,function(e,t){if(RegExp("^"+b.Lists.colors.join("$|^")+"$").test(e)){var n=M(t,!0),i=n[0],s=n[1],o=n[2];if(b.RegEx.isHex.test(i)){var u=["Red","Green","Blue"],a=b.Values.hexToRgb(i),f=o?b.Values.hexToRgb(o):r;for(var l=0;l<u.length;l++){var c=[a[l]];s&&c.push(s),f!==r&&c.push(f[l]),v[e+u[l]]=c}delete v[e]}}});for(var _ in v){var H=M(v[_]),B=H[0],j=H[1],F=H[2];_=b.Names.camelCase(_);var I=b.Hooks.getRoot(_),q=!1;if(!d(e).isSVG&&I!=="tween"&&b.Names.prefixCheck(I)[1]===!1&&b.Normalizations.registered[I]===r){p.debug&&console.log("Skipping ["+I+"] due to a lack of browser support.");continue}(i.display!==r&&i.display!==null&&i.display!=="none"||i.visibility!==r&&i.visibility!=="hidden")&&/opacity|filter/.test(_)&&!F&&B!==0&&(F=0),i._cacheValues&&L&&L[_]?(F===r&&(F=L[_].endValue+L[_].unitType),q=d(e).rootPropertyValueCache[I]):b.Hooks.registered[_]?F===r?(q=b.getPropertyValue(e,I),F=b.getPropertyValue(e,_,q)):q=b.Hooks.templates[I][1]:F===r&&(F=b.getPropertyValue(e,_));var R,U,z,W=!1;function X(e,t){var n,r;return r=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return n=e,""}),n||(n=b.Values.getUnitType(e)),[r,n]}R=X(_,F),F=R[0],z=R[1],R=X(_,B),B=R[0].replace(/^([+-\/*])=/,function(e,t){return W=t,""}),U=R[1],F=parseFloat(F)||0,B=parseFloat(B)||0,U==="%"&&(/^(fontSize|lineHeight)$/.test(_)?(B/=100,U="em"):/^scale/.test(_)?(B/=100,U=""):/(Red|Green|Blue)$/i.test(_)&&(B=B/100*255,U=""));function V(){var r={myParent:e.parentNode||n.body,position:b.getPropertyValue(e,"position"),fontSize:b.getPropertyValue(e,"fontSize")},i=r.position===D.lastPosition&&r.myParent===D.lastParent,s=r.fontSize===D.lastFontSize;D.lastParent=r.myParent,D.lastPosition=r.position,D.lastFontSize=r.fontSize;var o=100,u={};if(!s||!i){var a=d(e).isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");p.init(a),r.myParent.appendChild(a),f.each(["overflow","overflowX","overflowY"],function(e,t){p.CSS.setPropertyValue(a,t,"hidden")}),p.CSS.setPropertyValue(a,"position",r.position),p.CSS.setPropertyValue(a,"fontSize",r.fontSize),p.CSS.setPropertyValue(a,"boxSizing","content-box"),f.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){p.CSS.setPropertyValue(a,t,o+"%")}),p.CSS.setPropertyValue(a,"paddingLeft",o+"em"),u.percentToPxWidth=D.lastPercentToPxWidth=(parseFloat(b.getPropertyValue(a,"width",null,!0))||1)/o,u.percentToPxHeight=D.lastPercentToPxHeight=(parseFloat(b.getPropertyValue(a,"height",null,!0))||1)/o,u.emToPx=D.lastEmToPx=(parseFloat(b.getPropertyValue(a,"paddingLeft"))||1)/o,r.myParent.removeChild(a)}else u.emToPx=D.lastEmToPx,u.percentToPxWidth=D.lastPercentToPxWidth,u.percentToPxHeight=D.lastPercentToPxHeight;return D.remToPx===null&&(D.remToPx=parseFloat(b.getPropertyValue(n.body,"fontSize"))||16),D.vwToPx===null&&(D.vwToPx=parseFloat(t.innerWidth)/100,D.vhToPx=parseFloat(t.innerHeight)/100),u.remToPx=D.remToPx,u.vwToPx=D.vwToPx,u.vhToPx=D.vhToPx,p.debug>=1&&console.log("Unit ratios: "+JSON.stringify(u),e),u}if(/[\/*]/.test(W))U=z;else if(z!==U&&F!==0)if(B===0)U=z;else{o=o||V();var J=/margin|padding|left|right|width|text|word|letter/i.test(_)||/X$/.test(_)||_==="x"?"x":"y";switch(z){case"%":F*=J==="x"?o.percentToPxWidth:o.percentToPxHeight;break;case"px":break;default:F*=o[z+"ToPx"]}switch(U){case"%":F*=1/(J==="x"?o.percentToPxWidth:o.percentToPxHeight);break;case"px":break;default:F*=1/o[U+"ToPx"]}}switch(W){case"+":B=F+B;break;case"-":B=F-B;break;case"*":B=F*B;break;case"/":B=F/B}s[_]={rootPropertyValue:q,startValue:F,currentValue:F,endValue:B,unitType:U,easing:j},p.debug&&console.log("tweensContainer ("+_+"): "+JSON.stringify(s[_]),e)}s.element=e}s.element&&(b.Values.addClass(e,"velocity-animating"),P.push(s),i.queue===""&&(d(e).tweensContainer=s,d(e).opts=i),d(e).isAnimating=!0,E===g-1?(p.State.calls.push([P,h,i,null,C.resolver]),p.State.isTicking===!1&&(p.State.isTicking=!0,S())):E++)}var e=this,i=f.extend({},p.defaults,m),s={},o;d(e)===r&&p.init(e),parseFloat(i.delay)&&i.queue!==!1&&f.queue(e,i.queue,function(t){p.velocityQueueEntryFlag=!0,d(e).delayTimer={setTimeout:setTimeout(t,parseFloat(i.delay)),next:t}});switch(i.duration.toString().toLowerCase()){case"fast":i.duration=200;break;case"normal":i.duration=c;break;case"slow":i.duration=600;break;default:i.duration=parseFloat(i.duration)||1}p.mock!==!1&&(p.mock===!0?i.duration=i.delay=1:(i.duration*=parseFloat(p.mock)||1,i.delay*=parseFloat(p.mock)||1)),i.easing=y(i.easing,i.duration),i.begin&&!a.isFunction(i.begin)&&(i.begin=null),i.progress&&!a.isFunction(i.progress)&&(i.progress=null),i.complete&&!a.isFunction(i.complete)&&(i.complete=null),i.display!==r&&i.display!==null&&(i.display=i.display.toString().toLowerCase(),i.display==="auto"&&(i.display=p.CSS.Values.getDisplayType(e))),i.visibility!==r&&i.visibility!==null&&(i.visibility=i.visibility.toString().toLowerCase()),i.mobileHA=i.mobileHA&&p.State.isMobile&&!p.State.isGingerbread,i.queue===!1?i.delay?setTimeout(u,i.delay):u():f.queue(e,i.queue,function(e,t){if(t===!0)return C.promise&&C.resolver(h),!0;p.velocityQueueEntryFlag=!0,u(e)}),(i.queue===""||i.queue==="fx")&&f.queue(e)[0]!=="inprogress"&&f.dequeue(e)}var i=arguments[0]&&(arguments[0].p||f.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||a.isString(arguments[0].properties)),s,o,l,h,v,m;a.isWrapped(this)?(s=!1,l=0,h=this,o=this):(s=!0,l=1,h=i?arguments[0].elements||arguments[0].e:arguments[0]),h=u(h);if(!h)return;i?(v=arguments[0].properties||arguments[0].p,m=arguments[0].options||arguments[0].o):(v=arguments[l],m=arguments[l+1]);var g=h.length,E=0;if(!/^(stop|finish|finishAll)$/i.test(v)&&!f.isPlainObject(m)){var T=l+1;m={};for(var N=T;N<arguments.length;N++)!a.isArray(arguments[N])&&(/^(fast|normal|slow)$/i.test(arguments[N])||/^\d/.test(arguments[N]))?m.duration=arguments[N]:a.isString(arguments[N])||a.isArray(arguments[N])?m.easing=arguments[N]:a.isFunction(arguments[N])&&(m.complete=arguments[N])}var C={promise:null,resolver:null,rejecter:null};s&&p.Promise&&(C.promise=new p.Promise(function(e,t){C.resolver=e,C.rejecter=t}));var k;switch(v){case"scroll":k="scroll";break;case"reverse":k="reverse";break;case"finish":case"finishAll":case"stop":f.each(h,function(e,t){d(t)&&d(t).delayTimer&&(clearTimeout(d(t).delayTimer.setTimeout),d(t).delayTimer.next&&d(t).delayTimer.next(),delete d(t).delayTimer),v==="finishAll"&&(m===!0||a.isString(m))&&(f.each(f.queue(t,a.isString(m)?m:""),function(e,t){a.isFunction(t)&&t()}),f.queue(t,a.isString(m)?m:"",[]))});var L=[];return f.each(p.State.calls,function(e,t){t&&f.each(t[1],function(n,i){var s=m===r?"":m;if(s!==!0&&t[2].queue!==s&&(m!==r||t[2].queue!==!1))return!0;f.each(h,function(n,r){if(r===i){if(m===!0||a.isString(m))f.each(f.queue(r,a.isString(m)?m:""),function(e,t){a.isFunction(t)&&t(null,!0)}),f.queue(r,a.isString(m)?m:"",[]);if(v==="stop")d(r)&&d(r).tweensContainer&&s!==!1&&f.each(d(r).tweensContainer,function(e,t){t.endValue=t.currentValue}),L.push(e);else if(v==="finish"||v==="finishAll")t[2].duration=1}})})}),v==="stop"&&(f.each(L,function(e,t){x(t,!0)}),C.promise&&C.resolver(h)),e();default:if(!f.isPlainObject(v)||!!a.isEmptyObject(v)){if(a.isString(v)&&p.Redirects[v]){var A=f.extend({},m),O=A.duration,M=A.delay||0;return A.backwards===!0&&(h=f.extend(!0,[],h).reverse()),f.each(h,function(e,t){parseFloat(A.stagger)?A.delay=M+parseFloat(A.stagger)*e:a.isFunction(A.stagger)&&(A.delay=M+A.stagger.call(t,e,g)),A.drag&&(A.duration=parseFloat(O)||(/^(callout|transition)/.test(v)?1e3:c),A.duration=Math.max(A.duration*(A.backwards?1-e/g:(e+1)/g),A.duration*.75,200)),p.Redirects[v].call(t,t,A||{},e,g,h,C.promise?C:r)}),e()}var _="Velocity: First argument ("+v+") was not a property map, a known action, or a registered redirect. Aborting.";return C.promise?C.rejecter(new Error(_)):console.log(_),e()}k="start"}var D={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},P=[];f.each(h,function(e,t){a.isNode(t)&&H.call(t)});var A=f.extend({},p.defaults,m),B;A.loop=parseInt(A.loop),B=A.loop*2-1;if(A.loop)for(var j=0;j<B;j++){var F={delay:A.delay,progress:A.progress};j===B-1&&(F.display=A.display,F.visibility=A.visibility,F.complete=A.complete),w(h,"reverse",F)}return e()};p=f.extend(w,p),p.animate=w;var E=t.requestAnimationFrame||s;return!p.State.isMobile&&n.hidden!==r&&n.addEventListener("visibilitychange",function(){n.hidden?(E=function(e){return setTimeout(function(){e(!0)},16)},S()):E=t.requestAnimationFrame||s}),e.Velocity=p,e!==t&&(e.fn.velocity=w,e.fn.velocity.defaults=p.defaults),f.each(["Down","Up"],function(e,t){p.Redirects["slide"+t]=function(e,n,i,s,o,u){var a=f.extend({},n),l=a.begin,c=a.complete,h={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},d={};a.display===r&&(a.display=t==="Down"?p.CSS.Values.getDisplayType(e)==="inline"?"inline-block":"block":"none"),a.begin=function(){l&&l.call(o,o);for(var n in h){d[n]=e.style[n];var r=p.CSS.getPropertyValue(e,n);h[n]=t==="Down"?[r,0]:[0,r]}d.overflow=e.style.overflow,e.style.overflow="hidden"},a.complete=function(){for(var t in d)e.style[t]=d[t];c&&c.call(o,o),u&&u.resolver(o)},p(e,h,a)}}),f.each(["In","Out"],function(e,t){p.Redirects["fade"+t]=function(e,n,i,s,o,u){var a=f.extend({},n),l={opacity:t==="In"?1:0},c=a.complete;i!==s-1?a.complete=a.begin=null:a.complete=function(){c&&c.call(o,o),u&&u.resolver(o)},a.display===r&&(a.display=t==="In"?"auto":"none"),p(this,l,a)}}),p}(window.jQuery||window.Zepto||window,window,document)}),function(e){typeof require=="function"&&typeof exports=="object"?module.exports=e():typeof define=="function"&&define.amd?define("velocity.ui",["velocity"],e):e()}(function(){return function(e,t,n,r){function a(e,t){var n=[];return!e||!t?!1:(s.each([e,t],function(e,t){var r=[];s.each(t,function(e,t){while(t.toString().length<5)t="0"+t;r.push(t)}),n.push(r.join(""))}),parseFloat(n[0])>parseFloat(n[1]))}if(!e.Velocity||!e.Velocity.Utilities){t.console&&console.log("Velocity UI Pack: Velocity must be loaded first. Aborting.");return}var i=e.Velocity,s=i.Utilities,o=i.version,u={major:1,minor:1,patch:0};if(a(u,o)){var f="Velocity UI Pack: You need to update Velocity (jquery.velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity.";throw alert(f),new Error(f)}i.RegisterEffect=i.RegisterUI=function(e,t){function n(e,t,n,r){var o=0,u;s.each(e.nodeType?[e]:e,function(e,t){r&&(n+=e*r),u=t.parentNode,s.each(["height","paddingTop","paddingBottom","marginTop","marginBottom"],function(e,n){o+=parseFloat(i.CSS.getPropertyValue(t,n))})}),i.animate(u,{height:(t==="In"?"+":"-")+"="+o},{queue:!1,easing:"ease-in-out",duration:n*(t==="In"?.6:1)})}return i.Redirects[e]=function(o,u,a,f,l,c){var h=a===f-1;typeof t.defaultDuration=="function"?t.defaultDuration=t.defaultDuration.call(l,l):t.defaultDuration=parseFloat(t.defaultDuration);for(var p=0;p<t.calls.length;p++){var d=t.calls[p],v=d[0],m=u.duration||t.defaultDuration||1e3,g=d[1],y=d[2]||{},b={};b.duration=m*(g||1),b.queue=u.queue||"",b.easing=y.easing||"ease",b.delay=parseFloat(y.delay)||0,b._cacheValues=y._cacheValues||!0;if(p===0){b.delay+=parseFloat(u.delay)||0,a===0&&(b.begin=function(){u.begin&&u.begin.call(l,l);var t=e.match(/(In|Out)$/);t&&t[0]==="In"&&v.opacity!==r&&s.each(l.nodeType?[l]:l,function(e,t){i.CSS.setPropertyValue(t,"opacity",0)}),u.animateParentHeight&&t&&n(l,t[0],m+b.delay,u.stagger)});if(u.display!==null)if(u.display!==r&&u.display!=="none")b.display=u.display;else if(/In$/.test(e)){var w=i.CSS.Values.getDisplayType(o);b.display=w==="inline"?"inline-block":w}u.visibility&&u.visibility!=="hidden"&&(b.visibility=u.visibility)}if(p===t.calls.length-1){function E(){(u.display===r||u.display==="none")&&/Out$/.test(e)&&s.each(l.nodeType?[l]:l,function(e,t){i.CSS.setPropertyValue(t,"display","none")}),u.complete&&u.complete.call(l,l),c&&c.resolver(l||o)}b.complete=function(){if(t.reset){for(var e in t.reset){var n=t.reset[e];i.CSS.Hooks.registered[e]===r&&(typeof n=="string"||typeof n=="number")&&(t.reset[e]=[t.reset[e],t.reset[e]])}var s={duration:0,queue:!1};h&&(s.complete=E),i.animate(o,t.reset,s)}else h&&E()},u.visibility==="hidden"&&(b.visibility=u.visibility)}i.animate(o,v,b)}},i},i.RegisterEffect.packagedEffects={"callout.bounce":{defaultDuration:550,calls:[[{translateY:-30},.25],[{translateY:0},.125],[{translateY:-15},.125],[{translateY:0},.25]]},"callout.shake":{defaultDuration:800,calls:[[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:0},.125]]},"callout.flash":{defaultDuration:1100,calls:[[{opacity:[0,"easeInOutQuad",1]},.25],[{opacity:[1,"easeInOutQuad"]},.25],[{opacity:[0,"easeInOutQuad"]},.25],[{opacity:[1,"easeInOutQuad"]},.25]]},"callout.pulse":{defaultDuration:825,calls:[[{scaleX:1.1,scaleY:1.1},.5,{easing:"easeInExpo"}],[{scaleX:1,scaleY:1},.5]]},"callout.swing":{defaultDuration:950,calls:[[{rotateZ:15},.2],[{rotateZ:-10},.2],[{rotateZ:5},.2],[{rotateZ:-5},.2],[{rotateZ:0},.2]]},"callout.tada":{defaultDuration:1e3,calls:[[{scaleX:.9,scaleY:.9,rotateZ:-3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:-3},.1],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],[{scaleX:1,scaleY:1,rotateZ:0},.2]]},"transition.fadeIn":{defaultDuration:500,calls:[[{opacity:[1,0]}]]},"transition.fadeOut":{defaultDuration:500,calls:[[{opacity:[0,1]}]]},"transition.flipXIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateY:[0,-55]}]],reset:{transformPerspective:0}},"transition.flipXOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateY:55}]],reset:{transformPerspective:0,rotateY:0}},"transition.flipYIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateX:[0,-45]}]],reset:{transformPerspective:0}},"transition.flipYOut":{defaultDuration:800,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateX:25}]],reset:{transformPerspective:0,rotateX:0}},"transition.flipBounceXIn":{defaultDuration:900,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateY:[-10,90]},.5],[{opacity:.8,rotateY:10},.25],[{opacity:1,rotateY:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceXOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateY:-10},.5],[{opacity:0,rotateY:90},.5]],reset:{transformPerspective:0,rotateY:0}},"transition.flipBounceYIn":{defaultDuration:850,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateX:[-10,90]},.5],[{opacity:.8,rotateX:10},.25],[{opacity:1,rotateX:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceYOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateX:-15},.5],[{opacity:0,rotateX:90},.5]],reset:{transformPerspective:0,rotateX:0}},"transition.swoopIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["100%","50%"],transformOriginY:["100%","100%"],scaleX:[1,0],scaleY:[1,0],translateX:[0,-700],translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%"}},"transition.swoopOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformOriginX:["50%","100%"],transformOriginY:["100%","100%"],scaleX:0,scaleY:0,translateX:-700,translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%",scaleX:1,scaleY:1,translateX:0}},"transition.whirlIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,0],scaleY:[1,0],rotateY:[0,160]},1,{easing:"easeInOutSine"}]]},"transition.whirlOut":{defaultDuration:750,calls:[[{opacity:[0,"easeInOutQuint",1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:0,scaleY:0,rotateY:160},1,{easing:"swing"}]],reset:{scaleX:1,scaleY:1,rotateY:0}},"transition.shrinkIn":{defaultDuration:750,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,1.5],scaleY:[1,1.5],translateZ:0}]]},"transition.shrinkOut":{defaultDuration:600,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:1.3,scaleY:1.3,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.expandIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,.625],scaleY:[1,.625],translateZ:0}]]},"transition.expandOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:.5,scaleY:.5,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.bounceIn":{defaultDuration:800,calls:[[{opacity:[1,0],scaleX:[1.05,.3],scaleY:[1.05,.3]},.4],[{scaleX:.9,scaleY:.9,translateZ:0},.2],[{scaleX:1,scaleY:1},.5]]},"transition.bounceOut":{defaultDuration:800,calls:[[{scaleX:.95,scaleY:.95},.35],[{scaleX:1.1,scaleY:1.1,translateZ:0},.35],[{opacity:[0,1],scaleX:.3,scaleY:.3},.3]],reset:{scaleX:1,scaleY:1}},"transition.bounceUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[-30,1e3]},.6,{easing:"easeOutCirc"}],[{translateY:10},.2],[{translateY:0},.2]]},"transition.bounceUpOut":{defaultDuration:1e3,calls:[[{translateY:20},.2],[{opacity:[0,"easeInCirc",1],translateY:-1e3},.8]],reset:{translateY:0}},"transition.bounceDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[30,-1e3]},.6,{easing:"easeOutCirc"}],[{translateY:-10},.2],[{translateY:0},.2]]},"transition.bounceDownOut":{defaultDuration:1e3,calls:[[{translateY:-20},.2],[{opacity:[0,"easeInCirc",1],translateY:1e3},.8]],reset:{translateY:0}},"transition.bounceLeftIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[30,-1250]},.6,{easing:"easeOutCirc"}],[{translateX:-10},.2],[{translateX:0},.2]]},"transition.bounceLeftOut":{defaultDuration:750,calls:[[{translateX:30},.2],[{opacity:[0,"easeInCirc",1],translateX:-1250},.8]],reset:{translateX:0}},"transition.bounceRightIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[-30,1250]},.6,{easing:"easeOutCirc"}],[{translateX:10},.2],[{translateX:0},.2]]},"transition.bounceRightOut":{defaultDuration:750,calls:[[{translateX:-30},.2],[{opacity:[0,"easeInCirc",1],translateX:1250},.8]],reset:{translateX:0}},"transition.slideUpIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,20],translateZ:0}]]},"transition.slideUpOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:-20,translateZ:0}]],reset:{translateY:0}},"transition.slideDownIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,-20],translateZ:0}]]},"transition.slideDownOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:20,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,-20],translateZ:0}]]},"transition.slideLeftOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:-20,translateZ:0}]],reset:{translateX:0}},"transition.slideRightIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,20],translateZ:0}]]},"transition.slideRightOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:20,translateZ:0}]],reset:{translateX:0}},"transition.slideUpBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,75],translateZ:0}]]},"transition.slideUpBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:-75,translateZ:0}]],reset:{translateY:0}},"transition.slideDownBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,-75],translateZ:0}]]},"transition.slideDownBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:75,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,-75],translateZ:0}]]},"transition.slideLeftBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:-75,translateZ:0}]],reset:{translateX:0}},"transition.slideRightBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,75],translateZ:0}]]},"transition.slideRightBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:75,translateZ:0}]],reset:{translateX:0}},"transition.perspectiveUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveUpOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveDownOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveLeftIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveLeftOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}},"transition.perspectiveRightIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveRightOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}}};for(var l in i.RegisterEffect.packagedEffects)i.RegisterEffect(l,i.RegisterEffect.packagedEffects[l]);i.RunSequence=function(e){var t=s.extend(!0,[],e);t.length>1&&(s.each(t.reverse(),function(e,n){var r=t[e+1];if(r){var o=n.o||n.options,u=r.o||r.options,a=o&&o.sequenceQueue===!1?"begin":"complete",f=u&&u[a],l={};l[a]=function(){var e=r.e||r.elements,t=e.nodeType?[e]:e;f&&f.call(t,t),i(n)},r.o?r.o=s.extend({},u,l):r.options=s.extend({},u,l)}}),t.reverse()),i(t[0])}}(window.jQuery||window.Zepto||window,window,document)}),define("AnalysisPageServer/Forms/show/compositeview/FormView",["marionette","bacon","bootstrap","velocity.ui"],function(e,t){return e.CompositeView.extend({getTemplate:function(){return this.getOption("type")==="primary"?"#ep-analysis-primary-form-tmpl":this.getOption("type")==="landing"?"#ep-analysis-landing-form-tmpl":"#ep-analysis-secondary-form-tmpl"},childViewContainer:"[data-parameters-region]",getChildView:function(e){return this.getReqRes().request("parameters:views:class",e)},childViewOptions:function(e,t){return _.extend(this.getReqRes().request("parameters:views:options",e,this),{})},ui:{submitBtn:"button[type=submit]",cancelBtn:"button.ep-form-cancel",advToggleBtn:"button.ep-form-advanced-toggle",formActions:".form-actions",progressBar:".form-actions > .progress"},triggers:{submit:"submit","click @ui.cancelBtn":"click:cancel-btn","click @ui.advToggleBtn":"click:advanced-toggle-btn"},initialize:function(e){},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getDestroyES:function(){return this.asEventStream("destroy").take(1)},onRender:function(){this.renderAdvancedToggle()},onDestroy:function(){this.ui.advToggleBtn.popover("destroy"),this.destroyMissingFieldsPopover()},onShowFully:function(){this.children.invoke("triggerMethod","show:fully")},getAdvancedToggleTitle:function(){var e=this.getReqRes().request("app:model:mode");return e==="simple"&&"Show Advanced Options"||"Hide Advanced Options"},getAdvancedToggleContent:function(){var e=this.getReqRes().request("app:model:mode"),t=new Backbone.Collection(this.model.parameters.getAdvanced()),n=t.pluck("label");return(e==="simple"&&"Click to show: "||"Click to hide: ")+n.join(", ")},renderAdvancedToggle:function(){var e=this.getReqRes().request("app:model:mode");this.ui.advToggleBtn.popover("destroy"),this.model.parameters.hasAdvanced()&&this.ui.advToggleBtn.removeClass("hide"),e==="advanced"&&this.ui.advToggleBtn.addClass("active"),this.ui.advToggleBtn.popover({placement:"top",trigger:"hover",title:this.getAdvancedToggleTitle(),content:this.getAdvancedToggleContent(),container:"body"})},updateMissingFieldsString:function(e){if(!this.isRendered)return;var t=new Backbone.Collection(e),n=t.pluck("label").join(", ");this.ui.formActions.attr("data-content",n)},renderMissingFieldsPopover:function(){var e=this;this.destroyMissingFieldsPopover(),this.model.parameters.getUnready().takeUntil(this.getDestroyES()).onValue(function(t){if(_.size(t)===0)return;e.updateMissingFieldsString(t),e.ui.formActions.popover({placement:"top",trigger:"hover",title:"Missing fields:",container:"body"})})},destroyMissingFieldsPopover:function(){this.ui.formActions.popover("destroy")},enableSubmitButton:function(){this.toggleSubmitButton("normal"),this.toggleSubmitButton("enabled")},toggleSubmitButton:function(e){var t;switch(e){case"enabled":this.ui.submitBtn.prop("disabled",!1);break;case"disabled":this.ui.submitBtn.prop("disabled",!0);break;case"callToAction":this.ui.submitBtn.velocity("callout.pulse");break;case"progress":this.ui.progressBar.width(this.ui.submitBtn.outerWidth()),this.ui.submitBtn.hide(),t=this.ui.progressBar.children();var n=this.model.localModel.get("analysisMeanLoadTime")||200;t.css("transitionDuration","0ms"),t.width(0),this.ui.progressBar.show(),t.css("transitionDuration",n+"ms"),t.width("100%");break;case"normal":this.ui.submitBtn.show(),this.ui.progressBar.hide(),t=this.ui.progressBar.children(),t.css("transitionDuration","0ms"),t.width(0)}}})}),define("AnalysisPageServer/Forms/show/FormsShowController",["marionette","./compositeview/FormView"],function(e,t){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:views:form:listen-to",this.listenToView,this),this.getReqRes().setHandler("parameters:views:form",this.createView,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},createView:function(e){return new t(e)},listenToView:function(e){var t=this;this.listenTo(e,"submit",this._onSubmit),this.listenTo(e,"click:cancel-btn",this._onClickCancelBtn),this.listenTo(e,"click:advanced-toggle-btn",this._onClickAdvancedToggleBtn),this.listenToOnce(e,"render",this._onRender),e.once("destroy",function(){t.stopListening(e)})},fetchAnalysis:function(e){var t=this.getReqRes().request("pages:analysis:fetch",e.model);t.then(_.bind(this._onModelAnalysisFetched,this,e)).catch(_.bind(this._onModelAnalysisFailed,this,e.view))},_onModelAnalysisFailed:function(e,t){e.enableSubmitButton(),e.ui.cancelBtn.prop("disabled",!0),this.getReqRes().request("app:view:show-modal",{type:"error",fullErrorText:t,model:e.model,permalink:"",title:"Error while fetching analysis for '"+e.model.get("label")+"'",doBtnLabel:"Send an email about this?",cancelBtnLabel:"Cancel"})},_onModelAnalysisFetched:function(e,t){this.getCommands().execute("app:view:show-main:analysis-page",e.model,t)},_onRender:function(e){e.renderMissingFieldsPopover(),e.model.parameters.isReady().takeUntil(e.getDestroyES()).onValue(this,"_onCollectionIsReady",e),e.listenTo(this.getVent(),"app:model:change-mode",_.bind(this._onAppModelChangeMode,this,e))},_onSubmit:function(e){e.view.toggleSubmitButton("progress"),e.view.ui.cancelBtn.prop("disabled",!1),this.fetchAnalysis(e)},_onClickCancelBtn:function(e){e.view.ui.cancelBtn.prop("disabled",!0),e.view.toggleSubmitButton("enabled"),e.view.toggleSubmitButton("normal"),e.model.abortFetchAnalysis()},_onClickAdvancedToggleBtn:function(){this.getReqRes().request("app:model:mode")==="simple"?this.getCommands().execute("app:model:set-mode","advanced"):this.getCommands().execute("app:model:set-mode","simple")},_onAppModelChangeMode:function(e,t,n){e.renderAdvancedToggle(),e.ui.advToggleBtn[n==="simple"?"removeClass":"addClass"]("active")},_onCollectionIsReady:function(e,t){t?(e.toggleSubmitButton("enabled"),e.toggleSubmitButton("callToAction"),e.destroyMissingFieldsPopover()):e.toggleSubmitButton("disabled")}})}),define("AnalysisPageServer/Forms/forms-app",["marionette","app","./show/FormsShowController"],function(e,t,n){var r=t.module("AnalysisPageServer.Forms"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n({})}),r}),define("AnalysisPageServer/Pages/fetch/PagesFetchController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("pages:fetch",this.fetchPages,this)},onDestroy:function(){this.getReqRes().removeHandler("pages:fetch")},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},fetchPages:function(){var e=this.getOption("pages");return new Promise(function(t){e._isFetched?t(e):e._isFetching?e._fetchPromise.then(function(){t(e)}):(e._isFetching=!0,e._fetchPromise=Promise.resolve(e.fetch({remove:!1,appModel:e.appModel})).then(function(){e._isFetching=!1,e._isFetched=!0,t(e)}))})}})}),define("analytics/GoogleAnalyticsManager",["config"],function(e){return e["analytics.provider"]==="google"?(function(e,t,n,r,i,s,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,s=t.createElement(n),o=t.getElementsByTagName(n)[0],s.async=1,s.src=r,o.parentNode.insertBefore(s,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),e["google.analytics.id"]&&window.ga("create",e["google.analytics.id"],"auto"),{trackEvent:function(e,t,n,r){window.ga("send","event",{eventCategory:e,eventAction:t,eventLabel:n,eventValue:r})},trackPageview:function(e,t){window.ga("send","pageview",{title:e,page:t})},setCustomVariable:function(e,t){window.ga("set",e,t)}}):{}}),define("analytics/AnalyticsFacade",["require","config","analytics/GoogleAnalyticsManager"],function(e){var t=e("config"),n=e("analytics/GoogleAnalyticsManager");return t["analytics.provider"]==="google"?n:{trackEvent:function(){},trackPageview:function(){},setCustomVariable:function(){}}}),define("AnalysisPageServer/Pages/fetch/AnalysisFetchController",["marionette","analytics/AnalyticsFacade"],function(e,t){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("pages:analysis:fetch",this.fetchAnalysis,this)},onDestroy:function(){this.getReqRes().removeHandler("pages:analysis:fetch")},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},fetchAnalysis:function(e,t){var n=this;return t=_.defaults({},t,{trackSuccess:!0,trackFailure:!0}),this.listenTo(e,"change:active",this._onModelChangeActive),this.listenTo(e,"abort:analysis-request",this._onModelAbortAnalysisRequest),e.once("destroy",function(){n.stopListening(e)}),new Promise(function(r,i){if(e._analysisFetchPromise)e._analysisFetchPromise.then(function(e){r(e)});else{var s=(new Date).getTime();n._getParametersJson(e).then(_.bind(n._fetchAnalysis,n,e)).then(function(i){delete e._analysisFetchPromise;var o=n._saveTimeToFetch(e,s);n._persistParametersJson(e),n.getCommands().execute("pages:parameters:persistent:update",e),n.getCommands().execute("pages:parameters:conditional-persistent:update",e),t.trackSuccess&&n._trackSuccess(e,o),r(i)}).catch(function(r){delete e._analysisFetchPromise,r.statusText!=="abort"&&(t.trackFailure&&n._trackFailure(e,r),i(r.responseText))})}})},_getParametersJson:function(e,t){return this.getReqRes().request("parameters:fetch",e).then(function(e){return e.conditionalToJSON(t).toPromise()})},_abortAnalysisRequest:function(e){e._analysisFetchPromise&&e._analysisFetchPromise.abort()},_fetchAnalysis:function(e,t){var n=e.parameters;return e._analysisFetchPromise=n.sync("create",n,{url:e.rClient.url("analysis"),data:e.rClient.decoratePostParams(t,e.get("name"),n.getFiles()),processData:!1,contentType:!1}),e._analysisFetchPromise},_saveTimeToFetch:function(e,t){var n=(new Date).getTime(),r=n-t;return e.localModel.setAnalysisMeanLoadTime(r),r},_persistParametersJson:function(e){this._getParametersJson(e,"url").then(function(t){e.saveParameters(t)})},_trackSuccess:function(e,n){this._getParametersJson(e).then(function(r){var i=e.parameters.findWhere({name:"study"});t.trackEvent(e.get("label"),i?i.get("readable")+" - Success":"Success",JSON.stringify(r),n)})},_trackFailure:function(e,n){var r=e.parameters.findWhere({name:"study"});_.indexOf(["abort","aborted"],n.textStatus)===-1&&t.trackEvent(e.get("label"),r?r.get("readable")+" - Failed":"Failed",n.responseText)},_onModelChangeActive:function(e,t){t||this._abortAnalysisRequest(e)},_onModelAbortAnalysisRequest:function(e){this._abortAnalysisRequest(e)}})}),define("AnalysisPageServer/Pages/Primary/show/layoutview/PrimaryPageView",["marionette","bacon"],function(e,t){return e.LayoutView.extend({template:"#aps-primary-page-tmpl",ui:{caption:"[data-caption]",description:"[data-description]"},regions:{parameters:"[data-parameters-region]"},onRender:function(){this.$el.prop("id",this.model.get("name")+"-page-view")},onShowFully:function(){this.getChildView("parameters").triggerMethod("show:fully")}})}),define("AnalysisPageServer/Pages/Primary/show/PrimaryPageShowController",["marionette","./layoutview/PrimaryPageView","analytics/AnalyticsFacade"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("app:view:show-main:primary-page",this.onCommandShow,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},onCommandShow:function(e){Backbone.history.navigate("page/"+encodeURIComponent(e.get("name"))+"/primary"),this._show(e.get("name"))},show:function(e,t){var n=this.getReqRes().request("pages:fetch"),r=this;n.then(function(t){return r.getReqRes().request("parameters:fetch",t.get(e))}).then(_.bind(this._show,this,e))},_show:function(e){var r=this.getReqRes().request("pages:collection"),i=r.get(e);r.setActive(i),n.trackPageview(i.get("label"),window.location.hash);var s=new t({model:i}),o=this.getReqRes().request("app:view:show-main",s,i.get("label")),u=this.getReqRes().request("parameters:views:form",{model:i,collection:i.rootParameters,type:"primary"});this.getCommands().execute("parameters:views:form:listen-to",u),o.then(function(){s.getRegion("parameters").show(u)}).catch(function(e){console.log(e)})}})}),define("AnalysisPageServer/Pages/Primary/show/PrimaryPageShowRouter",["marionette","./PrimaryPageShowController"],function(e,t){return e.AppRouter.extend({controller:new t,appRoutes:{"page/:page/primary(/:params)":"show"}})}),define("AnalysisPageServer/Pages/Primary/primarypage-app",["marionette","app","./show/PrimaryPageShowRouter"],function(e,t,n){var r=t.module("AnalysisPageServer.Pages.Primary");return r.on("start",function(){this.showRouter=new n}),r}),define("AnalysisPageServer/Pages/Analysis/show/AnalysisPageShowController",["marionette","functions/fixedEncodeURIComponent","analytics/AnalyticsFacade"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("app:view:show-main:analysis-page",this.onCommandShow,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},onCommandShow:function(e,t){this._show(e.get("name"),t),e.parameters.conditionalToJSON("url").take(1).onValue(this,"_navigateToAnalysisPage",e)},show:function(e,t){var r=this.getReqRes().request("pages:fetch"),i=this.getReqRes().request("pages:collection"),s=this;r.then(function(t){return s.getReqRes().request("parameters:fetch",t.get(e))}).then(function(n){return s._readParamJsonString(n,t),s._showParamSummaryModal(i.get(e),n),s.getReqRes().request("pages:analysis:fetch",i.get(e))}).then(_.bind(this._show,this,e)).then(function(){n.trackPageview(i.get(e).get("label"),window.location.hash)}).catch(function(n){s.getReqRes().request("app:view:show-modal",{type:"error",title:"Oops, an error occured",doBtnLabel:"Send an email about this?",cancelBtnLabel:"Cancel",fullErrorText:n,model:i.get(e),permalink:window.location.origin+window.location.pathname+"#page/"+encodeURIComponent(e)+"/analysis/"+encodeURIComponent(t)})})},_showParamSummaryModal:function(e,t){var n=this,r=this.getReqRes().request("parameters:views:summary",t,!1);r.$el.addClass("light-blue");var i=this.getReqRes().request("app:view:show-modal",{type:"normal",innerView:r,title:"Initializing "+e.get("label")+" Page...",cancelBtnLabel:"Go to Landing Page instead",altBtnLabel:"Modify Parameters",progressBar:e.localModel.get("analysisMeanLoadTime")});i.once("do:cancel:action",function(){e.trigger("abort:analysis-request",e),n.getCommands().execute("app:view:show-main:landing-page",e.collection.get("landing"))}),i.once("do:alt:action",function(){e.trigger("abort:analysis-request",e),n.getCommands().execute("app:view:show-main:primary-page",e)})},_readParamJsonString:function(e,t){if(t){var n=0;this.listenTo(e,"parameter:value:from:json",function(e){(e.get("advanced")||e.anyParentIsAdvanced())&&n++}),e.fromJSON(JSON.parse(t)),this.stopListening(e,"parameter:value:from:json"),this.getCommands().execute("app:model:set-mode",n>0?"advanced":"simple")}},_show:function(e,t){var n=this.getReqRes().request("pages:collection"),r=n.get(e);n.setActive(r);var i=this.getReqRes().request("analysis-data:views:"+t.type,t,{isRoot:!0,pageModel:r});this.getCommands().execute("app:view:hide-modal");var s=this.getReqRes().request("app:view:show-main",i,r.get("label"));s.then(function(){})},_navigateToAnalysisPage:function(e,r){Backbone.history.navigate("page/"+t(e.get("name"))+"/analysis/"+t(JSON.stringify(r))),n.trackPageview(e.get("label"),window.location.hash)}})}),define("AnalysisPageServer/Pages/Analysis/show/AnalysisPageShowRouter",["marionette","./AnalysisPageShowController"],function(e,t){return e.AppRouter.extend({controller:new t,appRoutes:{"page/:page/analysis(/:params)":"show"}})}),define("AnalysisPageServer/Pages/Analysis/analysispage-app",["marionette","app","./show/AnalysisPageShowRouter"],function(e,t,n){var r=t.module("AnalysisPageServer.Pages.Analysis");return r.on("start",function(){this.showRouter=new n}),r}),define("AnalysisPageServer/Pages/pages-app",["marionette","app","./fetch/PagesFetchController","./fetch/AnalysisFetchController","./Primary/primarypage-app","./Analysis/analysispage-app"],function(e,t,n,r){var i=t.module("AnalysisPageServer.Pages"),s=Backbone.Wreqr.radio.channel("global");return s.reqres.setHandler("pages:collection",function(){return this.pages},i),s.commands.setHandler("pages:collection:set",function(e){this.pages=e},i),i.on("start",function(){this.fetchC=new n({pages:this.pages}),this.fetchAnalysisC=new r}),i}),define("AnalysisPageServer/Parameters/fetch/ParametersFetchController",["marionette","../models/ParameterChildrenCollection"],function(e,t){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:fetch",this.fetch,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},fetch:function(e){var n=e.parameters;return new Promise(function(r){n._isFetched?r(n):n._isFetching?n._fetchPromise.then(function(){r(n)}):(n._isFetching=!0,n._fetchPromise=Promise.resolve(n.fetch({url:e.rClient.url(n.url,e.get("name")),remove:!1})).then(function(){e.initializeParameters(),e.rootParameters=new t(n.getRoots()),n._isFetching=!1,n._isFetched=!0,r(n)}))})}})}),define("AnalysisPageServer/Parameters/show/ArrayShowController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:views:array:listen-to",this.listenToView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},listenToView:function(e){var t=this;this.listenTo(e,"click:add-btn",this._onClickAddBtn),this.listenTo(e,"click:remove-btn",this._onClickRemoveBtn),e.once("destroy",function(){t.stopListening(e)})},_onClickAddBtn:function(e){e.model.addChild()},_onClickRemoveBtn:function(e){e.model.destroyLastChild()}})}),define("AnalysisPageServer/Parameters/show/behaviors/ParameterBehavior",["marionette"],function(e){return e.Behavior.extend({getDestroyES:function(){return this.view.asEventStream("before:destroy").take(1)},onRender:function(){this.startsNewLine()&&this.$el.addClass("ep-starts-line"),this.view.model.isActive().takeUntil(this.getDestroyES()).onValue(this,"toggle")},startsNewLine:function(){if(this.view.model.isComplex())return!0;if(this.view.getOption("type")==="primary"){var e=this.view.parent,t=e&&e.children,n=t&&_.indexOf(t,this),r=n>0&&t&&t.at(n-1);return r&&r.model.isComplex()}return!1},toggle:function(e){this.$el[e?"removeClass":"addClass"]("hide")},isHidden:function(){return this.$el.hasClass("hide")}})}),define("AnalysisPageServer/Parameters/show/itemview/TextParameterView",["marionette","../behaviors/ParameterBehavior"],function(e,t){return e.ItemView.extend({template:"#ep-form-text-tmpl",className:"control-group",ui:{field:"input"},events:{"keyup input":"onKeyup"},modelEvents:{"change:value":"onModelChangeValue"},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)},behaviors:{Base:{behaviorClass:t}},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},focus:function(){this.ui.field.focus()},onModelChangeValue:function(e,t,n){n.viewTriggered||this.ui.field.val(t)},onKeyup:function(e){var t=this.ui.field.val();t==null?this.model.unsetValue():this.model.setValue(t,{viewTriggered:!0})}})}),define("AnalysisPageServer/Parameters/show/itemview/BoolParameterView",["marionette","../behaviors/ParameterBehavior"],function(e,t){return e.ItemView.extend({template:"#ep-form-bool-tmpl",className:"control-group",ui:{button:"button"},events:{"click @ui.button":"_onClick"},modelEvents:{"change:value":"_onModelChangeValue"},behaviors:{Base:{behaviorClass:t}},templateHelpers:function(){var e=this.getReqRes().request("parameters:views:template-helpers",this);return _.extend(e,{active:this.model.getValue()===!0,buttonLabel:this.model.getValue()?"ON":"OFF",buttonClass:""})},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},focus:function(){this.ui.button.focus()},_onClick:function(e){this.model.setValue(!this.model.getValue())},_onModelChangeValue:function(e,t){this.ui.button.text(t?"ON":"OFF"),this.ui.button[t?"addClass":"removeClass"]("active")}})}),define("AnalysisPageServer/Parameters/show/compositeview/ArrayParameterView",["marionette","../behaviors/ParameterBehavior"],function(e,t){return e.CompositeView.extend({template:"#ep-form-array-tmpl",className:"control-group control-array-group light-blue",childViewContainer:"[data-children-region]",getChildView:function(e){return this.getReqRes().request("parameters:views:class",e)},childViewOptions:function(e,t){return _.extend(this.getReqRes().request("parameters:views:options",e,this),{arrayChild:{labelIsNumber:!0,idx:t}})},ui:{addBtn:".ep-array-add-child",removeBtn:".ep-array-remove-child"},triggers:{"click @ui.addBtn":"click:add-btn","click @ui.removeBtn":"click:remove-btn"},collectionEvents:{add:"onAddChild",remove:"onRemoveChild"},behaviors:{Base:{behaviorClass:t}},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},initialize:function(){this.getCommands().execute("parameters:views:array:listen-to",this)},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)},onRender:function(){this.updateButtons()},onShowFully:function(){this.children.invoke("triggerMethod","show:fully")},updateButtons:function(){this.model.get("min")==this.model.get("max")?(this.ui.addBtn.hide(),this.ui.removeBtn.hide()):(this.ui.addBtn.prop("disabled",this.model.isMax()),this.ui.removeBtn.prop("disabled",this.model.isMin()))},onAddChild:function(e){this.updateButtons()},onRemoveChild:function(e){this.updateButtons()}})}),define("AnalysisPageServer/Parameters/show/compositeview/CompoundParameterView",["marionette","../behaviors/ParameterBehavior"],function(e,t){return e.CompositeView.extend({template:"#ep-form-compound-tmpl",className:"control-group control-compound-group light-blue",childViewContainer:"[data-children-region]",getChildView:function(e){return this.getReqRes().request("parameters:views:class",e)},childViewOptions:function(e,t){return _.extend(this.getReqRes().request("parameters:views:options",e,this),{compoundChild:{idx:t}})},behaviors:{Base:{behaviorClass:t}},onShowFully:function(){this.children.invoke("triggerMethod","show:fully")},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)}})}),define("AnalysisPageServer/Parameters/show/itemview/SliderParameterView",["bacon","marionette","../behaviors/ParameterBehavior"],function(e,t,n){return t.ItemView.extend({template:"#ep-form-slider-tmpl",className:"control-group",ui:{field:"input[type=range]",label:"label span"},events:{change:"_onChange",input:"_onInput"},modelEvents:{"change:value":"_onModelChangeValue"},templateHelpers:function(){var e=this.getReqRes().request("parameters:views:template-helpers",this);return _.extend(e,{min:this.model.get("min"),max:this.model.get("max"),step:this.model.get("step")})},behaviors:{Base:{behaviorClass:n}},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},focus:function(){this.ui.field.focus()},_onModelChangeValue:function(e,t){this.ui.field.val(t)},_onInput:function(){var e=this.ui.field.val();this.ui.label.text(e)},_onChange:function(){var e=this.ui.field.val();e==null?this.model.unsetValue():this.model.setValue(parseFloat(e),{viewTriggered:!0})}})}),define("AnalysisPageServer/Parameters/show/itemview/FileParameterView",["marionette","../behaviors/ParameterBehavior"],function(e,t){return e.ItemView.extend({template:"#ep-form-file-tmpl",className:"control-group",ui:{field:"input[type=file]"},events:{"change @ui.field":"_onChange"},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)},Base:{behaviorClass:t},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getDestroyES:function(){return this.asEventStream("destroy").take(1)},focus:function(){this.ui.field.focus()},_onChange:function(e){var t=e.target.files[0];this.model.setValue(t)}})}),define("AnalysisPageServer/Parameters/show/ParametersShowController",["marionette","./itemview/TextParameterView","./itemview/BoolParameterView","./compositeview/ArrayParameterView","./compositeview/CompoundParameterView","./itemview/SliderParameterView","./itemview/FileParameterView"],function(e,t,n,r,i,s,o){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:views:class",this.getClassForModel,this),this.getReqRes().setHandler("parameters:views:options",this.getViewOptions,this),this.getReqRes().setHandler("parameters:views:template-helpers",this.getTemplateHelpers,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getClassForModel:function(e){switch(e.get("type")){case"text":return t;case"bool":return n;case"slider":return s;case"array":return r;case"compound":return i;case"file":return o;case"combobox":return this.getReqRes().request("parameters:views:combobox:class",e);case"select":return this.getReqRes().request("parameters:views:select:class",e)}},getViewOptions:function(e,t){return{model:e,collection:e.isComplex()?e.children:null,type:t.getOption("type"),parent:t}},getTemplateHelpers:function(e){return{baseId:e.cid,size:this.getSizeClass(e),primary:e.getOption("type")==="primary",label:this.getLabel(e),desc:this.getDescription(e),value:_.isUndefined(e.model.getValue())?"":e.model.getValue(),prompt:this.getPrompt(e)}},getLabel:function(e){var t=e.getOption("arrayChild");return t&&t.labelIsNumber?t.idx+1+".":e.model.get("label")+":"},getDescription:function(e){var t=e.getOption("arrayChild");return!t||t&&t.idx===0?e.model.get("description")||"&nbsp;":"&nbsp;"},getSizeClass:function(e,t){var n=t||e.model.get("size");return n==="x-small"?"input-mini":"input-"+n.replace("-","")},getPrompt:function(e){return e.model.get("prompt")||""}})}),define("AnalysisPageServer/Parameters/Summary/show/compositeview/ParameterView",["marionette","bacon"],function(e,t){return e.CompositeView.extend({template:"#ep-parameters-summary-item-tmpl",tagName:"li",childViewContainer:"ul",childViewOptions:function(e){return{isRoot:!1,collection:e.children}},templateHelpers:function(){return{isRoot:this.getOption("isRoot"),readableLabel:this.getReadableLabel(),readableValue:this.getReadableValue()}},initialize:function(){this.model.isActive().takeUntil(this.getDestroyES()).onValue(this,"_onChangeActive")},getReadableValue:function(){var e=this.model.get("readable")||this.model.get("value");return _.isBoolean(e)?e?"true":"false":_.isArray(e)?(e||[]).join("<br/>"):e},getReadableLabel:function(){return this.model.parent&&this.model.parent.get("type")==="array"?this.model.parent.children.indexOf(this.model)+1:this.model.get("label")},getDestroyES:function(){return this.asEventStream("destroy").take(1)},_onChangeActive:function(e){this.$el[e?"removeClass":"addClass"]("hide")}})}),define("AnalysisPageServer/Parameters/Summary/show/compositeview/ParametersSummaryView",["marionette","bacon","./ParameterView"],function(e,t,n){return e.CompositeView.extend({template:"#ep-parameters-summary-tmpl",className:"clearfix ep-sidebar-parameter-summary",ui:{modifyBtn:"[data-modify]"},triggers:{"click @ui.modifyBtn":"toggle"},childView:n,childViewContainer:"ul",childViewOptions:function(e){return{isRoot:!0,collection:e.children}},templateHelpers:function(){return{withModify:this.getOption("withModify")}}})}),define("AnalysisPageServer/Parameters/Summary/show/SummaryShowController",["marionette","./compositeview/ParametersSummaryView"],function(e,t){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:views:summary",this.getView,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e,n){var r=new t({withModify:n,collection:e});return r}})}),define("AnalysisPageServer/Parameters/SetValueController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:listen-to-set-value",this.listenToSetValue,this),this.getReqRes().setHandler("parameters:has-outdated-value",this.hasOutdatedValue,this),this.getVent().on("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},onDestroy:function(){this.getCommands().removeHandler("parameters:listen-to-set-value"),this.getReqRes().removeHandler("parameters:has-outdated-value"),this.getVent().off("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},onDependencyChangedValue:function(e,t){e.reset()},listenToSetValue:function(e){var t=this;this.listenTo(e,"change:value",this._onSetValue),e.once("destroy",function(){t.stopListening(e)})},_onSetValue:function(e,t,n){var r=this.getReqRes().request("parameters:get-dependent-on",e);this._markDeeplyDependentWithOutdatedValue(r),e.set("_outdatedValue",!1),this._triggerActionsOnDirectlyDependent(r,e)},_filterDirectlyDependentWithOutdatedValue:function(e){return this._filterDependentWithOutdatedValue(e)},_filterDirectlyDependent:function(e,t){return _.reduce(e,function(e,n){return n===t?e:(_.indexOf(n.getDependencies(),t)>-1&&e.push(n),e)},[],this)},_markDeeplyDependentWithOutdatedValue:function(e){_.each(this._filterDependentWithOutdatedValue(e),function(e){e.set("_outdatedValue",!0)})},_filterDependentWithOutdatedValue:function(e){return _.filter(e,function(e){return this._testForOutdatedValue(e)},this)},hasOutdatedValue:function(e){return e.get("_outdatedValue")},_testForOutdatedValue:function(e){return _.size(e.getPersistentDependencies())||e.get("type")==="combobox"},_triggerActionsOnDirectlyDependent:function(e,t){var n=this._filterDirectlyDependent(e,t);_.each(n,function(e){this.getVent().trigger("parameters:dependency-changed-value",e)},this)}})}),define("AnalysisPageServer/Parameters/DisplayCallbackController",["marionette","bacon","functions/fixedEncodeURIComponent"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:display.callback:initialize",this.initializeDisplayCallbackProperty,this),this.getCommands().setHandler("parameters:display.callback:run",this.run,this),this.getVent().on("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},onDestroy:function(){this.getCommands().removeHandler("parameters:display.callback:initialize"),this.getCommands().removeHandler("parameters:display.callback:run"),this.getVent().off("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},hasDisplayCallback:function(e){return e.get("display.callback")},anyDependencyHasOutdatedValue:function(e){return _.some(e.getDisplayCallbackDependencies(),function(e){return this.getReqRes().request("parameters:has-outdated-value",e)},this)},onDependencyChangedValue:function(e){this.run(e)},run:function(e){if(!this.hasDisplayCallback(e))return;if(this.anyDependencyHasOutdatedValue(e))return;e._displayCallbackBus.push(this._buildDisplayCallbackUrl(e))},initializeDisplayCallbackProperty:function(e){var n=e.get("display.callback");this.hasDisplayCallback(e)?(e._displayCallbackBus=new t.Bus,e.displayCallbackProperty=e._displayCallbackBus.takeUntil(e.getDestroyES()).slidingWindow(2,1).filter(this,"_filterDisplayCallbackUrl").debounce(n.delay||0).flatMapLatest(this,"_mapDisplayCallbackUrlToRequest").mapError(this,"_mapRequestError").toProperty()):e.displayCallbackProperty=t.constant(!0)},_mapRequestError:function(e){return!1},_buildDisplayCallbackUrl:function(e){var t=e.get("display.callback"),r=_.invert(t.dependent),i=t.uri;return _.reduce(e.getDisplayCallbackDependencies(),function(e,t){return e.replace(":"+r[t.get("name")],n(t.getValue()))},i,this)},_filterDisplayCallbackUrl:function(e){return _.size(e)===1?!0:e[0]!==e[1]},_mapDisplayCallbackUrlToRequest:function(e){return t.fromPromise(Backbone.ajax({url:e[1]||e[0],dataType:"json"}),!0)}})}),define("AnalysisPageServer/Parameters/GetClosestController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:get-closest",this.getClosest,this)},onDestroy:function(){this.getReqRes().removeHandler("parameters:get-closest")},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getClosest:function(e,t){var n=e.collection,r=n.where(t);if(_.size(r)===1)return _.first(r);var i=n.indexOf(e),s=_.max(_.map(r,function(t){return _.size(n.getCommonParents(e,t))},this)),o=_.filter(r,function(t){return _.size(n.getCommonParents(e,t))===s},this);return _.first(_.sortBy(o,function(e){return Math.abs(i-n.indexOf(e))},this))}})}),define("AnalysisPageServer/Parameters/GetDependentController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:get-dependent-on",this.getDependentOn,this)},onDestroy:function(){this.getReqRes().removeHandler("parameters:get-dependent-on")},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getDependentOn:function(e){var t=this._getDependentOn(e,[],[]);return t},_getDependentOn:function(e,t,n){return _.indexOf(t,e)>-1?n:(n=e.collection.reduce(function(t,n){return _.each(n.getDependencies(),function(r){r===e&&_.indexOf(t,n)===-1&&t.push(n)},this),t},n,this),t.push(e),_.each(n,function(e){n=this._getDependentOn(e,t,n)},this),n)}})}),define("AnalysisPageServer/Parameters/ShowIfController",["marionette","bacon"],function(e,t){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:show.if:initialize",this.initializeShowIfProperty,this),this.getCommands().setHandler("parameters:show.if:run",this.run,this),this.getVent().on("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},onDestroy:function(){this.getCommands().removeHandler("parameters:show.if:initialize"),this.getCommands().removeHandler("parameters:show.if:run"),this.getVent().off("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},hasShowIf:function(e){return e.get("show.if")},anyDependencyHasOutdatedValue:function(e){return this.getReqRes().request("parameters:has-outdated-value",e.getShowIfDependency())},onDependencyChangedValue:function(e){this.run(e)},run:function(e){if(!this.hasShowIf(e))return;if(this.anyDependencyHasOutdatedValue(e))return;e._showIfBus.push(this.isShownIf(e))},isShownIf:function(e){var t=e.get("show.if");if(!t)return!0;var n=_.isArray(t.values)?t.values:[t.values];return _.indexOf(n,e.getShowIfDependency().getValue())>-1},initializeShowIfProperty:function(e){this.hasShowIf(e)?(e._showIfBus=new t.Bus,e.showIfProperty=e._showIfBus.takeUntil(e.getDestroyES()).toProperty()):e.showIfProperty=t.constant(!0)}})}),define("AnalysisPageServer/Parameters/ShowIfAdvancedController",["marionette","bacon"],function(e,t){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("parameters:show.if.advanced:initialize",this.initializeAdvancedProperty,this),this.getCommands().setHandler("parameters:show.if.advanced:run",this.run,this)},onDestroy:function(){this.getCommands().removeHandler("parameters:show.if.advanced:initialize"),this.getCommands().removeHandler("parameters:show.if.advanced:run")},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},run:function(e){e._advancedBus.push(this.isShownIfAdvanced(e))},isShownIfAdvanced:function(e){var t=this.getReqRes().request("app:model:mode");return e.get("advanced")?t==="advanced":!0},initializeAdvancedProperty:function(e){var n=this;e._advancedBus=new t.Bus,e.advancedProperty=e._advancedBus.takeUntil(e.getDestroyES()).toProperty(this.isShownIfAdvanced(e)),e.listenTo(this.getVent(),"app:model:change-mode",function(){n.run(e)})}})}),define("AnalysisPageServer/Parameters/ConditionalPersistent/models/PersistentParameterCollection",["backbone","config","backbone.localstorage"],function(e,t){return e.Collection.extend({localStorage:new e.LocalStorage(t["parameter.collection.localStorage"])})}),define("AnalysisPageServer/Parameters/ConditionalPersistent/ConditionalPersistentController",["marionette","./models/PersistentParameterCollection"],function(e,t){return e.Controller.extend({initialize:function(){this.collection=new t,this.collection.fetch(),this.getCommands().setHandler("parameters:conditional-persistent:initialize",this.initializeParameter,this),this.getCommands().setHandler("pages:parameters:conditional-persistent:update",this.update,this),this.getVent().on("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},onDestroy:function(){this.collection.reset(),this.getCommands().removeHandler("parameters:conditional-persistent:initialize"),this.getCommands().removeHandler("pages:parameters:conditional-persistent:update"),this.getVent().off("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},initializeParameter:function(e){if(!this.canStoreConditionalValue(e))return;var t=this.getPersistentParameterFor(e);t||(t=this.collection.create({id:e.get("persistent")}))},update:function(e){this.storeConditionalValues(e),this.clearOldConditionalValues()},getPersistentParameterFor:function(e){return this.canStoreConditionalValue(e)?this.collection.get(e.get("persistent")):null},canStoreConditionalValue:function(e){return e.get("persistent")&&e.get("persistent_dependencies")},clearOldConditionalValues:function(){var e;this.collection.each(function(t){e=_.filter(t.get("conditionalValues"),function(e){return!this._conditionalValueIsOld(e)},this),t.set("conditionalValues",e),t.save()},this)},_conditionalValueIsOld:function(e){return(new Date).getTime()-e.lastUsed>6048e5},storeConditionalValues:function(e){e.parameters.each(function(e){this.storeConditionalValue(e)},this)},storeConditionalValue:function(e){var t=this;return this.canStoreConditionalValue(e)?e.conditionalToJSON("url").toPromise().then(function(n){t._insertOrUpdateConditionalValue(e,n)}):Promise.resolve()},_insertOrUpdateConditionalValue:function(e,t){var n=this.getPersistentParameterFor(e),r=this._getDependentValues(e),i=this._findConditionalValueMatchingDependencies(e,function(e){e.value=t,e.lastUsed=(new Date).getTime()});i||this._insertConditionalValue(n,r,t),n.save()},_insertConditionalValue:function(e,t,n){var r={dependent:t,value:n,lastUsed:(new Date).getTime()},i=e.get("conditionalValues")||[];i.push(r),e.set("conditionalValues",i)},_findConditionalValueMatchingDependencies:function(e,t){var n=this.getPersistentParameterFor(e),r=this._getDependentValues(e);return _.find(n.get("conditionalValues"),function(e,i){if(_.size(r)!==_.size(e.dependent))return!1;var s=_.reduce(r,function(t,n,r){return t&&!!e.dependent[r]&&e.dependent[r]==n},!0);return s&&t&&t.call(this,n.get("conditionalValues")[i]),s},this)},_getDependentValues:function(e){var t=e.getPersistentDependencies();return _.reduce(t,function(e,t){return t&&(e[t.get("persistent")]=t.getValue()),e},{},this)},anyDependencyHasOutdatedValue:function(e){return _.some(e.getPersistentDependencies(),function(e){return this.getReqRes().request("parameters:has-outdated-value",e)},this)},onDependencyChangedValue:function(e,t){this.run(e,t)},run:function(e,t){if(!this.canStoreConditionalValue(e))return;if(this.anyDependencyHasOutdatedValue(e))return;var n=this._findConditionalValueMatchingDependencies(e);n?e.fromJSON(n.value,null,t):e.setValue(e.getValue())}})}),function(){var e=0,t=["webkit","moz","ms"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),define("polyfills/requestAnimationFrame",function(){}),define("AnalysisPageServer/Parameters/Persistent/PersistentController",["marionette","polyfills/requestAnimationFrame"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("pages:parameters:persistent:update",this.update,this)},onDestroy:function(){this.getCommands().removeHandler("pages:parameters:persistent:update")},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},update:function(e){function r(){if(n>=e.collection.size())return;var i=e.collection.at(n);n++;if(!i)return requestAnimationFrame(r);if(e===i)return requestAnimationFrame(r);if(!i.parameters)return requestAnimationFrame(r);var s=t.getReqRes().request("parameters:fetch",i);s.then(function(){t._updateParametersValues(e,i),requestAnimationFrame(r)})}if(e.get("hidden"))return;if(!e.parameters)return;if(e.parameters.size()===0)return;var t=this,n=0;requestAnimationFrame(r)},_updateParametersValues:function(e,t){var n=this,r=[],i=_.reduce(e.parameters.getPersistent(),function(e,n){var i=t.parameters.findWhere({persistent:n.get("persistent")});if(i){var s=n.conditionalToJSON("url").toPromise().then(function(e){return i.fromJSON(e)});r.push(s)}return e||i},!1);i&&!t.isDataset()&&Promise.all(r).then(function(){return n._persistParametersValues(t)})},_persistParametersValues:function(e){return e.parameters.conditionalToJSON("url").toPromise().then(function(t){return e.saveParameters(t)})}})}),define("AnalysisPageServer/Parameters/Select/show/itemview/SelectParameterView",["marionette","bacon"],function(e,t){return e.ItemView.extend({className:"control-group",modelEvents:{"change:value":"_onModelChangeValue"},initialize:function(){},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getDestroyES:function(){return this.asEventStream("destroy").take(1)},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)},_prepareChoices:function(){var e=this.model.get("choices"),t=[];for(var n in e)t.push({value:n,label:e[n],selected:this.model.get("value")==n});return t},_setModelValue:function(e){this.model.setValue(e,{viewTriggered:!0})},_onModelChangeValue:function(){}})}),function(e){"use strict";typeof define=="function"&&define.amd?define("Sortable",e):typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=e():typeof Package!="undefined"?Sortable=e():window.Sortable=e()}(function(){"use strict";function M(e,t){if(!e||!e.nodeType||e.nodeType!==1)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(e);this.el=e,this.options=t=J({},t),e[b]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(e.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var r in n)!(r in t)&&(t[r]=n[r]);O(t);for(var i in this)i.charAt(0)==="_"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:x,H(e,"mousedown",this._onTapStart),H(e,"touchstart",this._onTapStart),this.nativeDraggable&&(H(e,"dragover",this),H(e,"dragenter",this)),L.push(this._onDragOver),t.store&&this.sort(t.store.get(this))}function _(t){r&&r.state!==t&&(F(r,"display",t?"none":""),!t&&r.state&&i.insertBefore(r,e),r.state=t)}function D(e,t,n){if(e){n=n||E,t=t.split(".");var r=t.shift().toUpperCase(),i=new RegExp("\\s("+t.join("|")+")(?=\\s)","g");do if(r===">*"&&e.parentNode===n||(r===""||e.nodeName.toUpperCase()==r)&&(!t.length||((" "+e.className+" ").match(i)||[]).length==t.length))return e;while(e!==n&&(e=e.parentNode))}return null}function P(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.preventDefault()}function H(e,t,n){e.addEventListener(t,n,!1)}function B(e,t,n){e.removeEventListener(t,n,!1)}function j(e,t,n){if(e)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(y," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(y," ")}}function F(e,t,n){var r=e&&e.style;if(r){if(n===void 0)return E.defaultView&&E.defaultView.getComputedStyle?n=E.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];t in r||(t="-webkit-"+t),r[t]=n+(typeof n=="string"?"":"px")}}function I(e,t,n){if(e){var r=e.getElementsByTagName(t),i=0,s=r.length;if(n)for(;i<s;i++)n(r[i],i);return r}return[]}function q(e,t,n,i,s,o,u){var a=E.createEvent("Event"),f=(e||t[b]).options,l="on"+n.charAt(0).toUpperCase()+n.substr(1);a.initEvent(n,!0,!0),a.to=t,a.from=s||t,a.item=i||t,a.clone=r,a.oldIndex=o,a.newIndex=u,t.dispatchEvent(a),f[l]&&f[l].call(e,a)}function R(e,t,n,r,i,s){var o,u=e[b],a=u.options.onMove,f;return o=E.createEvent("Event"),o.initEvent("move",!0,!0),o.to=t,o.from=e,o.dragged=n,o.draggedRect=r,o.related=i||t,o.relatedRect=s||t.getBoundingClientRect(),e.dispatchEvent(o),a&&(f=a.call(u,o)),f}function U(e){e.draggable=!1}function z(){N=!1}function W(e,t){var n=e.lastElementChild,r=n.getBoundingClientRect();return(t.clientY-(r.top+r.height)>5||t.clientX-(r.right+r.width)>5)&&n}function X(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;while(n--)r+=t.charCodeAt(n);return r.toString(36)}function V(e){var t=0;if(!e||!e.parentNode)return-1;while(e&&(e=e.previousElementSibling))e.nodeName.toUpperCase()!=="TEMPLATE"&&t++;return t}function $(e,t){var n,r;return function(){n===void 0&&(n=arguments,r=this,setTimeout(function(){n.length===1?e.call(r,n[0]):e.apply(r,n),n=void 0},t))}}function J(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d={},v,m,g,y=/\s+/g,b="Sortable"+(new Date).getTime(),w=window,E=w.document,S=w.parseInt,x="draggable"in E.createElement("div"),T=function(e){return e=E.createElement("x"),e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}(),N=!1,C=Math.abs,k=[].slice,L=[],A=$(function(e,t,n){if(n&&t.scroll){var r,i,s=t.scrollSensitivity,a=t.scrollSpeed,f=e.clientX,l=e.clientY,c=window.innerWidth,h=window.innerHeight,p,v;if(u!==n){o=t.scroll,u=n;if(o===!0){o=n;do if(o.offsetWidth<o.scrollWidth||o.offsetHeight<o.scrollHeight)break;while(o=o.parentNode)}}o&&(r=o,i=o.getBoundingClientRect(),p=(C(i.right-f)<=s)-(C(i.left-f)<=s),v=(C(i.bottom-l)<=s)-(C(i.top-l)<=s)),!p&&!v&&(p=(c-f<=s)-(f<=s),v=(h-l<=s)-(l<=s),(p||v)&&(r=w));if(d.vx!==p||d.vy!==v||d.el!==r)d.el=r,d.vx=p,d.vy=v,clearInterval(d.pid),r&&(d.pid=setInterval(function(){r===w?w.scrollTo(w.pageXOffset+p*a,w.pageYOffset+v*a):(v&&(r.scrollTop+=v*a),p&&(r.scrollLeft+=p*a))},24))}},30),O=function(e){var t=e.group;if(!t||typeof t!="object")t=e.group={name:t};["pull","put"].forEach(function(e){e in t||(t[e]=!0)}),e.groups=" "+t.name+(t.put.join?" "+t.put.join(" "):"")+" "};return M.prototype={constructor:M,_onTapStart:function(e){var t=this,n=this.el,r=this.options,i=e.type,s=e.touches&&e.touches[0],o=(s||e).target,u=o,a=r.filter;if(i==="mousedown"&&e.button!==0||r.disabled)return;o=D(o,r.draggable,n);if(!o)return;c=V(o);if(typeof a=="function"){if(a.call(this,e,o,this)){q(t,u,"filter",o,n,c),e.preventDefault();return}}else if(a){a=a.split(",").some(function(e){e=D(u,e.trim(),n);if(e)return q(t,e,"filter",o,n,c),!0});if(a){e.preventDefault();return}}if(r.handle&&!D(u,r.handle,n))return;this._prepareDragStart(e,s,o)},_prepareDragStart:function(n,r,o){var u=this,a=u.el,f=u.options,l=a.ownerDocument,c;o&&!e&&o.parentNode===a&&(v=n,i=a,e=o,t=e.parentNode,s=e.nextSibling,p=f.group,c=function(){u._disableDelayedDrag(),e.draggable=!0,j(e,u.options.chosenClass,!0),u._triggerDragStart(r)},f.ignore.split(",").forEach(function(t){I(e,t.trim(),U)}),H(l,"mouseup",u._onDrop),H(l,"touchend",u._onDrop),H(l,"touchcancel",u._onDrop),f.delay?(H(l,"mouseup",u._disableDelayedDrag),H(l,"touchend",u._disableDelayedDrag),H(l,"touchcancel",u._disableDelayedDrag),H(l,"mousemove",u._disableDelayedDrag),H(l,"touchmove",u._disableDelayedDrag),u._dragStartTimer=setTimeout(c,f.delay)):c())},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),B(e,"mouseup",this._disableDelayedDrag),B(e,"touchend",this._disableDelayedDrag),B(e,"touchcancel",this._disableDelayedDrag),B(e,"mousemove",this._disableDelayedDrag),B(e,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(v={target:e,clientX:t.clientX,clientY:t.clientY},this._onDragStart(v,"touch")):this.nativeDraggable?(H(e,"dragend",this),H(i,"dragstart",this._onDragStart)):this._onDragStart(v,!0);try{E.selection?E.selection.empty():window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(){i&&e&&(j(e,this.options.ghostClass,!0),M.active=this,q(this,i,"start",e,i,c))},_emulateDragOver:function(){if(m){if(this._lastX===m.clientX&&this._lastY===m.clientY)return;this._lastX=m.clientX,this._lastY=m.clientY,T||F(n,"display","none");var e=E.elementFromPoint(m.clientX,m.clientY),t=e,r=" "+this.options.group.name+"",i=L.length;if(t)do{if(t[b]&&t[b].options.groups.indexOf(r)>-1){while(i--)L[i]({clientX:m.clientX,clientY:m.clientY,target:e,rootEl:t});break}e=t}while(t=t.parentNode);T||F(n,"display","")}},_onTouchMove:function(e){if(v){M.active||this._dragStarted(),this._appendGhost();var t=e.touches?e.touches[0]:e,r=t.clientX-v.clientX,i=t.clientY-v.clientY,s=e.touches?"translate3d("+r+"px,"+i+"px,0)":"translate("+r+"px,"+i+"px)";g=!0,m=t,F(n,"webkitTransform",s),F(n,"mozTransform",s),F(n,"msTransform",s),F(n,"transform",s),e.preventDefault()}},_appendGhost:function(){if(!n){var t=e.getBoundingClientRect(),r=F(e),s;n=e.cloneNode(!0),j(n,this.options.ghostClass,!1),j(n,this.options.fallbackClass,!0),F(n,"top",t.top-S(r.marginTop,10)),F(n,"left",t.left-S(r.marginLeft,10)),F(n,"width",t.width),F(n,"height",t.height),F(n,"opacity","0.8"),F(n,"position","fixed"),F(n,"zIndex","100000"),F(n,"pointerEvents","none"),this.options.fallbackOnBody&&E.body.appendChild(n)||i.appendChild(n),s=n.getBoundingClientRect(),F(n,"width",t.width*2-s.width),F(n,"height",t.height*2-s.height)}},_onDragStart:function(t,n){var s=t.dataTransfer,o=this.options;this._offUpEvents(),p.pull=="clone"&&(r=e.cloneNode(!0),F(r,"display","none"),i.insertBefore(r,e)),n?(n==="touch"?(H(E,"touchmove",this._onTouchMove),H(E,"touchend",this._onDrop),H(E,"touchcancel",this._onDrop)):(H(E,"mousemove",this._onTouchMove),H(E,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(s&&(s.effectAllowed="move",o.setData&&o.setData.call(this,s,e)),H(E,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(o){var u=this.el,c,h,d,v=this.options,m=v.group,y=m.put,w=p===m,E=v.sort;o.preventDefault!==void 0&&(o.preventDefault(),!v.dragoverBubble&&o.stopPropagation()),g=!0;if(p&&!v.disabled&&(w?E||(d=!i.contains(e)):p.pull&&y&&(p.name===m.name||y.indexOf&&~y.indexOf(p.name)))&&(o.rootEl===void 0||o.rootEl===this.el)){A(o,v,this.el);if(N)return;c=D(o.target,v.draggable,u),h=e.getBoundingClientRect();if(d){_(!0),r||s?i.insertBefore(e,r||s):E||i.appendChild(e);return}if(u.children.length===0||u.children[0]===n||u===o.target&&(c=W(u,o))){if(c){if(c.animated)return;S=c.getBoundingClientRect()}_(w),R(i,u,e,h,c,S)!==!1&&(e.contains(u)||(u.appendChild(e),t=u),this._animate(h,e),c&&this._animate(S,c))}else if(c&&!c.animated&&c!==e&&c.parentNode[b]!==void 0){a!==c&&(a=c,f=F(c),l=F(c.parentNode));var S=c.getBoundingClientRect(),x=S.right-S.left,T=S.bottom-S.top,C=/left|right|inline/.test(f.cssFloat+f.display)||l.display=="flex"&&l["flex-direction"].indexOf("row")===0,k=c.offsetWidth>e.offsetWidth,L=c.offsetHeight>e.offsetHeight,O=(C?(o.clientX-S.left)/x:(o.clientY-S.top)/T)>.5,M=c.nextElementSibling,P=R(i,u,e,h,c,S),H;if(P!==!1){N=!0,setTimeout(z,30),_(w);if(P===1||P===-1)H=P===1;else if(C){var B=e.offsetTop,j=c.offsetTop;B===j?H=c.previousElementSibling===e&&!k||O&&k:H=j>B}else H=M!==e&&!L||O&&L;e.contains(u)||(H&&!M?u.appendChild(e):c.parentNode.insertBefore(e,H?M:c)),t=e.parentNode,this._animate(h,e),this._animate(S,c)}}}},_animate:function(e,t){var n=this.options.animation;if(n){var r=t.getBoundingClientRect();F(t,"transition","none"),F(t,"transform","translate3d("+(e.left-r.left)+"px,"+(e.top-r.top)+"px,0)"),t.offsetWidth,F(t,"transition","all "+n+"ms"),F(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=setTimeout(function(){F(t,"transition",""),F(t,"transform",""),t.animated=!1},n)}},_offUpEvents:function(){var e=this.el.ownerDocument;B(E,"touchmove",this._onTouchMove),B(e,"mouseup",this._onDrop),B(e,"touchend",this._onDrop),B(e,"touchcancel",this._onDrop)},_onDrop:function(l){var y=this.el,b=this.options;clearInterval(this._loopId),clearInterval(d.pid),clearTimeout(this._dragStartTimer),B(E,"mousemove",this._onTouchMove),this.nativeDraggable&&(B(E,"drop",this),B(y,"dragstart",this._onDragStart)),this._offUpEvents();if(l){g&&(l.preventDefault(),!b.dropBubble&&l.stopPropagation()),n&&n.parentNode.removeChild(n);if(e){this.nativeDraggable&&B(e,"dragend",this),U(e),j(e,this.options.ghostClass,!1),j(e,this.options.chosenClass,!1),i!==t?(h=V(e),h>=0&&(q(null,t,"sort",e,i,c,h),q(this,i,"sort",e,i,c,h),q(null,t,"add",e,i,c,h),q(this,i,"remove",e,i,c,h))):(r&&r.parentNode.removeChild(r),e.nextSibling!==s&&(h=V(e),h>=0&&(q(this,i,"update",e,i,c,h),q(this,i,"sort",e,i,c,h))));if(M.active){if(h===null||h===-1)h=c;q(this,i,"end",e,i,c,h),this.save()}}i=e=t=n=s=r=o=u=v=m=g=h=a=f=p=M.active=null}},handleEvent:function(t){var n=t.type;n==="dragover"||n==="dragenter"?e&&(this._onDragOver(t),P(t)):(n==="drop"||n==="dragend")&&this._onDrop(t)},toArray:function(){var e=[],t,n=this.el.children,r=0,i=n.length,s=this.options;for(;r<i;r++)t=n[r],D(t,s.draggable,this.el)&&e.push(t.getAttribute(s.dataIdAttr)||X(t));return e},sort:function(e){var t={},n=this.el;this.toArray().forEach(function(e,r){var i=n.children[r];D(i,this.options.draggable,n)&&(t[e]=i)},this),e.forEach(function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))})},save:function(){var e=this.options.store;e&&e.set(this)},closest:function(e,t){return D(e,t||this.options.draggable,this.el)},option:function(e,t){var n=this.options;if(t===void 0)return n[e];n[e]=t,e==="group"&&O(n)},destroy:function(){var e=this.el;e[b]=null,B(e,"mousedown",this._onTapStart),B(e,"touchstart",this._onTapStart),this.nativeDraggable&&(B(e,"dragover",this),B(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),L.splice(L.indexOf(this._onDragOver),1),this._onDrop(),this.el=e=null}},M.utils={on:H,off:B,css:F,find:I,is:function(e,t){return!!D(e,t,e)},extend:J,throttle:$,closest:D,toggleClass:j,index:V},M.create=function(e,t){return new M(e,t)},M.version="1.3.0",M}),function(e){define("select2",["jquery"],function(){return function(){(function(e){typeof e.fn.each2=="undefined"&&e.extend(e.fn,{each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(jQuery),function(e,t){"use strict";function p(t){var n=e(document.createTextNode(""));t.before(n),n.before(t),n.remove()}function d(e){function t(e){return h[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function v(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(g(e,t[n]))return n;return-1}function m(){var t=e(c);t.appendTo(document.body);var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function g(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function y(e,t,n){var r,i,s;if(e===null||e.length<1)return[];r=e.split(t);for(i=0,s=r.length;i<s;i+=1)r[i]=n(r[i]);return r}function b(e){return e.outerWidth(!1)-e.width()}function w(n){var r="keyup-change-value";n.on("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.on("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function E(n){n.on("mousemove",function(n){var r=u;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function S(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function x(e,t){var n=S(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){v(e.target,t.get())>=0&&n(e)})}function T(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus();var i=t.offsetWidth>0||t.offsetHeight>0;i&&t===document.activeElement&&(t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!1),r.select()))},0)}function N(t){t=e(t)[0];var n=0,r=0;if("selectionStart"in t)n=t.selectionStart,r=t.selectionEnd-n;else if("selection"in document){t.focus();var i=document.selection.createRange();r=document.selection.createRange().text.length,i.moveStart("character",-t.value.length),n=i.text.length-r}return{offset:n,length:r}}function C(e){e.preventDefault(),e.stopPropagation()}function k(e){e.preventDefault(),e.stopImmediatePropagation()}function L(t){if(!o){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);o=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),o.attr("class","select2-sizer"),e(document.body).append(o)}return o.text(t.val()),o.width()}function A(t,n,r){var i,s=[],o;i=e.trim(t.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each2(function(){this.indexOf("select2-")===0&&s.push(this)})),i=e.trim(n.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),o&&s.push(o))})),t.attr("class",s.join(" "))}function O(e,t,n,r){var i=d(e.toUpperCase()).indexOf(d(t.toUpperCase())),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function M(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function _(n){var r,i=null,s=n.quietMillis||100,o=n.url,u=this;return function(a){window.clearTimeout(r),r=window.setTimeout(function(){var r=n.data,s=o,f=n.transport||e.fn.select2.ajaxDefaults.transport,l={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},c=e.extend({},e.fn.select2.ajaxDefaults.params,l);r=r?r.call(u,a.term,a.page,a.context):null,s=typeof s=="function"?s.call(u,a.term,a.page,a.context):s,i&&typeof i.abort=="function"&&i.abort(),n.params&&(e.isFunction(n.params)?e.extend(c,n.params.call(u)):e.extend(c,n.params)),e.extend(c,{url:s,dataType:n.dataType,data:r,success:function(e){var t=n.results(e,a.page,a);a.callback(t)},error:function(e,t,n){var r={hasError:!0,jqXHR:e,textStatus:t,errorThrown:n};a.callback(r)}}),i=f.call(u,c)},s)}}function D(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=o.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function P(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]},u=r?n(i):n;e.isArray(u)&&(e(u).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o))}}function H(t,n){if(e.isFunction(t))return!0;if(!t)return!1;if(typeof t=="string")return!0;throw new Error(n+" must be a string, function, or falsy value")}function B(t,n){if(e.isFunction(t)){var r=Array.prototype.slice.call(arguments,2);return t.apply(n,r)}return t}function j(t){var n=0;return e.each(t,function(e,t){t.children?n+=j(t.children):n++}),n}function F(e,n,r,i){var s=e,o=!1,u,a,f,l,c;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){c=i.tokenSeparators[f],a=e.indexOf(c);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+c.length);if(u.length>0){u=i.createSearchChoice.call(this,u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(g(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function I(){var t=this;e.each(arguments,function(e,n){t[n].remove(),t[n]=null})}function q(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}if(window.Select2!==t)return;var n,r,i,s,o,u={x:0,y:0},a,f,l={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case l.LEFT:case l.RIGHT:case l.UP:case l.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case l.SHIFT:case l.CTRL:case l.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},c="<div class='select2-measure-scrollbar'></div>",h={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};a=e(document),s=function(){var e=1;return function(){return e++}}(),n=q(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,o=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e(".select2-hidden-accessible"),this.liveRegion.length==0&&(this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+s()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",n.element.attr("title")),this.body=e(document.body),A(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(B(n.containerCss,this.opts.element)),this.container.addClass(B(n.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",C),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),A(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(B(n.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",C),this.results=r=this.container.find(o),this.search=i=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",C),E(this.results),this.dropdown.on("mousemove-filtered",o,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",o,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",o,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",o,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),x(80,this.results),this.dropdown.on("scroll-debounced",o,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop();i>0&&s-i<=0?(r.scrollTop(0),C(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),C(e))}),w(i),i.on("keyup-change input paste",this.bind(this.updateResults)),i.on("focus",function(){i.addClass("select2-focused")}),i.on("blur",function(){i.removeClass("select2-focused")}),this.dropdown.on("mouseup",o,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),n.maximumInputLength!==null&&this.search.attr("maxlength",n.maximumInputLength);var u=n.element.prop("disabled");u===t&&(u=!1),this.enable(!u);var a=n.element.prop("readonly");a===t&&(a=!1),this.readonly(a),f=f||m(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",n.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,n=e.data("select2"),r=this;this.close(),e.length&&e[0].detachEvent&&r._sync&&e.each(function(){r._sync&&this.detachEvent("onpropertychange",r._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,n!==t&&(n.container.remove(),n.liveRegion.remove(),n.dropdown.remove(),e.removeData("select2").off(".select2"),e.is("input[type='hidden']")?e.css("display",""):(e.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())),I.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){if(e.is("option"))return{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:g(e.attr("locked"),"locked")||g(e.data("locked"),!0)};if(e.is("optgroup"))return{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}},prepareOpts:function(n){var r,i,o,u,a=this;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n.debug=n.debug||e.fn.select2.defaults.debug,n.debug&&console&&console.warn&&(n.id!=null&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),n.text!=null&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),n.sortResults!=null&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),n.selectOnBlur!=null&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),n.ajax!=null&&n.ajax.results!=null&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),n.formatNoResults!=null&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),n.formatSearching!=null&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),n.formatInputTooShort!=null&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),n.formatInputTooLong!=null&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),n.formatLoading!=null&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),n.formatSelectionTooBig!=null&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),n.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0."));if(n.element.data("tags")!=null){var f=n.element.data("tags");e.isArray(f)||(f=[]),n.element.data("select2Tags",f)}n.sorter!=null&&(n.sortResults=n.sorter),n.selectOnClose!=null&&(n.selectOnBlur=n.selectOnClose),n.ajax!=null&&e.isFunction(n.ajax.processResults)&&(n.ajax.results=n.ajax.processResults);if(n.language!=null){var l=n.language;e.isFunction(l.noMatches)&&(n.formatNoMatches=l.noMatches),e.isFunction(l.searching)&&(n.formatSearching=l.searching),e.isFunction(l.inputTooShort)&&(n.formatInputTooShort=l.inputTooShort),e.isFunction(l.inputTooLong)&&(n.formatInputTooLong=l.inputTooLong),e.isFunction(l.loadingMore)&&(n.formatLoading=l.loadingMore),e.isFunction(l.maximumSelected)&&(n.formatSelectionTooBig=l.maximumSelected)}n=e.extend({},{populateResults:function(r,i,o){var u,f=this.opts.id,l=this.liveRegion;u=function(r,i,c){var h,p,d,v,m,g,y,b,w,E;r=n.sortResults(r,i,o);var S=[];for(h=0,p=r.length;h<p;h+=1)d=r[h],m=d.disabled===!0,v=!m&&f(d)!==t,g=d.children&&d.children.length>0,y=e("<li></li>"),y.addClass("select2-results-dept-"+c),y.addClass("select2-result"),y.addClass(v?"select2-result-selectable":"select2-result-unselectable"),m&&y.addClass("select2-disabled"),g&&y.addClass("select2-result-with-children"),y.addClass(a.opts.formatResultCssClass(d)),y.attr("role","presentation"),b=e(document.createElement("div")),b.addClass("select2-result-label"),b.attr("id","select2-result-label-"+s()),b.attr("role","option"),E=n.formatResult(d,b,o,a.opts.escapeMarkup),E!==t&&(b.html(E),y.append(b)),g&&(w=e("<ul></ul>"),w.addClass("select2-result-sub"),u(d.children,w,c+1),y.append(w)),y.data("select2-data",d),S.push(y[0]);i.append(S),l.text(n.formatMatches(r.length))},u(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(o=n.id,n.id=function(e){return e[o]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}i?(n.query=this.bind(function(e){var n={results:[],more:!1},i=e.term,s,o,u;u=function(t,n){var r;t.is("option")?e.matcher(i,t.text(),t)&&n.push(a.optionToData(t)):t.is("optgroup")&&(r=a.optionToData(t),t.children().each2(function(e,t){u(t,r.children)}),r.children.length>0&&n.push(r))},s=r.children(),this.getPlaceholder()!==t&&s.length>0&&(o=this.getPlaceholderOption(),o&&(s=s.not(o))),s.each2(function(e,t){u(t,n.results)}),e.callback(n)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?(u=n.element.data("ajax-url"),u&&u.length>0&&(n.ajax.url=u),n.query=_.call(n.element,n.ajax)):"data"in n?n.query=D(n.data):"tags"in n&&(n.query=P(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(y(t.val(),n.separator,n.transformVal)).each(function(){var t={id:this,text:this},r=n.tags;e.isFunction(r)&&(r=r()),e(r).each(function(){if(g(this.id,t.id))return t=this,!1}),i.push(t)}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");if(n.createSearchChoicePosition==="top")n.createSearchChoicePosition=function(e,t){e.unshift(t)};else if(n.createSearchChoicePosition==="bottom")n.createSearchChoicePosition=function(e,t){e.push(t)};else if(typeof n.createSearchChoicePosition!="function")throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return n},monitorSource:function(){var n=this.opts.element,r,i=this;n.on("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var e=n.prop("disabled");e===t&&(e=!1),this.enable(!e);var r=n.prop("readonly");r===t&&(r=!1),this.readonly(r),this.container&&(A(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(B(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(A(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(B(this.opts.dropdownCssClass,this.opts.element)))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",i._sync)}),r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,r!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new r(function(t){e.each(t,i._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0);if(this._enabled===e)return;this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface()},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1);if(this._readonly===e)return;this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface()},opened:function(){return this.container?this.container.hasClass("select2-dropdown-open"):!1},positionDropdown:function(){var t=this.dropdown,n=this.container,r=n.offset(),i=n.outerHeight(!1),s=n.outerWidth(!1),o=t.outerHeight(!1),u=e(window),a=u.width(),l=u.height(),c=u.scrollLeft()+a,h=u.scrollTop()+l,p=r.top+i,d=r.left,v=p+o<=h,m=r.top-o>=u.scrollTop(),g=t.outerWidth(!1),y=function(){return d+g<=c},b=function(){return r.left+c+n.outerWidth(!1)>g},w=t.hasClass("select2-drop-above"),E,S,x,T,N;w?(S=!0,!m&&v&&(x=!0,S=!1)):(S=!1,!v&&m&&(x=!0,S=!0)),x&&(t.hide(),r=this.container.offset(),i=this.container.outerHeight(!1),s=this.container.outerWidth(!1),o=t.outerHeight(!1),c=u.scrollLeft()+a,h=u.scrollTop()+l,p=r.top+i,d=r.left,g=t.outerWidth(!1),t.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(N=e(".select2-results",t)[0],t.addClass("select2-drop-auto-width"),t.css("width",""),g=t.outerWidth(!1)+(N.scrollHeight===N.clientHeight?0:f.width),g>s?s=g:g=s,o=t.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),this.body.css("position")!=="static"&&(E=this.body.offset(),p-=E.top,d-=E.left),!y()&&b()&&(d=r.left+this.container.outerWidth(!1)-g),T={left:d,width:s},S?(this.container.addClass("select2-drop-above"),t.addClass("select2-drop-above"),o=t.outerHeight(!1),T.top=r.top-o,T.bottom="auto"):(T.top=p,T.bottom="auto",this.container.removeClass("select2-drop-above"),t.removeClass("select2-drop-above")),T=e.extend(T,B(this.opts.dropdownCss,this.opts.element)),t.css(T)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),a.on("mousemove.select2Event",function(e){u.x=e.pageX,u.y=e.pageY}),!0):!1},opening:function(){var t=this.containerEventName,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),s=e("#select2-drop-mask"),s.length===0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body),s.on("mousedown touchstart click",function(t){p(s);var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close(),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var o=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+n+" "+i,function(e){o.opened()&&o.positionDropdown()})})},close:function(){if(!this.opened())return;var t=this.containerEventName,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(r).off(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),a.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(e.Event("select2-close"))},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(this.search.val()!=="")return!1;var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return e!==t?(this.search.val(e),this.search.select(),!0):!1},getMaximumSelectionSize:function(){return B(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a,f;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices().find(".select2-result-label"),i=e(n[r]),f=(i.offset()||{}).top||0,s=f+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!1),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=f-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return v(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.removeHighlight(),r=e(n[t]),r.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",r.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(r.text()),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=this.resultsPage+1,i=this,s=this.search.val(),o=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:r,context:o,matcher:this.opts.matcher,callback:this.bind(function(n){if(!i.opened())return;i.opts.populateResults.call(this,e,n.results,{term:s,page:r,context:o}),i.postprocessResults(n,!1,!1),n.more===!0?(t.detach().appendTo(e).html(i.opts.escapeMarkup(B(i.opts.formatLoadMore,i.opts.element,r+1))),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):t.remove(),i.positionDropdown(),i.resultsPage=r,i.context=n.context,this.opts.element.trigger({type:"select2-loaded",items:n})})}))},tokenize:function(){},updateResults:function(n){function h(){r.removeClass("select2-active"),u.positionDropdown(),i.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?u.liveRegion.text(i.text()):u.liveRegion.text(u.opts.formatMatches(i.find('.select2-result-selectable:not(".select2-selected")').length))}function p(e){i.html(e),h()}var r=this.search,i=this.results,s=this.opts,o,u=this,a,f=r.val(),l=e.data(this.container,"select2-last-term"),c;if(n!==!0&&l&&g(f,l))return;e.data(this.container,"select2-last-term",f);if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;c=++this.queryCount;var d=this.getMaximumSelectionSize();if(d>=1){o=this.data();if(e.isArray(o)&&o.length>=d&&H(s.formatSelectionTooBig,"formatSelectionTooBig")){p("<li class='select2-selection-limit'>"+B(s.formatSelectionTooBig,s.element,d)+"</li>");return}}if(r.val().length<s.minimumInputLength){H(s.formatInputTooShort,"formatInputTooShort")?p("<li class='select2-no-results'>"+B(s.formatInputTooShort,s.element,r.val(),s.minimumInputLength)+"</li>"):p(""),n&&this.showSearch&&this.showSearch(!0);return}if(s.maximumInputLength&&r.val().length>s.maximumInputLength){H(s.formatInputTooLong,"formatInputTooLong")?p("<li class='select2-no-results'>"+B(s.formatInputTooLong,s.element,r.val(),s.maximumInputLength)+"</li>"):p("");return}s.formatSearching&&this.findHighlightableChoices().length===0&&p("<li class='select2-searching'>"+B(s.formatSearching,s.element)+"</li>"),r.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(c!=this.queryCount)return;if(!this.opened()){this.search.removeClass("select2-active");return}if(o.hasError!==t&&H(s.formatAjaxError,"formatAjaxError")){p("<li class='select2-ajax-error'>"+B(s.formatAjaxError,s.element,o.jqXHR,o.textStatus,o.errorThrown)+"</li>");return}this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(u,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return g(u.id(this),u.id(a))}).length===0&&this.opts.createSearchChoicePosition(o.results,a));if(o.results.length===0&&H(s.formatNoMatches,"formatNoMatches")){p("<li class='select2-no-results'>"+B(s.formatNoMatches,s.element,r.val())+"</li>"),this.showSearch&&this.showSearch(r.val());return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&H(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+s.escapeMarkup(B(s.formatLoadMore,s.element,this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),h(),this.opts.element.trigger({type:"select2-loaded",items:o})})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){T(this.search)},selectHighlighted:function(e){if(this._touchMoved){this.clearTouchMoved();return}var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r?(this.highlight(t),this.onSelect(r,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var n=this.select.children("option").first();if(this.opts.placeholderOption!==t)return this.opts.placeholderOption==="first"&&n||typeof this.opts.placeholderOption=="function"&&this.opts.placeholderOption(this.select);if(e.trim(n.text())===""&&n.val()==="")return n}},initContainerWidth:function(){function t(){var t,n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){t=this.opts.element.attr("style");if(typeof t=="string"){n=t.split(";");for(i=0,s=n.length;i<s;i+=1){o=n[i].replace(/\s/g,""),r=o.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(r!==null&&r.length>=1)return r[1]}}return this.opts.width==="resolve"?(t=this.opts.element.css("width"),t.indexOf("%")>0?t:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=t.call(this);n!==null&&this.container.css("width",n)}}),r=q(n,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var t,n,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),t=this.search.get(0),t.createTextRange?(n=t.createTextRange(),n.collapse(!1),n.select()):t.setSelectionRange&&(r=this.search.val().length,t.setSelectionRange(r,r))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),I.call(this,"selection","focusser")},initContainer:function(){var t,n=this.container,r=this.dropdown,i=s(),o;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+i),this.focusser.attr("aria-labelledby","select2-chosen-"+i),this.results.attr("id","select2-results-"+i),this.search.attr("aria-owns","select2-results-"+i),this.focusser.attr("id","s2id_autogen"+i),o=e("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(o.text()).attr("for",this.focusser.attr("id"));var u=this.opts.element.attr("title");this.opts.element.attr("title",u||o.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(229==e.keyCode)return;if(e.which===l.PAGE_UP||e.which===l.PAGE_DOWN){C(e);return}switch(e.which){case l.UP:case l.DOWN:this.moveHighlight(e.which===l.UP?-1:1),C(e);return;case l.ENTER:this.selectHighlighted(),C(e);return;case l.TAB:this.selectHighlighted({noFocus:!0});return;case l.ESC:this.cancel(e),C(e);return}})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&this.results.length>1&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===l.TAB||l.isControl(e)||l.isFunctionKey(e)||e.which===l.ESC)return;if(this.opts.openOnEnter===!1&&e.which===l.ENTER){C(e);return}if(e.which==l.DOWN||e.which==l.UP||e.which==l.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;this.open(),C(e);return}if(e.which==l.DELETE||e.which==l.BACKSPACE){this.opts.allowClear&&this.clear(),C(e);return}})),w(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){e.stopPropagation();if(this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.clear(),k(e),this.close(),this.selection&&this.selection.focus()})),t.on("mousedown touchstart",this.bind(function(n){p(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),C(n)})),r.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){C(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var r=e.Event("select2-clearing");this.opts.element.trigger(r);if(r.isDefaultPrevented())return;var i=this.getPlaceholderOption();this.opts.element.val(i?i.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){var e;if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder(),n.lastSearchTerm=n.search.val())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()===t?!1:(e=this.getPlaceholderOption())!==t&&e.prop("selected")||this.opts.element.val()===""||this.opts.element.val()===t||this.opts.element.val()===null},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var r=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(r))}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val(),s=null;t.query({matcher:function(e,n,r){var o=g(i,t.id(r));return o&&(s=r),o},callback:e.isFunction(r)?function(){r(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var r=0,i=this,s=!0;this.findHighlightableChoices().each2(function(e,t){if(g(i.id(t.data("select2-data")),i.opts.element.val()))return r=e,!1}),n!==!1&&(t===!0&&r>=0?this.highlight(r):this.highlight(0));if(t===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(j(e.results)>=o)}},showSearch:function(t){if(this.showSearchInput===t)return;this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t)},onSelect:function(e,t){if(!this.triggerSelect(e))return;var n=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.close(),(!t||!t.noFocus)&&this.opts.shouldFocusInput(this)&&this.focusser.focus(),g(n,this.id(e))||this.triggerChange({added:e,removed:r})},updateSelection:function(e){var n=this.selection.find(".select2-chosen"),r,i;this.selection.data("select2-data",e),n.empty(),e!==null&&(r=this.opts.formatSelection(e,n,this.opts.escapeMarkup)),r!==t&&n.append(r),i=this.opts.formatSelectionCssClass(e,n),i!==t&&n.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,r=null,i=this,s=this.data();if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.'));if(this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return r=i.optionToData(t),!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange({added:r,removed:s});else{if(!e&&e!==0){this.clear(n);return}if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange({added:e,removed:s})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,r=!1;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),arguments.length>1&&(r=arguments[1]),e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),r&&this.triggerChange({added:e,removed:n})):this.clear(r)}}),i=q(n,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var r=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){r.push(n.optionToData(t))}),t(r)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=y(n.val(),t.separator,t.transformVal),s=[];t.query({matcher:function(n,r,o){var u=e.grep(i,function(e){return g(e,t.id(o))}).length;return u&&s.push(o),u},callback:e.isFunction(r)?function(){var e=[];for(var n=0;n<i.length;n++){var o=i[n];for(var u=0;u<s.length;u++){var a=s[u];if(g(o,t.id(a))){e.push(a),s.splice(u,1);break}}}r(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");if(!t.length||!e||e[0]!=t[0])t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),I.call(this,"searchContainer","selection")},initContainer:function(){var t=".select2-choices",n;this.searchContainer=this.container.find(".select2-search-field"),this.selection=n=this.container.find(t);var r=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(t){r.search[0].focus(),r.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+s()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){if(this.search.attr("placeholder")&&this.search.val().length==0)return;if(!this.isInterfaceEnabled())return;this.opened()||this.open()})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;++this.keydowns;var t=n.find(".select2-search-choice-focus"),r=t.prev(".select2-search-choice:not(.select2-locked)"),i=t.next(".select2-search-choice:not(.select2-locked)"),s=N(this.search);if(!(!t.length||e.which!=l.LEFT&&e.which!=l.RIGHT&&e.which!=l.BACKSPACE&&e.which!=l.DELETE&&e.which!=l.ENTER)){var o=t;e.which==l.LEFT&&r.length?o=r:e.which==l.RIGHT?o=i.length?i:null:e.which===l.BACKSPACE?this.unselect(t.first())&&(this.search.width(10),o=r.length?r:i):e.which==l.DELETE?this.unselect(t.first())&&(this.search.width(10),o=i.length?i:null):e.which==l.ENTER&&(o=null),this.selectChoice(o),C(e),(!o||!o.length)&&this.open();return}if((e.which===l.BACKSPACE&&this.keydowns==1||e.which==l.LEFT)&&s.offset==0&&!s.length){this.selectChoice(n.find(".select2-search-choice:not(.select2-locked)").last()),C(e);return}this.selectChoice(null);if(this.opened())switch(e.which){case l.UP:case l.DOWN:this.moveHighlight(e.which===l.UP?-1:1),C(e);return;case l.ENTER:this.selectHighlighted(),C(e);return;case l.TAB:this.selectHighlighted({noFocus:!0}),this.close();return;case l.ESC:this.cancel(e),C(e);return}if(e.which===l.TAB||l.isControl(e)||l.isFunctionKey(e)||e.which===l.BACKSPACE||e.which===l.ESC)return;if(e.which===l.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===l.PAGE_UP||e.which===l.PAGE_DOWN)&&C(e),e.which===l.ENTER&&C(e)})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",t,this.bind(function(t){if(!this.isInterfaceEnabled())return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()})),this.container.on("focus",t,this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n={},r=[],i=this;e(t).each(function(){i.id(this)in n||(n[i.id(this)]=0,r.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(r),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){if(!this.triggerSelect(e)||e.text==="")return;this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(t){var n=this.getVal(),r=this;e(t).each(function(){n.push(r.createChoice(this))}),this.setVal(n)},createChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a,f;return a=this.opts.formatSelection(n,o.find("div"),this.opts.escapeMarkup),a!=t&&o.find("div").replaceWith(e("<div></div>").html(a)),f=this.opts.formatSelectionCssClass(n,o.find("div")),f!=t&&o.addClass(f),r&&o.find(".select2-search-choice-close").on("mousedown",C).on("click dblclick",this.bind(function(t){if(!this.isInterfaceEnabled())return;this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),C(t),this.close(),this.focusSearch()})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),u},unselect:function(t){var n=this.getVal(),r,i;t=t.closest(".select2-search-choice");if(t.length===0)throw"Invalid argument: "+t+". Must be .select2-search-choice";r=t.data("select2-data");if(!r)return;var s=e.Event("select2-removing");s.val=this.id(r),s.choice=r,this.opts.element.trigger(s);if(s.isDefaultPrevented())return!1;while((i=v(this.id(r),n))>=0)n.splice(i,1),this.setVal(n),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r}),this.triggerChange({removed:r}),!0},postprocessResults:function(e,t,n){var r=this.getVal(),i=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),o=this;i.each2(function(e,t){var n=o.id(t.data("select2-data"));v(n,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&n!==!1&&this.opts.closeOnSelect===!0&&o.highlight(0),!this.opts.createSearchChoice&&!i.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&this.results.find(".select2-no-results").length===0)&&H(o.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+B(o.opts.formatNoMatches,o.opts.element,o.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-b(this.search)},resizeSearch:function(){var e,t,n,r,i,s=b(this.search);e=L(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),y(e,this.opts.separator,this.opts.transformVal))},setVal:function(t){if(this.select)this.select.val(t);else{var n=[],r={};e(t).each(function(){this in r||(n.push(this),r[this]=0)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator))}},buildChangeDetails:function(e,t){var t=t.slice(0),e=e.slice(0);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(g(this.opts.id(t[n]),this.opts.id(e[r]))){t.splice(n,1),n--,e.splice(r,1);break}return{added:t,removed:e}},val:function(n,r){var i,s=this;if(arguments.length===0)return this.getVal();i=this.data(),i.length||(i=[]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange({added:this.data(),removed:i});return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange(s.buildChangeDetails(i,s.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var r=this,i,s;if(arguments.length===0)return this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();s=this.data(),t||(t=[]),i=e.map(t,function(e){return r.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(s,this.data()))}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,i,s,o,u,a=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],f=["opened","isFocused","container","dropdown"],l=["val","data"],c={search:"externalSearch"};return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?u=r.element.prop("multiple"):(u=r.multiple||!1,"tags"in r&&(r.multiple=u=!0)),i=u?new window.Select2["class"].multi:new window.Select2["class"].single,i.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(v(n[0],a)<0)throw"Unknown method: "+n[0];o=t,i=e(this).data("select2");if(i===t)return;s=n[0],s==="container"?o=i.container:s==="dropdown"?o=i.dropdown:(c[s]&&(s=c[s]),o=i[s].apply(i,n.slice(1)));if(v(n[0],f)>=0||v(n[0],l)>=0&&n.length==1)return!1}}),o===t?this:o},e.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return O(this.text(e),n.term,i,r),i.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,n,r){return e?r(this.text(e)):t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,n){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){return t&&this.data&&this.data.text?e.isFunction(this.data.text)?this.data.text(t):t[this.data.text]:t.text},matcher:function(e,t){return d(""+t).toUpperCase().indexOf(d(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:F,escapeMarkup:M,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,n){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;return t?e.opts.minimumResultsForSearch<0?!1:!0:!0}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return e===1?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,n){return"Loading failed"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:_,local:D,tags:P},util:{debounce:S,markMatch:O,escapeMarkup:M,stripDiacritics:d},"class":{"abstract":n,single:r,multi:i}}}(jQuery)}.apply(e,arguments)})}(this),define("AnalysisPageServer/Parameters/Select2Behavior/Select2Behavior",["marionette","Sortable","select2","bootstrap"],function(e,t){return e.Behavior.extend({modelEvents:{"change:value":"onModelChangeValue"},onRender:function(){this.view.ui.field.select2(this.getSelect2Options()),this.view.model.get("allow_multiple")&&this.initializeSortable(),this.updateSelectionFromModel(),this.initializeDomEventStreams()},onShowFully:function(){this.view.model.get("allow_multiple")||this.initializePopover()},onBeforeDestroy:function(){this.$(".select2-container").popover("destroy"),this.view.ui.field.select2("destroy"),this.sortable&&this.sortable.destroy()},onModelChangeValue:function(e,t,n){n.unset&&this.reset(),this.updateSelectionFromModel()},initializeSortable:function(){var e=this.$("ul.select2-choices");this.sortable=new t(e[0]),e.asEventStream("update").takeUntil(this.view.getDestroyES()).onValue(this.view.ui.field,"select2","onSortEnd")},initializeDomEventStreams:function(){this.$el.asEventStream("change","#"+this.view.cid).takeUntil(this.view.getDestroyES()).onValue(this.view,"_setModelValue"),this.$el.asEventStream("select2-selecting","#"+this.view.cid).takeUntil(this.view.getDestroyES()).onValue(this,"_actOnDropdownActions")},initializePopover:function(){if(!this._isPopoverNecessary())return;this.$(".select2-container").popover({title:this.view.model.get("label"),content:_.bind(this._popoverContent,this),trigger:"hover",placement:"top"})},updatePopover:function(){this.$(".select2-container").popover("destroy"),this.initializePopover()},_isPopoverNecessary:function(){var e=$("<span></span>");e.css({position:"absolute",visibility:"hidden",overflow:"visible"}),e.text(this._popoverContent()),this.$(".select2-choice").append(e);var t=e.width()-10>this.$(".select2-chosen").width();return e.remove(),t},getSelect2Options:function(){return{multiple:this.view.model.get("allow_multiple"),query:_.bind(this._select2Query,this),placeholder:this.view.model.get("prompt"),closeOnSelect:!this.view.model.get("allow_multiple"),formatResult:_.bind(this._select2FormatResult,this),separator:"|_NO_AUTO_SEPARATOR_|",transformVal:_.bind(this._select2TransformVal,this)}},_select2TransformVal:function(e){return e},_select2FormatResult:function(e){return!e.id&&e.text===" "?"<hr/>":e.text},_actOnDropdownActions:function(e){e.choice.id==="action-select-all"?(e.preventDefault(),this.view.model.selectAll(),this.updateSelectionFromModel(),this.view.ui.field.select2("close")):e.choice.id==="action-deselect-all"?(e.preventDefault(),this.view.model.deselectAll(),this.view.ui.field.select2("close")):!this.view.model.get("allow_multiple")&&e.choice.id==this.view.model.getValue()&&this.reset()},isSelectAllAllowed:function(){var e=this.view.model.get(this.getOption("optionsAttribute"));return this.view.model.get("allow_multiple")&&_.size(e)>1&&_.size(e)!==_.size(this.view.model.get("value"))},isDeselectAllAllowed:function(){return this.view.model.get("allow_multiple")&&_.size(this.view.model.get("value"))>1},reset:function(){this.view.ui.field.select2("val","")}})}),define("AnalysisPageServer/Parameters/Select/show/Select2SelectBehavior",["marionette","bacon","../../Select2Behavior/Select2Behavior"],function(e,t,n){return n.extend({_select2Query:function(e){function n(t){return t&&t.toLowerCase().indexOf(e.term.toLowerCase())>-1}function r(e){var t=_.map(e,function(e,t){return n(e)?[t,e]:null});return _.object(_.filter(t,function(e){return _.isArray(e)}))}t.once("void").map(this.view.model).map(".attributes.choices").map(r).map(this,"_select2MapChoices").map(this,"_updateDropdownActions").onValue(e,"callback")},_select2MapChoices:function(e){var t={results:_.map(e,function(e,t){return{id:t,text:e}})};return t},_popoverContent:function(){return this.view.model.get("choices")[this.view.model.get("value")]},_updateDropdownActions:function(e){return(this.isSelectAllAllowed()||this.isDeselectAllAllowed())&&e.results.unshift({text:" "}),this.isSelectAllAllowed()&&e.results.unshift({id:"action-select-all",text:"Select All"}),this.isDeselectAllAllowed()&&e.results.unshift({id:"action-deselect-all",text:"Deselect All"}),e},updateSelectionFromModel:function(){var e,t=this.view.model.get("value");this.view.model.get("allow_multiple")?(t=_.isArray(t)?t:t?[t]:null,e=_.map(t,function(e,t){return{id:e,text:this.view.model.get("choices")[e]}},this)):e={id:t,text:this.view.model.get("choices")[t]},this.view.ui.field.select2("data",e),this.view.model.get("allow_multiple")||this.updatePopover()}})}),define("AnalysisPageServer/Parameters/Select/show/itemview/DropdownSelectParameterView",["./SelectParameterView","../Select2SelectBehavior","../../../show/behaviors/ParameterBehavior"],function(e,t,n){return e.extend({template:"#ep-form-text-tmpl",ui:{field:"input"},behaviors:{Select2:{behaviorClass:t,optionsAttribute:"choices"},Base:{behaviorClass:n}},initialize:function(){e.prototype.initialize.apply(this,arguments)},_setModelValue:function(e){this.model.setValue(e.val,{viewTriggered:!0})},onShowFully:function(){}})}),function(){var e,t,n=[].slice;t=function(e){var t,r,i,s,o,u,a,f,l,c,h,p;return u=function(e){return e},l=function(e){return e.length>0},s=function(e,t,n){var r,i,s;for(i=0,s=e.length;i<s;i++)r=e[i],t=n(t,r);return t},f=function(t){return t instanceof e.Property},o=0,a=1,i=function(e,t){return e===t},c=function(e){return function(t,n){return!t.initial&&e(t.value,n.value)}},r=e.Model=function(n){var s,o,f,l,d,v,m,g;return d=a++,o=i,v=0,l=new e.Bus,m=new e.Bus,s=void 0,g=e.update({initial:!0},[l],function(e,t){var n,r,i,s,o,u;return u=e.value,o=t.source,r=t.f,s=r(u),i=[d],n=s!==u,{source:o,value:s,modStack:i,changed:n}},[m],function(e,t){return t}).skipDuplicates(c(o)).changes().toProperty(),f=g.map(".value").skipDuplicates(o),f.dispatcher.subscribe(function(e){if(e.hasValue())return s=e.value()}),f.id||(f.id=d),f.addSyncSource=function(t){return m.plug(t.filter(function(t){return t.changed&&!e._.contains(t.modStack,d)}).doAction(function(){return e.Model.syncCount++}).map(function(e){return h(e,"modStack",e.modStack.concat([d]))}).map(function(e){return p.set(e,f.syncConverter(p.get(e)))}))},f.apply=function(e){return l.plug(e.toEventStream().map(function(t){return{source:e,f:t}})),g.changes().filter(function(t){return t.source!==e}).map(function(e){return e.value})},f.addSource=function(e){return f.apply(e.map(function(e){return function(){return e}}))},f.modify=function(t){return f.apply(e.once(t))},f.set=function(e){return f.modify(function(){return e})},f.get=function(){return s},f.syncEvents=function(){return g.toEventStream()},f.bind=function(e){return this.addSyncSource(e.syncEvents()),e.addSyncSource(this.syncEvents())},f.lens=function(e){var n;return e=t(e),n=r(),this.addSyncSource(f.sampledBy(n.syncEvents(),function(t,n){return p.set(n,e.set(t,n.value))})),n.addSyncSource(this.syncEvents().map(function(t){return p.set(t,e.get(t.value))})),n},f.syncConverter=u,arguments.length>=1&&f.set(n),f},e.Model.syncCount=0,r.combine=function(e){var n,i,s,o,u,a;if(typeof e!="object")return r(e);if(f(e))return e;n=e instanceof Array?[]:{},u=r(n);for(i in e)a=e[i],s=t.objectLens(i),o=u.lens(s),o.bind(r.combine(a));return u},e.Binding=function(t){var n,r,i,s,o,u,a;return s=t.initValue,i=t.get,n=t.events,a=t.set,o=n.map(i),s!=null?a(s):s=i(),u=e.Model(s),r=u.addSource(o),r.assign(a),u},t=e.Lens=function(e){return typeof e=="object"?e:t.objectLens(e)},t.id=t({get:function(e){return e},set:function(e,t){return t}}),t.objectLens=function(n){var r,i;return i=function(e){return t({get:function(t){return t!=null?t[e]:void 0},set:function(t,n){return h(t,e,n)}})},r=e._.filter(l,n.split(".")),t.compose.apply(t,e._.map(i,r))},t.compose=function(){var e,r;return e=1<=arguments.length?n.call(arguments,0):[],r=function(e,n){return t({get:function(t){return n.get(e.get(t))},set:function(t,r){var i,s;return i=e.get(t),s=n.set(i,r),e.set(t,s)}})},s(e,t.id,r)},p=t.objectLens("value"),h=function(e,t,n){var r,i,s;r=e instanceof Array?[]:{};for(i in e)s=e[i],r[i]=s;return t!=null&&(r[t]=n),r},e},typeof module!="undefined"&&module!==null?(e=require("baconjs"),module.exports=t(e)):typeof define=="function"&&define.amd?define("bacon.model",["bacon"],t):t(this.Bacon)}.call(this),function(){var e,t,n,r,i=[].slice;r=function(e,t,n){var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y;c=function(e){return e.length>0},s=function(e){if(!(e instanceof jQuery||e instanceof Array))throw new Error("Value must be either a jQuery object or an Array of jQuery objects")},r=function(e){var t,r,i,s;if(e instanceof jQuery)return e;r=n();for(i=0,s=e.length;i<s;i++)t=e[i],t instanceof jQuery&&(r=r.add(t));return r},h={indexOf:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){var n,r,i,s;for(n=i=0,s=e.length;i<s;n=++i){r=e[n];if(t===r)return n}return-1}},e.$.Model=e.Model,e.$.textFieldValue=function(t,n){var r,i,s;return s=function(){return t.val()||""},r=function(){return e.interval(50).take(10).map(s).filter(c).take(1)},i=t.asEventStream("keyup input change").merge(t.asEventStream("cut paste").delay(1)).merge(r()),e.Binding({initValue:n,get:s,events:i,set:function(e){return t.val(e)}})},e.$.checkBoxValue=function(t,n){return e.Binding({initValue:n,get:function(){return t.prop("checked")||!1},events:t.asEventStream("change"),set:function(e){return t.prop("checked",e)}})},e.$.selectValue=function(t,n){return e.Binding({initValue:n,get:function(){return t.val()},events:t.asEventStream("change"),set:function(e){return t.val(e)}})},e.$.radioGroupValue=function(t,i){return s(t),t=r(t),e.Binding({initValue:i,get:function(){return t.filter(":checked").first().val()},events:t.asEventStream("change"),set:function(e){return t.each(function(t,r){return n(r).prop("checked",r.value===e)})}})},e.$.intRadioGroupValue=function(t,n){var r;return r=e.$.radioGroupValue(t),e.Binding({initValue:n,get:function(){var e;return e=r.get(),e!=null?parseInt(e):e},events:r.syncEvents(),set:function(e){var t;return t=e!=null?Number(e).toString():e,r.set(t)}})},e.$.checkBoxGroupValue=function(t,i){return s(t),t=r(t),e.Binding({initValue:i,get:function(){return t.filter(":checked").map(function(e,t){return n(t).val()}).toArray()},events:t.asEventStream("change"),set:function(e){return t.each(function(t,r){return n(r).prop("checked",h.indexOf(e,n(r).val())>=0)})}})},e.$.ajax=function(t,r){return e.fromPromise(n.ajax(t),r)},e.$.ajaxGet=function(t,n,r,i){return e.$.ajax({url:t,dataType:r,data:n},i)},e.$.ajaxGetJSON=function(t,n,r){return e.$.ajax({url:t,dataType:"json",data:n},r)},e.$.ajaxPost=function(t,n,r,i){return e.$.ajax({url:t,dataType:r,data:n,type:"POST"},i)},e.$.ajaxGetScript=function(t,n){return e.$.ajax({url:t,dataType:"script"},n)},e.$.lazyAjax=function(t){return e.once(t).flatMap(e.$.ajax)},e.Observable.prototype.ajax=function(){return this.flatMapLatest(e.$.ajax)},e.Observable.prototype.toDeferred=function(){var e,t;return t=void 0,e=n.Deferred(),this.take(1).endOnError().subscribe(function(n){if(n.hasValue())return t=n.value(),e.notify(t);if(n.isError())return e.reject(n.error);if(n.isEnd())return e.resolve(t)}),e},f=["keydown","keyup","keypress","click","dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","mouseout","mouseover","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","resize","scroll","select","change","submit","blur","focus","focusin","focusout","load","unload"],l={},p=function(e){return l[e+"E"]=function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],this.asEventStream.apply(this,[e].concat(i.call(t)))}};for(v=0,g=f.length;v<g;v++)o=f[v],p(o);u=["animate","show","hide","toggle","fadeIn","fadeOut","fadeTo","fadeToggle","slideDown","slideUp","slideToggle"],a={},d=function(t){return a[t+"E"]=function(){var n;return n=1<=arguments.length?i.call(arguments,0):[],e.fromPromise(this[t].apply(this,n).promise())}};for(m=0,y=u.length;m<y;m++)o=u[m],d(o);if(n!=null?n.fn:void 0)n.fn.extend(l),n.fn.extend(a),n.fn.asEventStream=e.$.asEventStream;return e.$},typeof module!="undefined"&&module!==null?(t=require("baconjs"),n=require("bacon.model"),e=require("jquery"),module.exports=r(t,n,e)):typeof define=="function"&&define.amd?define("bacon.jquery",["bacon","bacon.model","jquery"],r):r(this.Bacon,this.BaconModel,this.$)}.call(this),define("AnalysisPageServer/Parameters/Select/show/itemview/RadioSelectParameterView",["./SelectParameterView","../../../show/behaviors/ParameterBehavior","bacon.jquery"],function(e,t,n){return e.extend({template:"#ep-form-select-radio-tmpl",ui:{fields:"[type=radio]"},behaviors:{Base:{behaviorClass:t}},initialize:function(){e.prototype.initialize.apply(this,arguments)},initializeDomEventStreams:function(){var e=n.radioGroupValue(this.ui.fields);e.takeUntil(this.getDestroyES()).onValue(this,"_setModelValue")},onRender:function(){this.initializeDomEventStreams()},_onModelChangeValue:function(e){var t=this.ui.fields.filter(function(){return $(this).val()==e.get("value")});t.prop("checked",!0)}})}),define("AnalysisPageServer/Parameters/Select/show/itemview/getSelectParameterView",["./DropdownSelectParameterView","./RadioSelectParameterView"],function(e,t){return function(n){var r=n.model.get("style");return r=="radio"?t:e}}),define("AnalysisPageServer/Parameters/Select/show/SelectShowController",["marionette","./itemview/getSelectParameterView"],function(e,t){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:views:select:class",this.getViewForModel,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getViewForModel:function(e){return t({model:e})}})}),define("AnalysisPageServer/Parameters/Select/select-app",["marionette","app","./show/SelectShowController"],function(e,t,n){var r=t.module("AnalysisPageServer.Parameters.Select"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("AnalysisPageServer/Parameters/Combobox/show/Select2ComboboxBehavior",["marionette","bacon","../../Select2Behavior/Select2Behavior"],function(e,t,n){return n.extend({modelEvents:_.extend({},n.prototype.modelEvents,{"fetch:suggestions:fail":"onModelFetchSuggestionsFail"}),onRender:function(){n.prototype.onRender.call(this),this._queryBus=new t.Bus,this._queryBus.takeUntil(this.view.getDestroyES()).debounce(this.view.model.get("delay.ms")||300).flatMapLatest(this,"_mapQuery").map(this,"_select2MapSuggestions").map(this,"_updateDropdownActions").onValue(this,"_select2QueryCallback"),this.view.model.get("selfDependent")||this.view.model.getSuggestions()},onModelFetchSuggestionsFail:function(){this.view.ui.field.select2("close")},onShowFully:function(){n.prototype.onShowFully.call(this),this.$(".select2-input").trigger("blur")},_select2Query:function(e){this._queryBus.push(e)},_mapQuery:function(e){return this.view.model.get("selfDependent")?this._mapQuerySelfDependent(e):this._mapQueryNonSelfDependent(e)},_mapQuerySelfDependent:function(e){var n=e.term==this.view.model.get("searchTerm");return this.view.model.set("searchTerm",e.term,{viewTriggered:!0}),n?t.once({query:e,suggestions:this.view.model.get("suggestions")}):t.combineWith(function(e,t){return{query:e,suggestions:t.get("suggestions")}},t.once(e),this.view.model.asEventStream("fetch:suggestions:success").take(1))},_mapQueryNonSelfDependent:function(e){function t(t){return _.filter(t,function(t){return t.long_name&&t.long_name.toString().toLowerCase().indexOf(e.term.toLowerCase())>-1})}return{query:e,suggestions:t(this.view.model.get("suggestions"))}},_select2NextSearchTerm:function(e,t){return this.view.model.get("selfDependent")?t||this.view.model.get("searchTerm"):""},_select2MapSuggestions:function(e){return e.select2Result={results:_.map(e.suggestions,function(e){return{id:e.id,text:e.long_name}})},e},_select2QueryCallback:function(e){e.query.callback(e.select2Result)},_updateDropdownActions:function(e){return(this.isSelectAllAllowed()||this.isDeselectAllAllowed())&&e.select2Result.results.unshift({text:" "}),this.isSelectAllAllowed()&&e.select2Result.results.unshift({id:"action-select-all",text:"Select All"}),this.isDeselectAllAllowed()&&e.select2Result.results.unshift({id:"action-deselect-all",text:"Deselect All"}),e},_popoverContent:function(){return this.view.model.get("readable")},updateSelectionFromModel:function(){var e;this.view.model.get("allow_multiple")?e=_.map(this.view.model.get("value"),function(e,t){return{id:e,text:this.view.model.get("readable")[t]}},this):e={id:this.view.model.get("value"),text:this.view.model.get("readable")},this.view.ui.field.select2("data",this.view.model.hasValue()?e:null),this.updatePopover()},getSelect2Options:function(){var e=_.extend(n.prototype.getSelect2Options.call(this),{closeOnSelect:!1,nextSearchTerm:_.bind(this._select2NextSearchTerm,this)});return this.view.model.get("selfDependent")&&(e=_.extend(e,{containerCssClass:this.view.getOption("type")==="landing"?"":"input-xlarge",minimumInputLength:2})),e}})}),define("AnalysisPageServer/Parameters/Combobox/show/itemview/ComboboxParameterView",["marionette","bacon","config","../Select2ComboboxBehavior","../../../show/behaviors/ParameterBehavior"],function(e,t,n,r,i){return e.LayoutView.extend({getTemplate:function(){return this.getOption("type")==="landing"?"#ep-form-landing-combobox-tmpl":"#ep-form-text-tmpl"},className:"control-group",ui:{field:"input[type=text]",submitBtn:"button[type=submit]"},regions:{loader:"[data-loader-region]"},modelEvents:{"fetch:suggestions:start":"onModelFetchSuggestionsStart","fetch:suggestions:success":"onModelFetchSuggestions","fetch:suggestions:fail":"onModelFetchSuggestionsFail"},behaviors:{Select2:{behaviorClass:r,optionsAttribute:"suggestions"},Base:{behaviorClass:i}},initialize:function(){},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},templateHelpers:function(){return this.getReqRes().request("parameters:views:template-helpers",this)},_setModelValue:function(e){this.model.updateFromView(_.pick(e,["added","removed","val"]),{viewTriggered:!0})},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},onRender:function(){this._renderLoader()},_renderLoader:function(){var t=new e.ItemView({template:"#ep-load-indicator-tmpl"});t.$el.css(this._getLoaderPosition()),t.$el.css("position","absolute"),this.getRegion("loader").show(t)},focus:function(){},_getLoaderPosition:function(){return{top:this.getOption("type")==="landing"?"12px":"3px",left:"6px"}},enableLoading:function(){this.$el.addClass("ep-loading")},disableLoading:function(){this.$el.removeClass("ep-loading")},onModelFetchSuggestionsStart:function(){this.enableLoading()},onModelFetchSuggestions:function(){this.disableLoading()},onModelFetchSuggestionsFail:function(e,t){this.disableLoading(),this.getReqRes().request("app:view:show-modal",{type:"error",fullErrorText:t.responseText,backdrop:!1,withClose:!0,title:"Error while populating '"+this.model.get("label")+"' options.",doBtnLabel:"Send an email about this?",cancelBtnLabel:"Cancel",permalink:window.location.origin+n["client.REST.url"]+this.model.get("uri")})},onShowFully:function(){}})}),define("AnalysisPageServer/Parameters/Combobox/show/ComboboxShowController",["marionette","bacon","./itemview/ComboboxParameterView"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("parameters:views:combobox:class",this.getViewForModel,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},createView:function(e){},getViewForModel:function(e){return n}})}),define("AnalysisPageServer/Parameters/Combobox/SuggestionsCallbackController",["marionette","bacon","client/createClient","functions/fixedEncodeURIComponent"],function(e,t,n,r){return e.Controller.extend({initialize:function(){this.restClient=n("REST"),this.getCommands().setHandler("parameters:combobox:suggestions:initialize",this.initializeGetSuggestionsBus,this),this.getCommands().setHandler("parameters:combobox:suggestions:fetch",this.run,this),this.getVent().on("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},onDestroy:function(){this.getCommands().removeHandler("parameters:combobox:suggestions:initialize"),this.getCommands().removeHandler("parameters:combobox:suggestions:fetch"),this.getVent().off("parameters:dependency-changed-value",this.onDependencyChangedValue,this)},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},isCombobox:function(e){return e.get("type")==="combobox"},anyDependencyHasOutdatedValue:function(e){return _.some(e.getComboboxDependencies(),function(t){return t===e?!1:this.getReqRes().request("parameters:has-outdated-value",t)},this)},everyDependencyIsSatisfied:function(e){return _.every(e.getComboboxDependencies(),function(t){return t===e&&e.get("selfDependent")?t.get("searchTerm"):t.hasValue()})},onDependencyChangedValue:function(e,t){this.run(e,t)},run:function(e,t){if(!this.isCombobox(e))return;if(this.anyDependencyHasOutdatedValue(e))return;if(!this.everyDependencyIsSatisfied(e))return;t=t||{},e._getSuggestionsBus.push(this._buildUri(e))},initializeGetSuggestionsBus:function(e){if(!this.isCombobox(e))return;e._getSuggestionsBus=new t.Bus;var n=e._getSuggestionsBus.takeUntil(e.getDestroyES()).skipDuplicates().doAction(e,"trigger","fetch:suggestions:start").flatMapLatest(this,"_mapSuggestionsUri",e);n.filter(_.isArray).onValue(this,"_onSuggestionsFetched",e)},_mapSuggestionsUri:function(e,n){var r=this;return t.fromPromise(Promise.resolve(e.sync("read",e,{url:n})).catch(function(t){r._onSuggestionsFailed(e,t)}),!0)},_buildUri:function(e){var t=e.get("uri"),n=_.invert(e.get("dependent")),i;return t=_.reduce(e.getComboboxDependencies(),function(t,s){return s===e&&e.get("selfDependent")?i=s.get("searchTerm"):i=s.getValue(),t.replace(":"+n[s.get("name")],r(i))},t,this),e.get("n.param")&&(t=t.replace(":"+e.get("n.param"),0)),this.restClient.url(t)},prepareSuggestions:function(e,t){return _.map(t,function(t,n){switch(e.get("response.type")){case"simple":return{i:n,id:t,long_name:t};case"id-long_name-reason":return t.i=n,t}},this)},_onSuggestionsFetched:function(e,t){_.isArray(t)&&(e.set("suggestions",this.prepareSuggestions(e,t)),e.trigger("fetch:suggestions:success",e))},_onSuggestionsFailed:function(e,t){e.set("suggestions",[]),e.trigger("fetch:suggestions:fail",this.restClient,t)}})}),define("AnalysisPageServer/Parameters/Combobox/combobox-app",["marionette","app","./show/ComboboxShowController","./SuggestionsCallbackController"],function(e,t,n,r){var i=t.module("AnalysisPageServer.Parameters.Combobox"),s=Backbone.Wreqr.radio.channel("global").reqres;return i.on("start",function(){this.showC=new n,i.suggestionsCallbackC=new r}),i}),define("AnalysisPageServer/Parameters/parameters-app",["marionette","app","./fetch/ParametersFetchController","./show/ArrayShowController","./show/ParametersShowController","./Summary/show/SummaryShowController","./SetValueController","./DisplayCallbackController","./GetClosestController","./GetDependentController","./ShowIfController","./ShowIfAdvancedController","./ConditionalPersistent/ConditionalPersistentController","./Persistent/PersistentController","./Select/select-app","./Combobox/combobox-app"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=t.module("AnalysisPageServer.Parameters"),v=Backbone.Wreqr.radio.channel("global").reqres;return d.on("start",function(){this.fetchC=new n,this.arrayC=new r,this.showC=new i,this.summaryC=new s}),d.on("stop",function(){this.fetchC.destroy(),this.arrayC.destroy(),this.showC.destroy(),this.summaryC.destroy()}),d.on("start",function(){d.setValueC=new o,d.displayCallbackC=new u,d.getClosestC=new a,d.getDependentC=new f,d.showIfC=new l,d.showIfAdvancedC=new c,d.conditionalPersistentC=new h,d.persistentC=new p}),d.on("stop",function(){d.setValueC.destroy(),d.displayCallbackC.destroy(),d.getClosestC.destroy(),d.getDependentC.destroy(),d.showIfC.destroy(),d.showIfAdvancedC.destroy(),d.conditionalPersistentC.destroy(),d.persistentC.destroy()}),d}),define("AnalysisPageServer/aps-app",["marionette","app","./Forms/forms-app","./Pages/pages-app","./Parameters/parameters-app"],function(e,t){var n=t.module("AnalysisPageServer"),r=Backbone.Wreqr.radio.channel("global").reqres;return n.on("start",function(){}),n}),define("Common/App/show/itemview/FooterView",["marionette","config"],function(e,t){return e.ItemView.extend({template:!1,el:"footer",ui:{contact:"[data-contact]",version:"[data-version]"},events:{"click @ui.contact":"_onClickContact"},onRender:function(){this.ui.version.text("Version "+t.version)},_onClickContact:function(e){var n=t["gmail.link.tmpl"];$(e.currentTarget).attr("href",n.replace("ADDRESS",encodeURIComponent(t["contact.address"])).replace("TITLE","ExpressionPlot Contact").replace("BODY",encodeURIComponent("Permalink to ExpressionPlot: \n\n"+window.location.href)))}})}),define("Common/App/show/AppShowController",["marionette","./itemview/FooterView","velocity.ui"],function(e,t){return e.Controller.extend({initialize:function(e){this.modalC=e.modalController,this.getReqRes().setHandler("app:view",this.getAppView,this),this.getReqRes().setHandler("app:view:show-main",this.showMain,this),this.getReqRes().setHandler("app:view:show-modal",this.showModal,this),this.getCommands().setHandler("app:view:hide-modal",this.hideModal,this),this.getCommands().setHandler("app:view:initialize",this.initializeAppView,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getAppView:function(){return this.appView},initializeAppView:function(e){this.appView=e,e.render();var n=new t;n.render()},showMain:function(e,t){var n=this.appView,r;n.getRegion("main").hasView()?r=$.Velocity.animate(n.getRegion("main").currentView.$el,"transition.slideRightOut",{duration:200}):r=Promise.resolve();var i=r.then(function(){n.getRegion("main").show(e),n.setTitle(t)});return i.then(function(){return $.Velocity.animate(e.$el,"transition.slideLeftIn",{duration:200})}).then(function(){e.triggerMethod("show:fully")}),i},showModal:function(e){var t=this.modalC.createView(e);return this.appView.showChildView("modal",t),t},hideModal:function(){this.appView.getRegion("modal").empty()}})}),define("Common/App/show/layoutview/ModalView",["marionette","bootstrap"],function(e){return e.LayoutView.extend({template:"#ep-modal-tmpl",className:"modal",regions:{body:"[data-body-region]"},ui:{moreBtn:".more",closeBtn:".close",primaryBtn:"[data-primary]",cancelBtn:"[data-cancel]",altBtn:"[data-alt-1]",progress:".progress"},events:{shown:"onModalShown","click @ui.moreBtn":"onClickMore","click @ui.closeBtn":"onClickClose","click @ui.primaryBtn":"onClickBtnPrimary","click @ui.cancelBtn":"onClickBtnCancel","click @ui.altBtn":"onClickBtnAlt"},triggers:{hidden:"hidden"},options:{withClose:!1,cancelBtnLabel:!1,doBtnLabel:!1,progressBar:!1,altBtnLabel:!1},templateHelpers:function(){return this.options},onShow:function(){this.$el.modal(_.defaults(this.options,{backdrop:"static",keyboard:!1}))},onDestroy:function(){this.$el.modal("hide")},hide:function(){this.$el.modal("hide")},runProgressBar:function(){var e=this.ui.progress,t=e.children(),n=parseInt(this.getOption("progressBar"))||1e3;t.css("transitionDuration",n+"ms"),t.width("100%")},onModalShown:function(){this.getOption("progressBar")&&this.runProgressBar()},onClickMore:function(e){e.preventDefault(),this.$(".modal-body .hide").removeClass("hide")},onClickClose:function(e){e.preventDefault(),this.hide()},onClickBtnPrimary:function(){this.trigger("do:primary:action",{view:this}),this.hide()},onClickBtnCancel:function(e){e.preventDefault(),this.trigger("do:cancel:action",{view:this}),this.hide()},onClickBtnAlt:function(e){e.preventDefault(),this.trigger("do:alt:action",{view:this}),this.hide()}})}),define("globalChannel",["marionette"],function(){return Backbone.Wreqr.radio.channel("global")}),define("Common/App/show/ModalShowController",["marionette","./layoutview/ModalView","config","globalChannel","velocity.ui"],function(e,t,n,r){return e.Controller.extend({initialize:function(){},createView:function(e){var t;return e.type==="error"?t=this.createErrorView(e):t=this.createNormalView(e),t.once("hidden",function(){t.destroy()}),t},createNormalView:function(e){var n=new t(e);return n.once("render",function(){n.showChildView("body",e.innerView)}),n},_getErrorText:function(e){return e.fullErrorHtml?e.fullErrorHtml:e.fullErrorText?e.fullErrorText.length<100?e.fullErrorText:e.fullErrorText.substring(0,100)+" <a class='more' href='#'><strong>[more...]</strong></a>"+"<pre class='hide'>"+e.fullErrorText+"</pre>":""},createErrorView:function(n){var i=r.reqres.request("app:model:env");n.doBtnLabel&&i!=="expressionplot"&&(n.doBtnLabel=!1);var s=this,o=new Backbone.Model({type:"danger",title:!1,withClose:!1,text:this._getErrorText(n)}),u=new e.ItemView({template:"#ep-alert-tmpl",model:o}),a=new t(n);return a.once("render",function(){a.showChildView("body",u)}),a.on("do:primary:action",function(){a.ui.primaryBtn.attr("target","_blank").attr("href",s._prepareGmailErrorUrl(n))}),a},_prepareGmailErrorUrl:function(e){var t=n["gmail.link.tmpl"],r="Permalink:\n"+e.permalink+"\n\n\n"+(e.fullErrorHtml||e.fullErrorText)+"\n\n\n\n"+"User Agent: "+window.navigator.userAgent,i=e.title;return t.replace("ADDRESS",encodeURIComponent(n["contact.address"])).replace("TITLE",encodeURIComponent(i)).replace("BODY",encodeURIComponent(r))}})}),define("Common/App/AppModelController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("app:model:initialize",this.initializeModel,this),this.getCommands().setHandler("app:model:set-mode",this.setMode,this),this.getReqRes().setHandler("app:model:mode",this.getMode,this),this.getReqRes().setHandler("app:model:env",this.getEnv,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getVent:function(){return Backbone.Wreqr.radio.channel("global").vent},initializeModel:function(e){this.appModel=e},setMode:function(e){this.appModel.setMode(e),this.getVent().trigger("app:model:change-mode",this.appModel,e)},getMode:function(){return this.appModel.get("mode")},getEnv:function(){return this.appModel.get("env")}})}),define("Common/App/Header/show/layoutview/HeaderView",["marionette","config","bootstrap"],function(e,t){return e.LayoutView.extend({template:!1,el:"header",regions:{rightNav:".nav.pull-right"},ui:{brand:"a.brand",helpLink:"#ep-header-help a",subtitle:"p.navbar-text"},triggers:{"click @ui.brand":"click:brand"},initialize:function(e){e.fixedTop&&this.$el.addClass("navbar-fixed-top")},onRender:function(){this.ui.helpLink.attr("href",t["help.link"])},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},setSubtitle:function(e){this.ui.subtitle.text(e)}})}),define("Common/App/Header/show/itemview/ToolItemView",["marionette"],function(e){return e.ItemView.extend({template:"#ep-list-item-tmpl",tagName:"li",ui:{link:"a"},triggers:{click:{event:"click",stopPropagation:!1}},modelEvents:{"change:active":"_onModelChangeActive","change:label":"_onModelChangeLabel"},onRender:function(){var e="#"+this.model.get("name")+"-page-view";this.ui.link.attr("href",e),this.setActive(this.model.get("active"))},templateHelpers:function(){return{notA:!1,strong:!1,id:!1}},setActive:function(e){this.$el[e?"addClass":"removeClass"]("active")},_onModelChangeActive:function(e,t){this.setActive(t)},_onModelChangeLabel:function(){this.ui.link.text(this.model.get("label"))}})}),define("Common/App/Header/show/compositeview/ToolMenuView",["marionette","../itemview/ToolItemView","bootstrap"],function(e,t){return e.CompositeView.extend({template:!1,el:"#ep-header-tools-menu",childView:t,childViewContainer:"ul",ui:{menuToggler:"a.dropdown-toggle"},events:{activate:"_onScrollspyActivate"},collectionEvents:{add:"onCollectionChange",remove:"onCollectionChange",reset:"onCollectionChange"},onCollectionChange:function(){this.updateVisibility()},onRender:function(){this.$el.prop("id","ep-header-tools-menu"),this.ui.menuToggler.dropdown(),this.updateVisibility()},filter:function(e){return e.get("in_menu")},updateVisibility:function(){var e=_.size(this.collection.getInMenu())>=2;this.$el[e?"show":"hide"]()},_renderTemplate:function(){this.bindUIElements();return},_onScrollspyActivate:function(e){e.originalEvent||(this.$el.removeClass("active"),this.collection.setActive(this.collection.at(this.$(".dropdown-menu > li.active").index())))}})}),define("Common/App/Header/show/HeaderShowController",["marionette","./layoutview/HeaderView","./compositeview/ToolMenuView"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("header:view:initialize",this.initializeHeaderView,this),this.getReqRes().setHandler("header:view",this.getHeaderView,this)},initializeHeaderView:function(){var e=this.getReqRes().request("pages:collection"),n=this.getReqRes().request("app:model:env");this.headerView=new t({fixedTop:n==="analysis-page-server-static"}),this.headerView.render(),this.initializeToolMenu(),this.listenTo(this.headerView,"click:brand",this._onClickBrand),this.listenTo(e,"page:activate",this._onPageActivate)},getHeaderView:function(){return this.headerView},initializeToolMenu:function(){var e=this,t=this.headerView,r=this.getReqRes().request("pages:fetch");r.then(function(t){var r=new n({collection:t});r.render(),e.listenTo(r,"childview:click",e._onClickTool)})},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},_onClickBrand:function(e){var t=this.getReqRes().request("app:model:env"),n=this.getReqRes().request("pages:collection");t==="analysis-page-server-static"?this.getCommands().execute("apss:app:view:select-dataset",n.at(0),!0):this.getCommands().execute("app:view:show-main:landing-page")},_onPageActivate:function(e,t){var n=this;e&&this.stopListening(e,"change:label"),this.headerView.setSubtitle(t.get("hidden")?"":t.get("label")),this.listenTo(t,"change:label",function(){n.headerView.setSubtitle(t.get("hidden")?"":t.get("label"))})},_onClickTool:function(e){var t=this,n=this.getReqRes().request("app:model:env");if(n==="analysis-page-server-static")this.getCommands().execute("apss:app:view:select-dataset",e.model,!0);else{var r=this.getReqRes().request("parameters:fetch",e.model);r.then(function(n){n.size()===0?t.getCommands().execute("app:view:show-main:analysis-page",e.model):t.getCommands().execute("app:view:show-main:primary-page",e.model)})}}})}),define("Common/App/Header/header-app",["marionette","app","./show/HeaderShowController"],function(e,t,n){var r=t.module("Common.App.Header"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.headerShowC=new n({})}),r}),define("Common/App/app-app",["marionette","app","./show/AppShowController","./show/ModalShowController","./AppModelController","./Header/header-app"],function(e,t,n,r,i){var s=t.module("Common.App"),o=Backbone.Wreqr.radio.channel("global").reqres;return s.on("start",function(){this.appModelC=new i,this.modalShowC=new r,this.appShowC=new n({appView:null,modalController:this.modalShowC})}),s}),define("Common/AnalysisData/Html/show/HtmlShowController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:html",this.getView,this),this.getReqRes().setHandler("analysis-data:views:simple",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(t){var n=$("<div></div>");return n.html(t.value),new e.ItemView({template:!1,el:n})}})}),define("Common/AnalysisData/Html/html-app",["marionette","app","./show/HtmlShowController"],function(e,t,n){var r=t.module("Common.AnalysisData.Html"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("Common/AnalysisData/Arrays/show/layoutview/ArrayListItemView",["marionette"],function(e){return e.LayoutView.extend({template:"#ep-analysis-array-list-item-tmpl",regions:{content:"[data-content]"},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},onRender:function(){var e=this.getReqRes().request("analysis-data:views:"+this.model.get("type"),this.model.analysisData,{pageModel:this.getOption("pageModel")});e&&this.getRegion("content").show(e)}})}),define("Common/AnalysisData/Arrays/show/collectionview/ArrayListView",["marionette","../layoutview/ArrayListItemView"],function(e,t){return e.CollectionView.extend({tagName:"dl",getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},childView:t,childViewOptions:function(e,t){return{pageModel:this.getOption("pageModel")}}})}),define("Common/AnalysisData/Arrays/show/layoutview/ArrayTabsView",["marionette","bootstrap"],function(e){return e.LayoutView.extend({template:"#ep-analysis-array-tabs-tmpl",regions:{nav:"[data-nav]",content:"[data-content]"},events:{"click .nav-tabs a[data-toggle='tab']":"_onClickTabNav"},_onClickTabNav:function(e){e.preventDefault(),this.trigger("click:tab",{view:this,collection:this.collection,index:$(e.currentTarget).parent().index(),selectedModel:this.collection.at($(e.currentTarget).parent().index())})}})}),define("Common/AnalysisData/Arrays/show/ArraysShowController",["marionette","./collectionview/ArrayListView","./layoutview/ArrayTabsView"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:array",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},_prepareAnalysisData:function(e){var t=[];_.each(e,function(e){t.push(_.clone(e)),delete e.value});var n=new Backbone.Collection(e);return _.each(t,function(e,t){n.at(t).analysisData=e}),n},getView:function(e,r){r=r||{};var i=this._prepareAnalysisData(e.value);delete e.value;var s=new Backbone.Model(e);if(!r.isRoot)var o=new t(_.extend({},r,{model:s,collection:i}));else var o=new n(_.extend({},r,{model:s,collection:i,className:"tabbable"}));return this.listenToOnce(o,"render",this._onViewRender),o},_onViewRender:function(e){e.getOption("isRoot")?this.getCommands().execute("analysis-data:views:array:tabs:initialize",e):this.getCommands().execute("analysis-data:views:array:list:initialize",e)}})}),define("Common/AnalysisData/Arrays/show/collectionview/TabsContentView",["marionette","bootstrap"],function(e){return e.CollectionView.extend({className:"tab-content",childView:e.ItemView,childViewOptions:function(e,t){return{className:"tab-pane",pageModel:this.getOption("pageModel")}},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},buildChildView:function(e,t,n){var r=this.getReqRes().request("analysis-data:views:"+e.get("type"),e.analysisData,n);return r.relatedModelCid=e.cid,r},onRender:function(){this.setActiveTab(this.collection.at(0))},setActiveTab:function(e){this.children.each(function(e){e.$el.removeClass("active")});var t=this.children.find(function(t){return t.relatedModelCid===e.cid});t&&t.$el.addClass("active")}})}),define("Common/AnalysisData/Arrays/show/collectionview/TabsNavView",["marionette","bootstrap"],function(e){return e.CollectionView.extend({tagName:"ul",className:"nav nav-tabs",childView:e.ItemView,childViewOptions:function(){return{template:"#ep-analysis-array-tabs-navitem-tmpl",tagName:"li"}},onRender:function(){this.setActiveTab(this.collection.at(0))},setActiveTab:function(e){this.children.each(function(e){e.$el.removeClass("active")});var t=this.children.findByModel(e);t&&t.$el.addClass("active")}})}),define("Common/AnalysisData/Arrays/show/TabsShowController",["marionette","./collectionview/TabsContentView","./collectionview/TabsNavView"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:array:tabs:initialize",this.initializeView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeView:function(e){var r=this,i=new n({collection:e.collection}),s=new Backbone.Collection([e.collection.at(0)]),o=new t({collection:s,pageModel:e.getOption("pageModel")});this.listenTo(e,"click:tab",this._onClickTab),e.once("destroy",function(){r.stopListening(e)}),e.getRegion("nav").show(i),e.getRegion("content").show(o)},_onClickTab:function(e){var t=e.view.getChildView("content").collection;e.view.getChildView("nav").setActiveTab(e.selectedModel),!t.get(e.selectedModel)&&e.selectedModel&&t.add(e.selectedModel,{at:e.index}),e.view.getChildView("content").setActiveTab(e.selectedModel)}})}),define("Common/AnalysisData/Arrays/show/ListShowController",["marionette"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:array:list:initialize",this.initializeView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeView:function(e){}})}),define("Common/AnalysisData/Arrays/arrays-app",["marionette","app","./show/ArraysShowController","./show/TabsShowController","./show/ListShowController"],function(e,t,n,r,i){var s=t.module("Common.AnalysisData.Arrays"),o=Backbone.Wreqr.radio.channel("global").reqres;return s.on("start",function(){this.showC=new n,this.tabsShowC=new r,this.listShowC=new i}),s}),define("Common/AnalysisData/Tables/models/FilterModel",["backbone"],function(e){var t=e.Model.extend({toReadableFormat:function(){switch(this.get("type")){case"numeric":case"integer":return this.get("label")+" "+(this.get("subtype")==="min"?">=":"<=")+" "+this.get("value");default:return this.get("label")+" contains "+this.get("value")}}});return t}),define("Common/AnalysisData/Tables/models/TableDataLocalModel",["backbone","config","backbone.localstorage"],function(e,t){var n=e.Model.extend({localStorage:new e.LocalStorage(t["tableData.model.localStorage"]),defaults:{plotFetchMeanTime:5e3},initialize:function(){this.fetch()}});return n}),define("requirejs-web-workers",[],function(){return{version:"1.0.1",load:function(e,t,n,r){if(r.isBuild){n();return}var i=t.toUrl(e);window.Worker?n(new Worker(i)):t(["worker-fake"],function(){n(new Worker(i))})}}}),define("Common/AnalysisData/Tables/models/TableDataModel",["backbone","bacon","./FilterModel","./TableDataLocalModel","requirejs-web-workers!workers/TableDataWorker.js","client/createClient"],function(e,t,n,r,i,s){function u(e){typeof o.jobs[e.jobId]!="undefined"&&(o.jobs[e.jobId].apply(null,[null,_.omit(e,["jobId","cmd","id"])]),delete o.jobs[e.jobId])}function a(e){switch(e.data.cmd){case"init":break;default:u(e.data)}}function f(e){}i.addEventListener("message",a,!1),i.addEventListener("error",f,!1);var o=e.Model.extend({commonLocalModel:new r({id:"common"}),defaults:function(){return{selected:[],newlySelected:[],filteredByIds:!1}},initialize:function(e,t){this.rClient=s("R"),this.pageModel=t.pageModel,i.postMessage({cmd:"init",id:this.cid,data:t.analysis.value.data,meta:t.analysis.value.meta,perChunk:e.perChunk}),this.set("id",t.pageModel.get("name")+"-"+t.analysis.name);var n=_.size(t.analysis.value.data);this.set("size",n),this.set("currentSize",n),this.prepareMeta(t.analysis.value.meta),this.prepareFilters(),this.initializeLocalModel()},initializeLocalModel:function(){this.localModel=new r({id:this.get("id")})},prepareMeta:function(t){var n=_.values(t);n=_.map(n,function(e,t){return e.idx=t,e}),this.metaCollection=new e.Collection(n),this.metaCollection.each(function(e){this.listenTo(e,"change:sortOrder",this._onColChangeSortOrder)},this)},_onColChangeSortOrder:function(e,t,n){var r=this;if(n.unset)return;this.metaCollection.each(function(t){t!==e&&t.unset("sortOrder")}),this.sort(e.get("idx"),t,function(t,n){e.trigger("sort:complete"),r.trigger("sort:complete",n.chunk)})},prepareFilters:function(){var t=0,r,i;this.filtersCollection=new e.Collection,this.metaCollection.each(function(s,o){s.filtersCollection=new e.Collection,i={idx:o,label:s.get("label"),type:s.get("type")};switch(s.get("type")){case"numeric":case"integer":r=new n(_.extend({},i,{i:t++,subtype:"min"})),this.listenTo(r,"change:value",this.onFilterChangeValue),this.filtersCollection.add(r),s.filtersCollection.add(r),r=new n(_.extend({},i,{i:t++,subtype:"max"})),this.listenTo(r,"change:value",this.onFilterChangeValue),this.filtersCollection.add(r),s.filtersCollection.add(r);break;default:r=new n(_.extend({},i,{i:t++})),this.listenTo(r,"change:value",this.onFilterChangeValue),this.filtersCollection.add(r),s.filtersCollection.add(r)}},this)},_getPlotUrl:function(){return this.pageModel.isDataset()?this.get("plotFile"):this.rClient.url("retrieve",null,{file:this.get("plotFile")})},fetchPlot:function(e){var t=this,n=(new Date).getTime(),r=this.sync("read",this,_.extend({url:this._getPlotUrl(),dataType:"text"},e));return Promise.resolve(r).then(function(e){return t.pageModel.isDataset()||(t.localModel.set("plotFetchMeanTime",(t.localModel.get("plotFetchMeanTime")+((new Date).getTime()-n))/2),t.localModel.save()),e})},getColumnFilters:function(e){return this.filtersCollection.where({idx:e})},anyColumnFilterHasValue:function(e){return _.reduce(this.getColumnFilters(e),function(e,t){return e||t.has("value")},!1)},getDataChunk:function(e,t,n){var r=_.uniqueId();o.jobs[r]=n,i.postMessage({cmd:"getDataChunk",id:this.cid,chunkNo:t,perChunk:e,jobId:r})},sort:function(e,t,n){var r=_.uniqueId();o.jobs[r]=n,i.postMessage({cmd:"sort",id:this.cid,colIdx:e,order:t,jobId:r})},getSummary:function(e,t){var n=_.uniqueId();o.jobs[n]=t,i.postMessage({cmd:"getSummary",id:this.cid,colIdx:e,jobId:n})},getRow:function(e,t){var n=_.uniqueId();o.jobs[n]=t,i.postMessage({cmd:"getRow",id:this.cid,rowId:e,jobId:n})},getActiveRows:function(){var e=_.uniqueId(),t=this;return new Promise(function(n){o.jobs[e]=function(e,t){n(t)},i.postMessage({cmd:"getActiveRows",id:t.cid,jobId:e})})},setSelectedRows:function(e,t){var n=t?_.union(this.get("selected"),e):e;this.set({newlySelected:_.difference(e,this.get("selected")),selected:n})},setAllSelected:function(){var e=this;this.getActiveRows().then(function(t){e.setSelectedRows(_.map(t.rows,function(e){return e.id}),!0)})},filterSelected:function(){this.filterByIds(this.get("selected"))},cancelFilterSelected:function(){this.filterByIds(null)},filterByIds:function(e){var t=_.uniqueId(),n=this;i.postMessage({cmd:"filterByIds",id:this.cid,jobId:t,rowIds:e}),this.set("filteredByIds",!!e),o.jobs[t]=function(e,t){n.set("currentSize",_.size(t.rowIds)),n.trigger("filter:complete",t.chunk,t.rowIds)}},onFilterChangeValue:function(e,t){var n=_.uniqueId(),r=this;this.trigger("filter:before",e),i.postMessage({cmd:"filter",id:this.cid,jobId:n,colIdx:e.get("idx"),value:t,type:e.get("type"),subtype:e.get("subtype")}),o.jobs[n]=function(t,n){r.set("currentSize",_.size(n.rowIds)),e.trigger("filter:complete",e),r.trigger("filter:complete",n.chunk,n.rowIds)}}},{jobs:{},worker:i});return o}),define("Common/AnalysisData/Tables/show/layoutview/TableView",["marionette","bacon","bootstrap"],function(e,t){return e.LayoutView.extend({template:"#ep-analysis-table-tmpl",regions:{thead:"[data-table-thead]",tbody:"[data-table-tbody]"},ui:{downloadCsvBtn:".ep-download-csv",nbRows:".ep-table-info .text-info"},triggers:{"click @ui.downloadCsvBtn":"download:csv"},modelEvents:{"filter:complete":"onModelFilterComplete"},className:"ep-analysis-table",initialize:function(e){},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},templateHelpers:function(){return{withPlot:this.getOption("withPlot")}},onRender:function(){this.updateNbRowsShown()},onDestroy:function(){},getTbodyWidth:function(){return this.getChildView("tbody").getWidth()},getTheadWidth:function(){return this.getChildView("thead").getWidth()},getTheadColumnWidths:function(){return this.getChildView("thead").getColumnWidths()},updateNbRowsShown:function(){var e=this.model.get("currentSize")<this.model.get("size");this.ui.nbRows.text(e?"Showing "+this.model.get("currentSize")+" of "+this.model.get("size"):"Showing All "+this.model.get("size"))},onModelFilterComplete:function(e,t){this.updateNbRowsShown()}})}),define("Common/AnalysisData/Tables/show/itemview/FilterView",["marionette","bacon.jquery"],function(e,t){return e.ItemView.extend({getTemplate:function(){switch(this.model.get("type")){case"numeric":case"integer":return"#ep-numeric-filter-tmpl";default:return"#ep-character-filter-tmpl"}},className:"input-prepend",ui:{clearBtn:"button",textfield:"input[type=text]"},events:{"keydown @ui.textfield":"onTextfieldKeydown","click @ui.clearBtn":"_onClickClearBtn"},modelEvents:{"change:value":"_onModelChangeValue"},templateHelpers:function(){switch(this.model.get("type")){case"numeric":case"integer":return{ge:this.model.get("subtype")==="min",le:this.model.get("subtype")==="max"};default:return{}}},onRender:function(){this.ui.clearBtn.hide(),t.textFieldValue(this.ui.textfield,this.model.get("value")).takeUntil(this.getDestroyES()).debounce(300).onValue(this,"_onTextchange")},onTextfieldKeydown:function(e){e.stopPropagation()},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},focus:function(){this.ui.textfield.focus()},_onTextchange:function(e){e!==""?(this.model.set("value",e),this.ui.clearBtn.show()):(this.model.unset("value"),this.ui.clearBtn.hide())},_onClickClearBtn:function(e){e.preventDefault(),this.model.unset("value"),this.ui.clearBtn.hide(),this.ui.textfield.val("")},_onModelChangeValue:function(){this.update()},update:function(){this.model.has("value")?(this.ui.clearBtn.show(),this.ui.textfield.val(this.model.get("value"))):(this.ui.clearBtn.hide(),this.ui.textfield.val(""))}})}),define("Common/AnalysisData/Tables/show/TablesShowController",["marionette","bacon","Common/AnalysisData/Tables/models/TableDataModel","./layoutview/TableView","./itemview/FilterView"],function(e,t,n,r,i){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:table",this.getView,this),this.getReqRes().setHandler("analysis-data:views:table:filter:class",this.getFilterClass,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getFilterClass:function(){return i},getView:function(e,t){var i,s=this;t=t||{},t.tableDataModel?i=t.tableDataModel:i=new n({perChunk:t.pageModel.get("tableRows")},{pageModel:t.pageModel,analysis:e});var o=new r({model:i,withPlot:!!t.tableDataModel});return this.getCommands().execute("analysis-data:table:initialize-save-as",i,o),this.listenToOnce(o,"render",this._onViewRender),o.once("destroy",function(){t.tableDataModel||i.stopListening(),s.stopListening(o)}),o},_onViewRender:function(e){var n=this.getReqRes().request("analysis-data:views:table:thead",e);e.getRegion("thead").show(n);var r=this.getReqRes().request("analysis-data:views:table:tbody",e);n.on("resize:column",function(){r.adjustChunkColumnWidth()}),r.on("mouseenter:tr",function(t){e.trigger("tbody:mouseenter:tr",t)}),r.on("mouseleave:tr",function(t){e.trigger("tbody:mouseleave:tr",t)}),r.on("render:first-chunk",function(){n.adjustWidth(),n.enableResizableColumns(),r.adjustWidth(),r.adjustChunkColumnWidth()}),t.fromEvent(window,"resize").takeUntil(e.getDestroyES()).debounce(300).onValue(function(){n.adjustWidth(),n.syncHandleWidths(),window.requestAnimationFrame(function(){r.adjustWidth(),r.adjustChunkColumnWidth()})}),e.getRegion("tbody").show(r)}})});var saveAs=saveAs||function(e){"use strict";if(typeof navigator!="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent))return;var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in r,s=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},o=e.webkitRequestFileSystem,u=e.requestFileSystem||o||e.mozRequestFileSystem,a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f="application/octet-stream",l=0,c=500,h=function(t){var r=function(){typeof t=="string"?n().revokeObjectURL(t):t.remove()};e.chrome?r():setTimeout(r,c)},p=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i=="function")try{i.call(e,n||e)}catch(s){a(s)}}},d=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["﻿",e],{type:e.type}):e},v=function(t,a,c){c||(t=d(t));var v=this,m=t.type,g=!1,y,b,w=function(){p(v,"writestart progress write writeend".split(" "))},E=function(){if(g||!y)y=n().createObjectURL(t);if(b)b.location.href=y;else{var r=e.open(y,"_blank");r==undefined&&typeof safari!="undefined"&&(e.location.href=y)}v.readyState=v.DONE,w(),h(y)},S=function(e){return function(){if(v.readyState!==v.DONE)return e.apply(this,arguments)}},x={create:!0,exclusive:!1},T;v.readyState=v.INIT,a||(a="download");if(i){y=n().createObjectURL(t),r.href=y,r.download=a,setTimeout(function(){s(r),w(),h(y),v.readyState=v.DONE});return}e.chrome&&m&&m!==f&&(T=t.slice||t.webkitSlice,t=T.call(t,0,t.size,f),g=!0),o&&a!=="download"&&(a+=".download");if(m===f||o)b=e;if(!u){E();return}l+=t.size,u(e.TEMPORARY,l,S(function(e){e.root.getDirectory("saved",x,S(function(e){var n=function(){e.getFile(a,x,S(function(e){e.createWriter(S(function(n){n.onwriteend=function(t){b.location.href=e.toURL(),v.readyState=v.DONE,p(v,"writeend",t),h(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&E()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=v["on"+e]}),n.write(t),v.abort=function(){n.abort(),v.readyState=v.DONE},v.readyState=v.WRITING}),E)}),E)};e.getFile(a,{create:!1},S(function(e){e.remove(),n()}),S(function(e){e.code===e.NOT_FOUND_ERR?n():E()}))}),E)}),E)},m=v.prototype,g=function(e,t,n){return new v(e,t,n)};return typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=d(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(m.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,g)}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content);typeof module!="undefined"&&module.exports?module.exports.saveAs=saveAs:typeof define!="undefined"&&define!==null&&define.amd!=null&&define("FileSaver",[],function(){return saveAs}),function(e){"use strict";e.URL=e.URL||e.webkitURL;if(e.Blob&&e.URL)try{new Blob;return}catch(t){}var n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},r=function(t,n,r){this.data=t,this.size=t.length,this.type=n,this.encoding=r},i=n.prototype,s=r.prototype,o=e.FileReaderSync,u=function(e){this.code=this[this.name=e]},a="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),f=a.length,l=e.URL||e.webkitURL||e,c=l.createObjectURL,h=l.revokeObjectURL,p=l,d=e.btoa,v=e.atob,m=e.ArrayBuffer,g=e.Uint8Array,y=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;r.fake=s.fake=!0;while(f--)u.prototype[a[f]]=f+1;return l.createObjectURL||(p=e.URL=function(e){var t=document.createElementNS("http://www.w3.org/1999/xhtml","a"),n;return t.href=e,"origin"in t||(t.protocol.toLowerCase()==="data:"?t.origin=null:(n=e.match(y),t.origin=n&&n[1])),t}),p.createObjectURL=function(e){var t=e.type,n;t===null&&(t="application/octet-stream");if(e instanceof r)return n="data:"+t,e.encoding==="base64"?n+";base64,"+e.data:e.encoding==="URI"?n+","+decodeURIComponent(e.data):d?n+";base64,"+d(e.data):n+","+encodeURIComponent(e.data);if(c)return c.call(l,e)},p.revokeObjectURL=function(e){e.substring(0,5)!=="data:"&&h&&h.call(l,e)},i.append=function(e){var n=this.data;if(g&&(e instanceof m||e instanceof g)){var i="",s=new g(e),a=0,f=s.length;for(;a<f;a++)i+=String.fromCharCode(s[a]);n.push(i)}else if(t(e)==="Blob"||t(e)==="File"){if(!o)throw new u("NOT_READABLE_ERR");var l=new o;n.push(l.readAsBinaryString(e))}else e instanceof r?e.encoding==="base64"&&v?n.push(v(e.data)):e.encoding==="URI"?n.push(decodeURIComponent(e.data)):e.encoding==="raw"&&n.push(e.data):(typeof e!="string"&&(e+=""),n.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new r(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},s.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new r(this.data.slice(e,i>1?t:this.data.length),n,this.encoding)},s.toString=function(){return"[object Blob]"},s.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,t){var r=t?t.type||"":"",i=new n;if(e)for(var s=0,o=e.length;s<o;s++)Uint8Array&&e[s]instanceof Uint8Array?i.append(e[s].buffer):i.append(e[s]);var u=i.getBlob(r);return!u.slice&&u.webkitSlice&&(u.slice=u.webkitSlice),u};var r=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=r(new e.Blob)}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content||this),define("Blob",function(){}),define("Common/AnalysisData/Tables/download/TableDataDownloadController",["marionette","config","FileSaver","Blob"],function(e,t){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:table:initialize-save-as",this.initializeSaveAs,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeSaveAs:function(e,t){var n=this;this.listenTo(t,"download:csv",_.partial(this._onDownloadCsv,e)),t.once("destroy",function(){n.stopListening(t)})},startWithHeader:function(e){var n=[];return n.push("# ExpressionPlot "+t.version),n.push("# Data Generated on "+(new Date).toString()),n.push("# Page: "+e.get("label"),"#"),new Promise(function(e){e(n)})},addParameterValues:function(e,t){var n=this;return new Promise(function(r){e.getActive().take(1).map(_.bind(n._mapActiveToValues,n)).onValue(function(e){r(t.concat(e).concat(["#"]))})})},_mapActiveToValues:function(e){return _.reduce(e,function(e,t,n){if(!t.isComplex()){var r=t.get("readable")||t.get("value");e.push("# Parameter "+t.get("label")+": "+r)}return e},[])},addInfoAboutSelectedRows:function(e,t){var n=_.size(e.get("selected"));return n?t.concat(["# Filtered "+n+" points based on user-selected region"]):t},addInfoAboutFilters:function(e,t){return t.concat(e.filtersCollection.reduce(function(e,t){return t.has("value")&&e.push("# Filter: "+t.toReadableFormat()),e},[])).concat(["#"])},addColumnLabels:function(e,t){return t.concat([e.metaCollection.pluck("label").join(",")])},addTableData:function(e,t){var n=this;return e.getActiveRows().then(function(e){return t.concat(n.transformDataToCsv(n.mapRowsToData(e)))})},transformDataToCsv:function(e){var t=[],n=document.createElement("div");return _.each(e,function(e){var r="";_.each(e,function(e){var t=$(n).html(String(e)).text();r+=',"'+t+'"'}),t.push(r.substring(1))}),t},mapRowsToData:function(e){return _.map(e.rows,function(e){return e.data})},transformTextToBlob:function(e){return new Blob([e.join("\n")],{type:"text/csv"})},_onDownloadCsv:function(e,t){var n=this;t.view.ui.downloadCsvBtn.prop("disabled",!0).parent().addClass("disabled"),this.startWithHeader(e.pageModel).then(_.bind(this.addParameterValues,this,e.pageModel.parameters)).then(_.bind(this.addInfoAboutSelectedRows,this,e)).then(_.bind(this.addInfoAboutFilters,this,e)).then(_.bind(this.addColumnLabels,this,e)).then(_.bind(this.addTableData,this,e)).then(function(r){var i=n.transformTextToBlob(r);t.view.ui.downloadCsvBtn.prop("disabled",!1).parent().removeClass("disabled"),saveAs(i,e.pageModel.get("label")+".csv")})}})}),define("Common/AnalysisData/Tables/Thead/show/compositeview/TheadItemView",["marionette","bacon","bootstrap","velocity.ui","bacon.jquery"],function(e,t){return e.CompositeView.extend({template:"#ep-analysis-thead-item-tmpl",tagName:"th",getChildView:function(){return this.getReqRes().request("analysis-data:views:table:filter:class")},childViewContainer:"[data-filters-region]",ui:{labelBox:".ep-th-label",label:".ep-visible-label",extLabel:".ep-ext-label",wrapper:".ep-th",filterBtn:"[data-filter-action]",sortBtn:"[data-sort-action]"},triggers:{},events:{"click @ui.sortBtn":"_onClickSortBtn"},modelEvents:{"change:sortOrder":"_onModelChangeSortOrder"},onRender:function(){},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},_getPopoverPlacement:function(){var e=this.model.collection.indexOf(this.model),t=this.model.collection.size();return e===0?"right":e===t-1?"left":"bottom"},showFilters:function(){this.hideFilters();var e=this.model.get("label");this.ui.filterBtn.popover({html:!0,trigger:"manual",title:"'"+e+"' values",placement:this._getPopoverPlacement(),content:this.children.pluck("$el"),container:this.$el}).popover("show"),this.children.findByIndex(0).focus()},hideFilters:function(){this.ui.filterBtn.data("popover")&&this.ui.filterBtn.popover("destroy")},toggleFilters:function(){this.ui.filterBtn.data("popover")?this.hideFilters():this.showFilters()},showExtLabel:function(){this.ui.extLabel.width()>this.ui.labelBox.width()&&this.ui.extLabel.css("visibility","visible").addClass("label")},hideExtLabel:function(){this.ui.extLabel.css("visibility","hidden")},toggleExtLabel:function(e){e?this.showExtLabel():this.hideExtLabel()},showSummary:function(t){var n=_.keys(t),r=$("<div></div>");n=_.map(n,function(e){return r.html(e).text()}),t=_.object(n,_.values(t));var i=e.TemplateCache.get("#ep-analysis-thead-summary-tmpl"),s=i({items:t}),o=this.model.get("description")||this.model.get("label");this.ui.labelBox.popover({html:!0,title:o,placement:this._getPopoverPlacement(),content:s,trigger:"manual",container:this.$el}).popover("show")},hideSummary:function(){this.ui.labelBox.data("popover")&&this.ui.labelBox.popover("destroy")},toggleSummary:function(e){e?this.showSummary(e):this.hideSummary()},_onClickSortBtn:function(e){var t=this.model.get("sortOrder");t?this.model.set("sortOrder",t==="asc"?"desc":"asc"):this.model.set("sortOrder","asc")},_onModelChangeSortOrder:function(e,t,n){n.unset?this.ui.sortBtn.velocity({opacity:.7}):(this.ui.sortBtn.velocity({opacity:1}),this.ui.sortBtn.removeClass("icon-arrow-up icon-arrow-down").addClass(t==="desc"?"icon-arrow-down":"icon-arrow-up"))}})}),function(e){define("jquery-resizable-columns",["jquery"],function(){return function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;!function(n,r){var i,s,o,u;return s=function(e){return parseFloat(e.style.width.replace("%",""))},u=function(e,t){return t=t.toFixed(2),e.style.width=""+t+"%"},o=function(e){return 0===e.type.indexOf("touch")?(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]).pageX:e.pageX},i=function(){function t(t,i){this.pointerdown=e(this.pointerdown,this),this.constrainWidth=e(this.constrainWidth,this),this.options=n.extend({},this.defaults,i),this.$table=t,this.setHeaders(),this.restoreColumnWidths(),this.syncHandleWidths(),n(r).on("resize.rc",function(e){return function(){return e.syncHandleWidths()}}(this)),this.options.start&&this.$table.bind("column:resize:start.rc",this.options.start),this.options.resize&&this.$table.bind("column:resize.rc",this.options.resize),this.options.stop&&this.$table.bind("column:resize:stop.rc",this.options.stop)}return t.prototype.defaults={selector:"tr th:visible",store:r.store,syncHandlers:!0,resizeFromBody:!0,maxWidth:null,minWidth:null},t.prototype.triggerEvent=function(e,t,r){var i;return i=n.Event(e),i.originalEvent=n.extend({},r),this.$table.trigger(i,[this].concat(t||[]))},t.prototype.getColumnId=function(e){return this.$table.data("resizable-columns-id")+"-"+e.data("resizable-column-id")},t.prototype.setHeaders=function(){return this.$tableHeaders=this.$table.find(this.options.selector),this.assignPercentageWidths(),this.createHandles()},t.prototype.destroy=function(){return this.$handleContainer.remove(),this.$table.removeData("resizableColumns"),this.$table.add(r).off(".rc")},t.prototype.assignPercentageWidths=function(){return this.$tableHeaders.each(function(e){return function(t,r){var i;return i=n(r),u(i[0],i.outerWidth()/e.$table.width()*100)}}(this))},t.prototype.createHandles=function(){var e;return null!=(e=this.$handleContainer)&&e.remove(),this.$table.before(this.$handleContainer=n("<div class='rc-handle-container' />")),this.$tableHeaders.each(function(e){return function(t,r){var i;if(0!==e.$tableHeaders.eq(t+1).length&&null==e.$tableHeaders.eq(t).attr("data-noresize")&&null==e.$tableHeaders.eq(t+1).attr("data-noresize"))return i=n("<div class='rc-handle' />"),i.data("th",n(r)),i.appendTo(e.$handleContainer)}}(this)),this.$handleContainer.on("mousedown touchstart",".rc-handle",this.pointerdown)},t.prototype.syncHandleWidths=function(){return this.$handleContainer.width(this.$table.width()).find(".rc-handle").each(function(e){return function(t,r){var i;return i=n(r),i.css({left:i.data("th").outerWidth()+(i.data("th").offset().left-e.$handleContainer.offset().left),height:e.options.resizeFromBody?e.$table.height():e.$table.find("thead").height()})}}(this))},t.prototype.saveColumnWidths=function(){return this.$tableHeaders.each(function(e){return function(t,r){var i;return i=n(r),null==i.attr("data-noresize")&&null!=e.options.store?e.options.store.set(e.getColumnId(i),s(i[0])):void 0}}(this))},t.prototype.restoreColumnWidths=function(){return this.$tableHeaders.each(function(e){return function(t,r){var i,s;return i=n(r),null!=e.options.store&&(s=e.options.store.get(e.getColumnId(i)))?u(i[0],s):void 0}}(this))},t.prototype.totalColumnWidths=function(){var e;return e=0,this.$tableHeaders.each(function(){return function(t,r){return e+=parseFloat(n(r)[0].style.width.replace("%",""))}}(this)),e},t.prototype.constrainWidth=function(e){return null!=this.options.minWidth&&(e=Math.max(this.options.minWidth,e)),null!=this.options.maxWidth&&(e=Math.min(this.options.maxWidth,e)),e},t.prototype.pointerdown=function(e){var t,r,i,l,c,h,p;return e.preventDefault(),i=n(e.currentTarget.ownerDocument),h=o(e),t=n(e.currentTarget),r=t.data("th"),l=this.$tableHeaders.eq(this.$tableHeaders.index(r)+1),p={left:s(r[0]),right:s(l[0])},c={left:p.left,right:p.right},this.$handleContainer.add(this.$table).addClass("rc-table-resizing"),r.add(l).add(t).addClass("rc-column-resizing"),this.triggerEvent("column:resize:start",[r,l,c.left,c.right],e),i.on("mousemove.rc touchmove.rc",function(e){return function(t){var n;return n=(o(t)-h)/e.$table.width()*100,u(r[0],c.left=e.constrainWidth(p.left+n)),u(l[0],c.right=e.constrainWidth(p.right-n)),null!=e.options.syncHandlers&&e.syncHandleWidths(),e.triggerEvent("column:resize",[r,l,c.left,c.right],t)}}(this)),i.one("mouseup touchend",function(n){return function(){return i.off("mousemove.rc touchmove.rc"),n.$handleContainer.add(n.$table).removeClass("rc-table-resizing"),r.add(l).add(t).removeClass("rc-column-resizing"),n.syncHandleWidths(),n.saveColumnWidths(),n.triggerEvent("column:resize:stop",[r,l,c.left,c.right],e)}}(this))},t}(),n.fn.extend({resizableColumns:function(){var e,r;return r=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],this.each(function(){var t,s;return t=n(this),s=t.data("resizableColumns"),s||t.data("resizableColumns",s=new i(t,r)),"string"==typeof r?s[r].apply(s,e):void 0})}})}(window.jQuery,window)}.apply(e,arguments)})}(this),define("Common/AnalysisData/Tables/Thead/show/compositeview/TheadView",["marionette","bacon","./TheadItemView","bootstrap","jquery-resizable-columns"],function(e,t,n){return e.CompositeView.extend({template:"#ep-analysis-thead-tmpl",tagName:"table",className:"ep-analysis-thead table-bordered",triggers:{"column:resize:stop":"resize:column"},childView:n,childViewContainer:"tr",childViewOptions:function(e,t){return{collection:e.filtersCollection}},initialize:function(){},onBeforeDestroy:function(){this.$el.resizableColumns("destroy")},adjustWidth:function(){var e=this.$el.parent().width()-15,t=this.collection.size()*70;this.$el.width(Math.max(e,t))},getWidth:function(){return this.$el.width()},enableResizableColumns:function(){this.$el.resizableColumns()},syncHandleWidths:function(){this.$el.resizableColumns("syncHandleWidths")},getColumnWidths:function(){return _.map(this.$("th").toArray(),function(e){return e.style.width})}})}),define("Common/AnalysisData/Tables/Thead/show/TheadShowController",["marionette","./compositeview/TheadView","bacon","bacon.jquery"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:table:thead",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e){var n=this,r=new t({model:e.model,collection:e.model.metaCollection,tableView:e});return this.listenTo(r,"childview:render",_.partial(this._onChildViewRender,e.model)),r.once("destroy",function(){n.stopListening(r)}),r},initializeSummaryProp:function(e,t){var n=t.ui.labelBox.mouseenterE(),r=t.ui.labelBox.mouseleaveE(),i=n.map(!0).merge(r.map(!1)).toProperty(!1);i.takeUntil(t.getDestroyES()).flatMapLatest(this,"_mapToSummary",e,t.model).onValue(t,"toggleSummary")},_mapToSummary:function(e,t,r){return r?n.fromNodeCallback(e,"getSummary",t.get("idx")).map(".summary"):!1},initializeExtLabelProp:function(e){var t=e.ui.labelBox.mouseenterE(),n=e.ui.labelBox.mouseleaveE(),r=t.map(!0).merge(n.map(!1)).toProperty(!1);r.takeUntil(e.getDestroyES()).onValue(e,"toggleExtLabel")},initializeFiltersProp:function(e){var t=e.ui.filterBtn.clickE(),n=e.ui.filterBtn.mouseenterE(),r=e.ui.filterBtn.mouseleaveE(),i=e.$el.mouseenterE(".popover"),s=e.$el.mouseleaveE(".popover"),o=n.map(!0).merge(r.map(!1)).merge(i.map(!0)).merge(s.map(!1)).toProperty(!1);t.takeUntil(e.getDestroyES()).onValue(e,"toggleFilters"),r.debounce(500).filter(o.not()).takeUntil(e.getDestroyES()).onValue(e,"hideFilters"),s.takeUntil(e.getDestroyES()).onValue(e,"hideFilters")},_onChildViewRender:function(e,t){var n=this;this.initializeFiltersProp(t),this.initializeExtLabelProp(t),this.initializeSummaryProp(e,t),t.collection.each(function(r){this.listenTo(r,"filter:complete",_.partial(this._onFilterModelComplete,t,e)),t.once("destroy",function(){n.stopListening(r)})},this)},_onFilterModelComplete:function(e,t,n){n.has("value")?(e.ui.label.addClass("label label-info"),e.ui.extLabel.addClass("label label-info"),e.ui.filterBtn.velocity({opacity:1})):t.anyColumnFilterHasValue(n.get("idx"))||(e.ui.label.removeClass("label label-info"),e.ui.extLabel.removeClass("label label-info"),e.ui.filterBtn.velocity({opacity:.7}))}})}),define("Common/AnalysisData/Tables/Thead/thead-app",["marionette","app","./show/TheadShowController"],function(e,t,n){var r=t.module("Common.AnalysisData.Tables.Thead"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("Common/AnalysisData/Tables/Tbody/show/itemview/TbodyView",["marionette","bacon.jquery","polyfills/requestAnimationFrame"],function(e,t){return e.ItemView.extend({template:"#ep-analysis-tbody-tmpl",className:"ep-analysis-tbody",ui:{chunks:"[data-chunk-region]"},events:{"mouseenter td":"_onMouseenterTd","mouseleave td":"_onMouseleaveTd","mouseenter tr":"_onMouseenterTr","mouseleave tr":"_onMouseleaveTr","click tr":"_onClickTr"},modelEvents:{"filter:complete":"_onModelFilterComplete","sort:complete":"_onModelSortComplete","change:newlySelected":"_onModelChangeNewlySelectedRows"},initialize:function(){this.chunkTable=[]},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},showExtLabel:function(e){var t=e.find(".ep-ext-label");t.width()>e.width()&&t.css("visibility","visible").addClass("label")},hideExtLabel:function(e){var t=e.find(".ep-ext-label");t.css("visibility","hidden")},showSelectedRows:function(e){var t=e||this.$el;t.find("tr").removeClass("success"),_.each(this.model.get("selected"),function(e){$("#"+e+"-row").addClass("success")},this)},removeChunks:function(){this.chunkTable=[],this.ui.chunks.empty(),this.$el.scrollTop(0)},renderChunk:function(t,n){var r=e.TemplateCache.get("#ep-analysis-table-chunk-tmpl"),i=$(r({items:n,meta:this.model.metaCollection.toArray()}));return i.css("top",t*this.model.get("perChunk")*this.rowHeight),this.ui.chunks.append(i),this.chunkTable[t]=i,this.adjustChunkColumnWidth(t),this.showSelectedRows(i),i},renderFirstChunk:function(e){this.renderChunk(0,e),this.cacheHeight(e),this.adjustHeight(e),this.triggerMethod("render:first-chunk")},adjustChunkColumnWidth:function(e){var t=_.isUndefined(e)?this.chunkTable:[this.chunkTable[e]],n=this.getOption("tableView").getTheadColumnWidths();_.each(t,function(e){if(!e)return;e.children("thead").find("th").each(function(e){$(this).css("width",n[e])})})},adjustWidth:function(){var e=this.getOption("tableView").getTheadWidth();this.$el.width(e+15)},adjustHeight:function(e){this.ui.chunks.height(Math.ceil(this.model.get("currentSize")*this.rowHeight)),this.$el.height(Math.ceil(e.length*this.rowHeight))},cacheHeight:function(e){this.chunkHeight=this.chunkTable[0].outerHeight(),this.rowHeight=this.chunkHeight/e.length},getWidth:function(){return this.ui.chunks.width()},_onMouseenterTd:function(e){var t=$(e.currentTarget);this.showExtLabel(t)},_onMouseleaveTd:function(e){var t=$(e.currentTarget);this.hideExtLabel(t)},_onMouseenterTr:function(e){var t=$(e.currentTarget);this.trigger("mouseenter:tr",t.prop("id").replace("-row",""))},_onMouseleaveTr:function(e){var t=$(e.currentTarget);this.trigger("mouseleave:tr",t.prop("id").replace("-row",""))},_onClickTr:function(e){var t=$(e.currentTarget);this.model.setSelectedRows([t.prop("id").replace("-row","")],e.shiftKey)},_onModelChangeNewlySelectedRows:function(){this.showSelectedRows()},_onModelFilterComplete:function(e,t){this.removeChunks(),this.renderChunk(0,e),this.adjustHeight(e)},_onModelSortComplete:function(e){this.removeChunks(),this.renderChunk(0,e)}})}),define("Common/AnalysisData/Tables/Tbody/show/TbodyShowController",["marionette","./itemview/TbodyView","bacon","bacon.jquery"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:table:tbody",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e){var n=new t({model:e.model,tableView:e});return this.initializeScrolling(n),this.listenToOnce(n,"show",this._onShow),n},initializeScrolling:function(e){e.$el.asEventStream("scroll").takeUntil(e.getDestroyES()).debounce(300).flatMapLatest(this,"_mapScrollToChunkIds",e).flatMap(this,"_mapToDataChunk",e).onValue(this,"_renderChunk",!1,e)},_mapScrollToChunkIds:function(e){var t=e.$el.scrollTop(),r=parseInt(t/e.chunkHeight);return n.fromArray(this.getUnrenderedChunkIds(e,r))},_mapToDataChunk:function(e,t){return n.fromNodeCallback(e.model,"getDataChunk",e.model.get("perChunk"),t).map(function(e){return{chunkId:t,chunk:e.chunk}})},getUnrenderedChunkIds:function(e,t){var n=[];return typeof e.chunkTable[t]=="undefined"&&n.push(t),t-1>-1&&typeof e.chunkTable[t-1]=="undefined"&&n.push(t-1),typeof e.chunkTable[t+1]=="undefined"&&n.push(t+1),n},_onShow:function(e){this._mapToDataChunk(e,0).onValue(this,"_renderChunk",!0,e)},_renderChunk:function(e,t,n){e?t.renderFirstChunk(n.chunk):t.renderChunk(n.chunkId,n.chunk)}})}),define("Common/AnalysisData/Tables/Tbody/tbody-app",["marionette","app","./show/TbodyShowController"],function(e,t,n){var r=t.module("Common.AnalysisData.Tables.Tbody"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("Common/AnalysisData/Tables/tables-app",["marionette","app","./show/TablesShowController","./download/TableDataDownloadController","./Thead/thead-app","./Tbody/tbody-app"],function(e,t,n,r){var i=t.module("Common.AnalysisData.Tables"),s=Backbone.Wreqr.radio.channel("global").reqres;return i.on("start",function(){this.showC=new n,this.downloadC=new r}),i}),define("Common/AnalysisData/Plots/show/itemview/ProgressBarView",["marionette","bootstrap","velocity.ui"],function(e){return e.ItemView.extend({template:"#ep-progressbar-tmpl",className:"progress",ui:{bar:".bar"},onAttach:function(){this.ui.bar.css("transitionDuration",this.getOption("duration")+"ms"),this.ui.bar.width("100%")},setWithError:function(){this.$el.addClass("progress-danger"),this.ui.bar.html($("<p>").addClass("text-center").hide().text("There was an error retrieving the plot.")),$.Velocity.animate(this.$("p"),"transition.slideDownIn",{delay:200})}})}),define("Common/AnalysisData/Plots/show/layoutview/PlotView",["marionette","bootstrap"],function(e){return e.LayoutView.extend({template:"#ep-analysis-plot-tmpl",ui:{main:"[data-main]"},regions:{plot:"[data-plot-region]",menu:"[data-menu-region]",sidebar:"[data-sidebar-region]",table:"[data-table-region]"},onDestroy:function(){$(document).off("."+this.cid)},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)}})}),define("Common/AnalysisData/Plots/show/PlotsShowController",["marionette","Common/AnalysisData/Tables/models/TableDataModel","./itemview/ProgressBarView","./layoutview/PlotView","velocity.ui"],function(e,t,n,r){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:plot",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e,n){var i,s=this;n=n||{},n.tableDataModel?i=n.tableDataModel:i=new t({perChunk:n.pageModel.get("tableRows"),plotFile:e.value.plot,warnings:e.warnings},{pageModel:n.pageModel,analysis:e.value.table});var o=new r({model:i,sidebarVisible:n.pageModel.get("sidebarVisible"),tableVisible:n.pageModel.get("tableVisible"),pageLabel:n.pageModel.get("label")});return this.listenToOnce(o,"render",this._onViewRender),o.once("destroy",function(){n.tableDataModel||i.stopListening(),s.stopListening(o)}),o},_onViewRender:function(e){var t=this.getReqRes().request("analysis-data:models:plot:settings",e);e.getOption("tableVisible")&&this.renderTableView(e),this.renderSvgView(e,t),e.getOption("sidebarVisible")?this.renderSidebarView(e,t):e.ui.main.removeClass("span7").addClass("span12")},renderTableView:function(e){var t=this.getReqRes().request("analysis-data:views:table",null,{tableDataModel:e.model});t.on("tbody:mouseenter:tr",function(t){e.triggerMethod("emphasize:point",t)}),t.on("tbody:mouseleave:tr",function(t){e.triggerMethod("deemphasize:point",t)}),e.getRegion("table").show(t)},renderMenuView:function(e,t){var n=this.getReqRes().request("analysis-data:views:plot:menu",e,t);return e.getRegion("menu").show(n),n.$el.velocity("transition.fadeIn"),n},renderSvgView:function(e,t){var r=this,i=this.getReqRes().request("analysis-data:views:plot:svg",e,t);e.getRegion("plot").show(new n({duration:e.model.localModel.get("plotFetchMeanTime")})),i.then(function(n){e.getRegion("plot").show(n),t.setDimensions(n.originalWidth,n.originalHeight);var i=r.renderMenuView(e,t);r.getCommands().execute("analysis-data:views:plot:svg:initialize-save-as",n,i)}).catch(function(t){e.getChildView("plot").setWithError()})},renderSidebarView:function(e,t){var n=this.getReqRes().request("analysis-data:views:plot:sidebar",e,t);e.getRegion("sidebar").show(n)}})}),define("Common/AnalysisData/Plots/models/SettingsModel",["backbone"],function(e){return e.Model.extend({defaults:{zoomScale:1,zoomTranslateX:0,zoomTranslateY:0},setDimensions:function(e,t){this.set({width:e,height:t})},isFullscreen:function(){return this.get("fullscreenMode")}})}),define("polyfills/fullscreen.api",[],function(){return{requestFullscreen:function(e){var t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen;t&&t.call(e)},cancelFullscreen:function(){var e=document.cancelFullscreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msCancelFullscreen;e&&e.call(document)},fullscreenElement:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement}}}),define("Common/AnalysisData/Plots/SettingsModelController",["marionette","./models/SettingsModel","polyfills/fullscreen.api"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:models:plot:settings",this.getModel,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getModel:function(e){var n=this,r=new t({tagFieldIdx:0,tagCloudVisible:!1,fullscreenMode:!1,zoomScale:1,zoomTranslateX:0,zoomTranslateY:0,interactionMode:"zoom"});return this.listenTo(r,"change:fullscreenMode",_.partial(this._onChangeFullscreenMode,e)),e.once("destroy",function(){n.stopListening(r),r.stopListening()}),$(document).on("mozfullscreenchange."+e.cid+" webkitfullscreenchange."+e.cid,_.bind(this.onDocumentFullscreenChange,this,r)),r},onDocumentFullscreenChange:function(e){e.set("fullscreenMode",n.fullscreenElement())},_onChangeFullscreenMode:function(e,t,r){r?n.requestFullscreen(e.ui.main[0]):n.cancelFullscreen()}})}),define("Common/AnalysisData/Plots/SideMenu/show/itemview/SideMenuView",["marionette","bacon","bacon.model","bootstrap"],function(e,t){return e.ItemView.extend({template:"#ep-analysis-plot-menu-tmpl",className:"btn-toolbar",ui:{fullscreenBtn:"[data-go-fullscreen]",fullscreenDesc:"[data-go-fullscreen-desc]",tagModeBtn:"[data-tag-mode]",tagModeDesc:"[data-tag-mode-desc]",panModeBtn:"[data-pan-mode]",panModeDesc:"[data-pan-mode-desc]",zoomInBtn:"[data-zoom-in]",zoomInDesc:"[data-zoom-in-desc]",zoomOutBtn:"[data-zoom-out]",zoomOutDesc:"[data-zoom-out-desc]",resetBtn:"[data-reset]",resetDesc:"[data-reset-desc]",downloadMenuBtn:"[data-download]",downloadMenuDesc:"[data-download-desc]",downloadCsvBtn:"[data-download-csv]",downloadPngBtn:"[data-download-png]",downloadSvgBtn:"[data-download-svg]"},triggers:{"click @ui.downloadCsvBtn":"download:csv","click @ui.downloadPngBtn":"download:png","click @ui.downloadSvgBtn":"download:svg"},events:{"click @ui.fullscreenBtn":"_onClickFullscreenBtn","click @ui.tagModeBtn":"_onClickTagModeBtn","click @ui.panModeBtn":"_onClickPanModeBtn","click @ui.zoomInBtn":"_onClickZoomInBtn","click @ui.zoomOutBtn":"_onClickZoomOutBtn","click @ui.resetBtn":"_onClickResetBtn"},modelEvents:{"change:fullscreenMode":"_onModelChangeFullscreenMode","change:interactionMode":"_onModelChangeInteractionMode"},initialize:function(e){},onShow:function(){this.attachButtonPopover(this.ui.fullscreenBtn,this.ui.fullscreenDesc.text()),this.attachButtonPopover(this.ui.zoomInBtn,this.ui.zoomInDesc.text()),this.attachButtonPopover(this.ui.zoomOutBtn,this.ui.zoomOutDesc.text()),this.attachButtonPopover(this.ui.resetBtn,this.ui.resetDesc.text()),this.attachButtonPopover(this.ui.downloadMenuBtn,this.ui.downloadMenuDesc.text()),this.attachComplexPopover("panMode"),this.attachComplexPopover("tagMode"),this.ui.downloadMenuBtn.dropdown(),this.model.get("interactionMode")==="zoom"?this.ui.panModeBtn.addClass("active"):this.ui.tagModeBtn.addClass("active")},getDestroyES:function(){return this.asEventStream("destroy").take(1)},_onClickFullscreenBtn:function(e){e.preventDefault(),this.model.set("fullscreenMode",!this.model.get("fullscreenMode"))},_onClickTagModeBtn:function(e){this.model.set("interactionMode","tag")},_onClickPanModeBtn:function(e){this.model.set("interactionMode","zoom")},_onClickZoomInBtn:function(){this.model.trigger("zoom:in")},_onClickZoomOutBtn:function(){this.model.trigger("zoom:out")},_onClickResetBtn:function(){this.model.trigger("reset:zoom")},_onModelChangeFullscreenMode:function(e,t){this.ui.fullscreenBtn[t?"addClass":"removeClass"]("active")},_onModelChangeInteractionMode:function(e,t){t==="zoom"?(this.ui.panModeBtn.addClass("active"),this.ui.tagModeBtn.removeClass("active"),this.tagModePopoverModel.set({hide:0}),this.panModePopoverModel.set({show:0,hide:2e3,content:"You are in Pan Mode."})):(this.ui.panModeBtn.removeClass("active"),this.ui.tagModeBtn.addClass("active"),this.panModePopoverModel.set({hide:0}),this.tagModePopoverModel.set({show:0,hide:2e3,content:"You are in Tag Mode."}))},attachButtonPopover:function(e,t,n){e.popover({delay:{show:500,hide:0},trigger:n?n:"hover",content:t,placement:"left",html:!1,container:this.$el.parent().parent()})},attachComplexPopover:function(e){var n=this.ui[e+"Btn"],r=this.ui[e+"Desc"];this[e+"PopoverModel"]=t.Model();var i=n.mouseenterE(),s=n.mouseleaveE(),o=i.map({show:500,content:r.html()}),u=s.map({hide:0});this[e+"PopoverModel"].addSource(o),this[e+"PopoverModel"].addSource(u),this[e+"PopoverModel"].takeUntil(this.getDestroyES()).flatMapLatest(this,"_mapToShowPopover").doAction(this,"_showComplexPopover",n).flatMapLatest(this,"_mapToHidePopover").onValue(this,"_hideComplexPopover",n)},_mapToShowPopover:function(e){return e.content?t.later(e.show,e):e},_mapToHidePopover:function(e){return _.isUndefined(e.hide)?e:t.later(e.hide,e)},_showComplexPopover:function(e,t){_.isUndefined(t.show)||e.popover("destroy").popover({trigger:"manual",content:t.content,placement:"left",html:!0,container:this.$el.parent().parent()}).popover("show")},_hideComplexPopover:function(e,t){_.isUndefined(t.hide)||e.popover("destroy")},enableButtons:function(){this.$("button, a").prop("disabled",!1),this.$(".dropdown-menu li").removeClass("disabled")}})}),define("Common/AnalysisData/Plots/SideMenu/show/MenuShowController",["marionette","./itemview/SideMenuView"],function(e,t){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:plot:menu",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e,n){var r=new t({model:n});return this.getCommands().execute("analysis-data:table:initialize-save-as",e.model,r),r},_onViewRender:function(e){}})}),define("Common/AnalysisData/Plots/SideMenu/menu-app",["marionette","app","./show/MenuShowController"],function(e,t,n){var r=t.module("Common.AnalysisData.Plots.Menu"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("requirejs-text!Common/AnalysisData/Plots/Svg/show/itemview/svg.css",[],function(){return"svg .plot-point {\n  stroke: none;\n}\nsvg .plot-point.selected {\n  stroke: black;\n  stroke-width: 2px;\n  stroke-dasharray: 2,2;\n}\nsvg .plot-point.filtered-out {\n  display: none;\n}\nsvg .brush .extent {\n  fill-opacity: .1;\n  stroke: #fff;\n  shape-rendering: crispEdges;\n}\nsvg .ep-tag-cloud .ep-tag-link {\n  stroke: #2F96B4;\n}\nsvg .ep-tag-cloud .ep-tag text {\n  font-size: 10px;\n  cursor: move;\n}\n"}),define("Common/AnalysisData/Plots/Svg/show/itemview/SvgView",["marionette","d3","bacon","requirejs-text!./svg.css","backbone.eventstreams","polyfills/requestAnimationFrame"],function(e,t,n,r){return e.ItemView.extend({template:!1,ui:{svg:"svg"},modelEvents:{"change:interactionMode":"_onModelChangeInteractionMode","change:tagCloudVisible":"_onModelChangeTagCloudVisible","change:fullscreenMode":"_onModelChangeFullscreenMode"},initialize:function(e){this.storeD3Elements(),this.originalWidth=parseInt(this.d3.svg.attr("width")),this.originalHeight=parseInt(this.d3.svg.attr("height")),this._isWide=this.originalWidth>this.originalHeight+100,this._isHigh=this.originalHeight>this.originalWidth+100,this.initializePoints(),this.initializeStyles(),$(window).on("resize."+this.cid,_.bind(this.onWindowResize,this))},storeD3Elements:function(){this.d3={},this.d3.svg=t.select(this.$el.children("svg").get(0)),this.d3.points=this.d3.svg.selectAll(".plot-point"),this.d3.surface=t.select(this.$el.children("svg").children("g").first().get(0)),this.d3.points.size()&&(this.d3.pointsParent=t.select(this.d3.points.node().parentNode))},onDestroy:function(){$(window).off("resize."+this.cid),$(document).off("."+this.cid)},onShow:function(){this.updateSvgDimensions()},getDestroyES:function(){return this.asEventStream("before:destroy").take(1)},onEmphasizePoint:function(e){this._emphasizePointStroke(e)},onDeemphasizePoint:function(e){this._deemphasizePointStroke(e)},_emphasizePointStroke:function(e){var t=$("#"+e);t.data("stroke",t.css("stroke")),t.data("strokeWidth",t.css("strokeWidth")),t.css("stroke")=="none"&&t.css("stroke",t.css("fill"));var n=parseInt(t.css("strokeWidth"));n=n<1?1:n,t.css("strokeWidth",n*10)},_deemphasizePointStroke:function(e){var t=$("#"+e);t.css("strokeWidth",t.data("strokeWidth")),t.css("stroke",t.data("stroke"))},isWide:function(){return this._isWide},isHigh:function(){return this._isHigh},initializeStyles:function(){this.d3.svg.insert("style","defs").text(r.replace(/svg /g,""))},initializePoints:function(){function o(){var u=e.d3.points.select(function(e,t){return t>=r&&r<s?this:null});u.each(function(n){n.startingPoint=e._extractStartingPoint(t.select(this).attr("d"))}),r=s,s=r+i,r<n&&window.requestAnimationFrame(o)}var e=this,n=this.d3.points.size(),r=0,i=150,s=r+i;this.d3.points.data(_.times(n,function(){return{}})),window.requestAnimationFrame(o)},_extractStartingPoint:function(e){var t=0;return _.filter(e.split(" "),function(e){return t===0&&e==="M"?(t++,!1):t>0&&t<4?(t++,!0):!1})},updatePointsDisplay:function(e){function s(){var o;for(var u=n,a=n+r;u<i[0].length&&u<a;u++)o=i[0][u],_.indexOf(e,o.id)>-1?(t.select(o).classed("filtered-out",!1),o.style.display="block"):(t.select(o).classed("filtered-out",!0),o.style.display="none");n+=r,n<i[0].length&&window.requestAnimationFrame(s)}var n=0,r=150,i=this.d3.points;window.requestAnimationFrame(s)},updateBrushDimensions:function(e,n){this.d3.brushFunction.x(t.scale.identity().domain([0,isNaN(e)?this.width:e])).y(t.scale.identity().domain([0,isNaN(n)?this.height:n]))},getZoomBehaviorTarget:function(){return this.d3.svg},getBrushBehaviorTarget:function(){return this.d3.brush},updateViewBox:function(e,t,n,r){this.d3.svg.attr("viewBox",e+" "+t+" "+n+" "+r)},updateSvgDimensions:function(){this.model.isFullscreen()?(this.height=screen.height,this.width=screen.width):(this.width=this.$el.width(),this.height=this.originalHeight,this.isHigh()&&this.model.get("zoomScale")<1&&(this.height*=this.model.get("zoomScale")),this.height<500&&(this.height=500)),this.d3.svg&&this.d3.svg.attr("width",this.width),this.d3.svg&&this.d3.svg.attr("height",this.height)},updateHeight:function(e){this.height=e,this.d3.svg.attr("height",this.height)},clearTagCloud:function(){this.d3.svg.selectAll(".ep-tag-cloud").remove(),this.model.set("tagCloudVisible",!1)},onBeforeSaveFile:function(){this.getBrushBehaviorTarget().style("display","none")},onAfterSaveFile:function(){this.getBrushBehaviorTarget().style("display","block")},onWindowResize:function(e){this.updateSvgDimensions()},_onModelChangeFullscreenMode:function(){this.updateSvgDimensions()},_onModelChangeInteractionMode:function(e,t){this.d3.brush.style("display",t==="zoom"?"none":"block")},_onModelChangeTagCloudVisible:function(e,t){t||this.d3.svg.selectAll(".ep-tag-cloud").remove()}})}),define("Common/AnalysisData/Plots/Svg/show/SvgShowController",["marionette","./itemview/SvgView","polyfills/fullscreen.api"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:plot:svg",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e,n){var r=this;return e.model.fetchPlot().then(function(i){var s=new t({el:"<div>"+i+"</div>",model:n,regionClass:"plot-point",pageLabel:e.getOption("pageLabel")});return r.initializeShiftKeyPressed(s),r.getCommands().execute("analysis-data:views:plot:initialize-point-details",s,e.model),r.getCommands().execute("analysis-data:views:plot:initialize-zooming",s),r.getCommands().execute("analysis-data:views:plot:initialize-brush",s),r.getCommands().execute("analysis-data:views:plot:initialize-brush-zooming",s),r.getCommands().execute("analysis-data:views:plot:initialize-brush-tagging",s,e.model),e.model.on("filter:complete",function(e,t){s.updatePointsDisplay(t)}),e.on("emphasize:point",function(e){s.triggerMethod("emphasize:point",e)}),e.on("deemphasize:point",function(e){s.triggerMethod("deemphasize:point",e)}),s})},initializeShiftKeyPressed:function(e){e.shiftKeyPressed=$("body").asEventStream("keydown.shifttest").map(".shiftKey").merge($("body").asEventStream("keyup.shifttest").map(".shiftKey")).skipDuplicates().takeUntil(e.getDestroyES()).toProperty(!1)}})}),define("Common/AnalysisData/Plots/Svg/show/PointDetailsShowController",["marionette","bacon"],function(e,t){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:initialize-point-details",this.initializePointDetails,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializePointDetails:function(e,n){var r=this;e.once("destroy",function(){r.stopListening(e)});var i=t.fromEvent(e,"mouse:downed").toProperty(!1),s=e.$el.asEventStream("mouseover.epupdatedetails"),o=s.filter(i.not()).filter(this,"_hasClass",e.getOption("regionClass"));o.takeUntil(e.getDestroyES()).map(".target.id").onValue(e,"triggerMethod","emphasize:point");var u=e.$el.asEventStream("mouseout.epupdatedetails"),a=u.filter(this,"_hasClass",e.getOption("regionClass")),f=o.map(".target.id").merge(u.map(null)).toProperty(null),l=o.delay(200).flatMapLatest(this,"_mapToDetailsResponse",n),c=t.combineWith(_.isEqual,f,l.map(".response.row.id")),h=l.filter(c);h.takeUntil(e.getDestroyES()).onValue(this,"renderPointDetails",e,n),a.takeUntil(e.getDestroyES()).map(".target.id").onValue(e,"triggerMethod","deemphasize:point");var p=e.$el.asEventStream("mouseenter.epupdatedetails",".popover"),d=e.$el.asEventStream("mouseleave.epupdatedetails",".popover"),v=p.map(this,"_pointIdFromPopoverES").merge(d.map(null)).toProperty(null);d.map(this,"_pointIdFromPopoverES").takeUntil(e.getDestroyES()).onValue(this,"hidePointDetails",e);var m=a.delay(500).map(".target.id").toProperty(null),g=t.combineWith(_.bind(this._asIdOrFalse,this),v,m);g.takeUntil(e.getDestroyES()).onValue(this,"hidePointDetails",e)},_asIdOrFalse:function(e,t){return t===e?!1:t},_pointIdFromPopoverES:function(e){return $(e.currentTarget).attr("data-point-id")},_hasClass:function(e,t){var n=t.target;if(!n.className||!n.className.baseVal)return!1;var r=n.className.baseVal;return r&&r.indexOf&&r.indexOf(e)>-1},_mapToDetailsResponse:function(e,n){return t.combineTemplate({response:t.fromNodeCallback(e,"getRow",n.target.id),pageX:n.pageX,pageY:n.pageY})},hidePointDetails:function(e,t){if(!t)return;e.$el.children("[data-point-id="+t+"]").remove()},renderPointDetails:function(t,n,r){var i=this,s=r.response.row.id,o=n.metaCollection.pluck("label"),u=_.map(r.response.row.data,function(e,t){return{label:o[t],value:""+e}}),a=e.TemplateCache.get("#ep-dl-tmpl"),f=a({items:u,horizontal:!0}),l=this._insertStructure(t,f),c=t.$el.offset();l.offset({top:$(window).scrollTop()+r.pageY-c.top,left:$(window).scrollLeft()+r.pageX-c.left+5}),l.attr("data-point-id",s),l.find(".close").attr("data-point-id",s),l.one("click",".close",function(e){i.hidePointDetails(t,s)}),l.show()},_insertStructure:function(t,n){t.$el.children(".popover").remove();var r=e.TemplateCache.get("#ep-popover"),i=$(r({arrow:!1,close:!0,title:"Details",content:n}));return t.$el.append(i),i}})}),define("d3.bacon",["bacon","d3"],function(e,t){return function(n,r,i){return e.fromBinder(function(e){function i(){return e(t.event)}return n.on(r,i),function(){return n.on(r,null)}},i)}}),define("Common/AnalysisData/Plots/Svg/show/d3BrushController",["marionette","d3","d3.bacon"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:initialize-brush",this.initializeBrush,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeBrush:function(e){e.d3.pointsParent?e.d3.brush=e.d3.pointsParent.insert("g",".plot-point"):e.d3.brush=e.d3.surface.append("g"),e.d3.brush.attr("class","brush").style("display","none"),e.d3.brushFunction=t.svg.brush(),e.updateBrushDimensions(e.originalWidth,e.originalHeight);var r=n(e.d3.brushFunction,"brushend.epgeneral");e.shiftKeyPressed.filter(this,"_isZoomMode",e.model).takeUntil(e.getDestroyES()).map(function(e){return e?"block":"none"}).onValue(e.d3.brush,"style","display");var i=n(e.d3.brush,"mousedown.epmousedowned").map(!0).merge(n(e.d3.brush,"mouseup.epmousedowned").map(!1)).toProperty(!1);i.takeUntil(e.getDestroyES()).onValue(e,"trigger","mouse:downed"),n(e.d3.brush,"mousedown.eppreventpanning").takeUntil(e.getDestroyES()).onValue(".stopPropagation"),e.d3.brushFunction(e.d3.brush)},_isZoomMode:function(e){return e.get("interactionMode")==="zoom"}})}),define("Common/AnalysisData/Plots/Svg/show/d3BrushZoomingController",["marionette","d3","d3.bacon"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:initialize-brush-zooming",this.initializeZooming,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeZooming:function(e){var t=n(e.d3.brushFunction,"brushend.epmarqueezoom");t.takeUntil(e.getDestroyES()).filter(this,"_isZoomMode",e.model).onValue(this,"_onBrushend",e)},_isZoomMode:function(e){return e.get("interactionMode")==="zoom"},_onBrushend:function(e,t){this.zoomByExtent(e,t.target.extent()),t.target.clear(),t.target(e.d3.brush)},zoomByExtent:function(e,t){var n=t[0][0],r=t[0][1],i=t[1][0],s=t[1][1],o=Math.abs(i-n),u=Math.abs(s-r);o>10&&u>10&&e.updateViewBox(n,r,o,u)}})}),define("Common/AnalysisData/Plots/Svg/show/d3BrushTaggingController",["marionette","d3","d3.bacon"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:initialize-brush-tagging",this.initializeTagging,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},listenToModel:function(e,t){var n=this;this.listenTo(t,"filter:complete",_.partial(this._onModelFilterComplete,e,t)),this.listenTo(t,"change:newlySelected",_.partial(this._onModelChangeNewlySelected,e)),this.listenTo(e.model,"change:tagFieldIdx",_.partial(this._onModelChangeTagFieldIdx,e,t)),t.once("destroy",function(){n.stopListening(t)}),e.once("destroy",function(){n.stopListening(e.model)})},initializeTagging:function(e,t){this.listenToModel(e,t);var r=n(e.d3.brushFunction,"brushend.epmarqueetag");r.takeUntil(e.getDestroyES()).filter(this,"_isTagMode",e.model).onValue(this,"_onBrushend",e,t);var i=n(e.d3.points,"mousedown.eppointtag").filter(this,"_isTagMode",e.model);i.takeUntil(e.getDestroyES()).map(function(e){return{id:e.target.id,withPrevious:e.shiftKey}}).onValue(this,"selectPoint",t)},_isTagMode:function(e){return e.get("interactionMode")==="tag"},_onBrushend:function(e,t,n){this.selectPointsByExtent(e,t,{extent:n.target.extent(),withPrevious:n.sourceEvent.shiftKey}),n.target.clear(),n.target(e.d3.brush)},selectPoint:function(e,t){e.setSelectedRows([t.id],t.withPrevious)},selectPointsByExtent:function(e,t,n){var r=n.extent,i=[];e.d3.points.each(function(e){!!e.startingPoint&&r[0][0]<=e.startingPoint[0]&&e.startingPoint[0]<r[1][0]&&r[0][1]<=e.startingPoint[1]&&e.startingPoint[1]<r[1][1]&&i.push(this.id)}),t.setSelectedRows(i,n.withPrevious)},_onModelChangeNewlySelected:function(e,t,n){_.isEqual(t.get("selected"),n)&&e.clearTagCloud(),e.model.set("interactionMode","tag"),this.getCommands().execute("analysis-data:views:plot:d3:render-tags",e,t,!1)},_onModelChangeTagFieldIdx:function(e,t,n,r){n.set("tagCloudVisible",!1),this.getCommands().execute("analysis-data:views:plot:d3:render-tags",e,t,!0)},_onModelFilterComplete:function(e,t){e.model.get("tagCloudVisible")&&(e.model.set("tagCloudVisible",!1),this.getCommands().execute("analysis-data:views:plot:d3:render-tags",e,t,!0))}})}),define("Common/AnalysisData/Plots/Svg/show/d3TagsShowController",["marionette","d3","d3.bacon"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:d3:render-tags",this.renderTags,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},renderTags:function(e,t,n){var r=n?t.get("selected"):t.get("newlySelected");if(_.size(r)===0)return;var i=this;t.getActiveRows().then(function(t){var n=i.filterSelected(r,t),s=i.prepareDataForD3NodesLinks(e,n),o=i.prepareForce(e,s);i.renderNodesLinks(e,s,o),e.model.set("tagCloudVisible",!0),e.trigger("plot:tagging:done")})},renderNodesLinks:function(e,r,i){var s=e.d3.surface.append("g").attr("class","ep-tag-cloud"),o=s.selectAll(".ep-tag-link").data(r.links).enter().append("line").attr("class","ep-tag-link").style("stroke",function(){return t.select(this).style("stroke")}),u=i.drag().on("dragstart",function(e){e.fixed=!0}),a=s.selectAll(".ep-tag").data(r.nodes).enter().append("g").attr("class","ep-tag").call(u);n(a,"mousedown.eppreventpanning").takeUntil(e.getDestroyES()).onValue(".stopPropagation"),a.append("text").attr("dy",".35em").text(function(e){return e.tagLabel}),i.on("tick",function(){o.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),a.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}).on("end",function(){a.datum(function(e){return e.fixed=!0,e})})},prepareForce:function(e,n){var r=t.layout.force();return r.nodes(n.nodes).links(n.links).size([e.width,e.height]).friction(.7).gravity(.05).charge(-20).start(),r},prepareDataForD3NodesLinks:function(e,t){var n=[],r=document.createElement("div"),i=e.model.get("tagFieldIdx"),s=null,o,u,a=0,f=0,l=[];return _.each(t,function(t,c){s=e.d3.points.filter("#"+t.id),o=s.datum().startingPoint[0],u=s.datum().startingPoint[1],f=a,n.push({x:o,y:u,fixed:!0,index:f}),n.push({index:++a,x:_.random(o-20,o+20),y:_.random(u-20,u+20),tagLabel:$(r).html(String(t.data[i])).text()}),l.push({source:f,target:a}),a++}),{nodes:n,links:l}},filterSelected:function(e,t){return _.filter(t.rows,function(t){return e&&_.indexOf(e,t.id)>-1})}})}),define("Common/AnalysisData/Plots/Svg/show/d3ZoomingController",["marionette","d3","d3.bacon"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:initialize-zooming",this.initializeZooming,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},listenToModel:function(e,t){var n=this;this.listenTo(e.model,"change",_.partial(this._onModelChange,e,t)),this.listenTo(e.model,"reset:zoom",_.partial(this.resetZoomPan,e,t)),this.listenTo(e.model,"zoom:in",_.partial(this.zoomIn,e,t)),this.listenTo(e.model,"zoom:out",_.partial(this.zoomOut,e,t)),e.once("destroy",function(){n.stopListening(e.model)})},initializeZooming:function(e){var r=e.getZoomBehaviorTarget(),i=t.behavior.zoom().size([e.originalWidth,e.originalHeight]).scaleExtent([.1,8]);this.initializeZoomKeyBindings(e,i),this.listenToModel(e,i);var s=n(i,"zoomstart.epzoom"),o=n(i,"zoom.epzoom"),u=n(i,"zoomend.epzoom");o.takeUntil(e.getDestroyES()).onValue(this,"updateModelFromBehavior",e.model),n(r,"mousedown.epmousedowned").takeUntil(e.getDestroyES()).map(!0).merge(n(r,"mouseup.epmousedowned").map(!1)).onValue(e,"trigger","mouse:downed"),this._setCursorStyle(e,"zoom-in");var a=s.takeUntil(e.getDestroyES()).map(!0).merge(u.map(!1));a.map(function(e){return e?"move":"zoom-in"}).onValue(this,"_setCursorStyle",e),e.shiftKeyPressed.changes().map(function(e){return e?"zoom-out":"zoom-in"}).onValue(this,"_setCursorStyle",e),i(r)},initializeZoomKeyBindings:function(e,t){var n=$("body").asEventStream("keydown.zoomkeybindings").takeUntil(e.getDestroyES()).filter(function(e){return _.indexOf(["input","textarea"],e.target.tagName.toLowerCase())===-1});n.filter(".shiftKey").map(".keyCode").filter(function(e){return e===187||e===61}).onValue(this,"zoomIn",e,t);var r=n.map(".keyCode").filter(function(e){return e===189||e===173});r.onValue(this,"zoomOut",e,t),n.map(".keyCode").filter(function(e){return e===48}).onValue(this,"resetZoomPan",e,t)},_setCursorStyle:function(e,t){e.getZoomBehaviorTarget().style("cursor",t)},_isZoomedIn:function(e){return e.get("zoomScale")>1},_adjustTranslateWhileZooming:function(e,t,n){var r=e.model,i=r.get("zoomTranslateX"),s=r.get("zoomTranslateY"),o=e.originalWidth/2,u=e.originalHeight/2,a=n/r.get("zoomScale");i=o+(i-o)*a,s=u+(s-u)*a,t.translate([i,s])},zoomIn:function(e,t){var n=e.getZoomBehaviorTarget(),r=e.model.get("zoomScale")*1.2;t.scale(r),this._adjustTranslateWhileZooming(e,t,r),t.event(n.transition().duration(350))},zoomOut:function(e,t){var n=e.getZoomBehaviorTarget(),r=e.model.get("zoomScale")*.8;t.scale(r),this._adjustTranslateWhileZooming(e,t,r),t.event(n.transition().duration(350))},resetZoomPan:function(e,t){var n=e.getZoomBehaviorTarget();t.translate([0,0]),t.scale(1),t.event(n.transition().duration(350))},updateModelFromBehavior:function(e,t){e.set({zoomTranslateX:t.translate[0],zoomTranslateY:t.translate[1],zoomScale:t.scale})},_onModelChange:function(e,t,n,r){var i=n.get("zoomScale"),s,o=n.get("zoomTranslateX"),u=n.get("zoomTranslateY");i=parseFloat(i.toFixed(4)),e.isHigh()&&!n.isFullscreen()&&(i>=1?s=e.originalHeight:s=e.originalHeight*i,s>=400&&e.updateHeight(s)),this._applyTransform(e,i,[o,u])},_applyTransform:function(e,t,n){var r="translate("+n+") "+"scale("+t+")";e.d3.surface.attr("transform",r)}})});var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];!function(){function e(){var e={};return e.FRAMERATE=30,e.MAX_VIRTUAL_PIXELS=3e4,e.init=function(t){var n=0;e.UniqueId=function(){return n++,"canvg"+n},e.Definitions={},e.Styles={},e.Animations=[],e.Images=[],e.ctx=t,e.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},e.init(),e.ImagesLoaded=function(){for(var t=0;t<e.Images.length;t++)if(!e.Images[t].loaded)return!1;return!0},e.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},e.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},e.ajax=function(e){var t;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t?(t.open("GET",e,!1),t.send(null),t.responseText):null},e.parseXml=function(e){if(window.DOMParser){var t=new DOMParser;return t.parseFromString(e,"text/xml")}e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var n=new ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(e),n},e.Property=function(e,t){this.name=e,this.value=t},e.Property.prototype.getValue=function(){return this.value},e.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},e.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},e.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},e.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},e.Property.prototype.addOpacity=function(t){var n=this.value;if(null!=t&&""!=t&&"string"==typeof this.value){var r=new RGBColor(this.value);r.ok&&(n="rgba("+r.r+", "+r.g+", "+r.b+", "+t+")")}return new e.Property(this.name,n)},e.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),e.Definitions[t]},e.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},e.Property.prototype.getFillStyleDefinition=function(t,n){var r=this.getDefinition();if(null!=r&&r.createGradient)return r.createGradient(e.ctx,t,n);if(null!=r&&r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.attribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&(r.attribute("patternTransform",!0).value=i.value)}return r.createPattern(e.ctx,t)}return null},e.Property.prototype.getDPI=function(){return 96},e.Property.prototype.getEM=function(t){var n=12,r=new e.Property("fontSize",e.Font.Parse(e.ctx.font).fontSize);return r.hasValue()&&(n=r.toPixels(t)),n},e.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},e.Property.prototype.toPixels=function(t,n){if(!this.hasValue())return 0;var r=this.value+"";if(r.match(/em$/))return this.numValue()*this.getEM(t);if(r.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(r.match(/px$/))return this.numValue();if(r.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(r.match(/pc$/))return 15*this.numValue();if(r.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(r.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(r.match(/in$/))return this.numValue()*this.getDPI(t);if(r.match(/%$/))return this.numValue()*e.ViewPort.ComputeSize(t);var i=this.numValue();return n&&1>i?i*e.ViewPort.ComputeSize(t):i},e.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():(e.match(/ms$/),this.numValue())},e.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},e.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,n,r,i,s,o){var u=null!=o?this.Parse(o):this.CreateFont("","","","","",e.ctx.font);return{fontFamily:s||u.fontFamily,fontSize:i||u.fontSize,fontStyle:t||u.fontStyle,fontWeight:r||u.fontWeight,fontVariant:n||u.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(n){for(var r={},i=e.trim(e.compressSpaces(n||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",u=0;u<i.length;u++)s.fontStyle||-1==t.Styles.indexOf(i[u])?s.fontVariant||-1==t.Variants.indexOf(i[u])?s.fontWeight||-1==t.Weights.indexOf(i[u])?s.fontSize?"inherit"!=i[u]&&(o+=i[u]):("inherit"!=i[u]&&(r.fontSize=i[u].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=i[u]&&(r.fontWeight=i[u]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=i[u]&&(r.fontVariant=i[u]),s.fontStyle=s.fontVariant=!0):("inherit"!=i[u]&&(r.fontStyle=i[u]),s.fontStyle=!0);return""!=o&&(r.fontFamily=o),r}},e.ToNumberArray=function(t){for(var n=e.trim(e.compressSpaces((t||"").replace(/,/g," "))).split(" "),r=0;r<n.length;r++)n[r]=parseFloat(n[r]);return n},e.Point=function(e,t){this.x=e,this.y=t},e.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},e.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n},e.CreatePoint=function(t){var n=e.ToNumberArray(t);return new e.Point(n[0],n[1])},e.CreatePath=function(t){for(var n=e.ToNumberArray(t),r=[],i=0;i<n.length;i+=2)r.push(new e.Point(n[i],n[i+1]));return r},e.BoundingBox=function(e,t,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,r,i,s){var o=e+2/3*(n-e),u=t+2/3*(r-t),a=o+1/3*(i-e),f=u+1/3*(s-t);this.addBezierCurve(e,t,o,a,u,f,i,s)},this.addBezierCurve=function(e,t,n,r,s,o,u,a){var f=[e,t],l=[n,r],c=[s,o],h=[u,a];for(this.addPoint(f[0],f[1]),this.addPoint(h[0],h[1]),i=0;1>=i;i++){var p=function(e){return Math.pow(1-e,3)*f[i]+3*Math.pow(1-e,2)*e*l[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*h[i]},d=6*f[i]-12*l[i]+6*c[i],v=-3*f[i]+9*l[i]-9*c[i]+3*h[i],m=3*l[i]-3*f[i];if(0!=v){var g=Math.pow(d,2)-4*m*v;if(!(0>g)){var y=(-d+Math.sqrt(g))/(2*v);y>0&&1>y&&(0==i&&this.addX(p(y)),1==i&&this.addY(p(y)));var b=(-d-Math.sqrt(g))/(2*v);b>0&&1>b&&(0==i&&this.addX(p(b)),1==i&&this.addY(p(b)))}}else{if(0==d)continue;var w=-m/d;w>0&&1>w&&(0==i&&this.addX(p(w)),1==i&&this.addY(p(w)))}}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,r)},e.Transform=function(t){var n=this;this.Type={},this.Type.translate=function(t){this.p=e.CreatePoint(t),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var n=e.ToNumberArray(t);this.angle=new e.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=e.CreatePoint(t),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=e.ToNumberArray(t),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=n.Type.matrix,this.base(t),this.angle=new e.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var r=e.trim(e.compressSpaces(t)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<r.length;i++){var s=e.trim(r[i].split("(")[0]),o=r[i].split("(")[1].replace(")",""),u=new this.Type[s](o);u.type=s,this.transforms.push(u)}},e.AspectRatio=function(t,n,r,i,s,o,u,a,f,l){n=e.compressSpaces(n),n=n.replace(/^defer\s/,"");var c=n.split(" ")[0]||"xMidYMid",h=n.split(" ")[1]||"meet",p=r/i,d=s/o,v=Math.min(p,d),m=Math.max(p,d);"meet"==h&&(i*=v,o*=v),"slice"==h&&(i*=m,o*=m),f=new e.Property("refX",f),l=new e.Property("refY",l),f.hasValue()&&l.hasValue()?t.translate(-v*f.toPixels("x"),-v*l.toPixels("y")):(c.match(/^xMid/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&t.translate(r/2-i/2,0),c.match(/YMid$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&t.translate(0,s/2-o/2),c.match(/^xMax/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&t.translate(r-i,0),c.match(/YMax$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&t.translate(0,s-o)),"none"==c?t.scale(p,d):"meet"==h?t.scale(v,v):"slice"==h&&t.scale(m,m),t.translate(null==u?0:-u,null==a?0:-a)},e.Element={},e.EmptyProperty=new e.Property("EMPTY",""),e.Element.ElementBase=function(t){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(t,n){var r=this.attributes[t];return null!=r?r:(1==n&&(r=new e.Property(t,""),this.attributes[t]=r),r||e.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if(t.match(/:href$/))return this.attributes[t];return e.EmptyProperty},this.style=function(t,n){var r=this.styles[t];if(null!=r)return r;var i=this.attribute(t);if(null!=i&&i.hasValue())return this.styles[t]=i,i;var s=this.parent;if(null!=s){var o=s.style(t);if(null!=o&&o.hasValue())return o}return 1==n&&(r=new e.Property(t,""),this.styles[t]=r),r||e.EmptyProperty},this.render=function(e){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(t,n){var r=t;n&&(r=e.CreateElement(t)),r.parent=this,this.children.push(r)},null!=t&&1==t.nodeType){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType&&this.addChild(r,!0),this.captureTextNodes&&3==r.nodeType){var i=r.nodeValue||r.text||"";""!=e.trim(e.compressSpaces(i))&&this.addChild(new e.Element.tspan(r),!1)}}for(var n=0;n<t.attributes.length;n++){var s=t.attributes[n];this.attributes[s.nodeName]=new e.Property(s.nodeName,s.nodeValue)}var o=e.Styles[t.nodeName];if(null!=o)for(var u in o)this.styles[u]=o[u];if(this.attribute("class").hasValue())for(var a=e.compressSpaces(this.attribute("class").value).split(" "),f=0;f<a.length;f++){if(o=e.Styles["."+a[f]],null!=o)for(var u in o)this.styles[u]=o[u];if(o=e.Styles[t.nodeName+"."+a[f]],null!=o)for(var u in o)this.styles[u]=o[u]}if(this.attribute("id").hasValue()){var o=e.Styles["#"+this.attribute("id").value];if(null!=o)for(var u in o)this.styles[u]=o[u]}if(this.attribute("style").hasValue())for(var o=this.attribute("style").value.split(";"),n=0;n<o.length;n++)if(""!=e.trim(o[n])){var l=o[n].split(":"),u=e.trim(l[0]),c=e.trim(l[1]);this.styles[u]=new e.Property(u,c)}this.attribute("id").hasValue()&&null==e.Definitions[this.attribute("id").value]&&(e.Definitions[this.attribute("id").value]=this)}},e.Element.RenderedElementBase=function(t){this.base=e.Element.ElementBase,this.base(t),this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=n&&(t.fillStyle=n)}else if(this.style("fill").hasValue()){var r=this.style("fill");"currentColor"==r.value&&(r.value=this.style("color").value),t.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value}if(this.style("fill-opacity").hasValue()){var r=new e.Property("fill",t.fillStyle);r=r.addOpacity(this.style("fill-opacity").value),t.fillStyle=r.value}if(this.style("stroke").isUrlDefinition()){var n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=n&&(t.strokeStyle=n)}else if(this.style("stroke").hasValue()){var i=this.style("stroke");"currentColor"==i.value&&(i.value=this.style("color").value),t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value}if(this.style("stroke-opacity").hasValue()){var i=new e.Property("stroke",t.strokeStyle);i=i.addOpacity(this.style("stroke-opacity").value),t.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()){var o=e.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof t.setLineDash?t.setLineDash(o):"undefined"!=typeof t.webkitLineDash?t.webkitLineDash=o:"undefined"!=typeof t.mozDash&&(t.mozDash=o);var u=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof t.lineDashOffset?t.lineDashOffset=u:"undefined"!=typeof t.webkitLineDashOffset?t.webkitLineDashOffset=u:"undefined"!=typeof t.mozDashOffset&&(t.mozDashOffset=u)}if("undefined"!=typeof t.font&&(t.font=e.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var a=new e.Transform(this.attribute("transform").value);a.apply(t)}if(this.style("clip-path").hasValue()){var f=this.style("clip-path").getDefinition();null!=f&&f.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},e.Element.RenderedElementBase.prototype=new e.Element.ElementBase,e.Element.PathElementBase=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new e.BoundingBox},this.renderChildren=function(t){this.path(t),e.Mouse.checkPath(this,t),""!=t.fillStyle&&(this.attribute("fill-rule").hasValue()?t.fill(this.attribute("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition()){var r=this.style("marker-start").getDefinition();r.render(t,n[0][0],n[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var r=this.style("marker-mid").getDefinition(),i=1;i<n.length-1;i++)r.render(t,n[i][0],n[i][1]);if(this.style("marker-end").isUrlDefinition()){var r=this.style("marker-end").getDefinition();r.render(t,n[n.length-1][0],n[n.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},e.Element.PathElementBase.prototype=new e.Element.RenderedElementBase,e.Element.svg=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),e.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=e.ViewPort.width(),r=e.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");var i=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),t.beginPath(),t.moveTo(i,s),t.lineTo(n,s),t.lineTo(n,r),t.lineTo(i,r),t.closePath(),t.clip()}if(e.ViewPort.SetCurrent(n,r),this.attribute("viewBox").hasValue()){var o=e.ToNumberArray(this.attribute("viewBox").value),u=o[0],a=o[1];n=o[2],r=o[3],e.AspectRatio(t,this.attribute("preserveAspectRatio").value,e.ViewPort.width(),n,e.ViewPort.height(),r,u,a,this.attribute("refX").value,this.attribute("refY").value),e.ViewPort.RemoveCurrent(),e.ViewPort.SetCurrent(o[2],o[3])}}},e.Element.svg.prototype=new e.Element.RenderedElementBase,e.Element.rect=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),u=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(u=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=u),o=Math.min(o,i/2),u=Math.min(u,s/2),null!=t&&(t.beginPath(),t.moveTo(n+o,r),t.lineTo(n+i-o,r),t.quadraticCurveTo(n+i,r,n+i,r+u),t.lineTo(n+i,r+s-u),t.quadraticCurveTo(n+i,r+s,n+i-o,r+s),t.lineTo(n+o,r+s),t.quadraticCurveTo(n,r+s,n,r+s-u),t.lineTo(n,r+u),t.quadraticCurveTo(n,r,n+o,r),t.closePath()),new e.BoundingBox(n,r,n+i,r+s)}},e.Element.rect.prototype=new e.Element.PathElementBase,e.Element.circle=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(n,r,i,0,2*Math.PI,!0),t.closePath()),new e.BoundingBox(n-i,r-i,n+i,r+i)}},e.Element.circle.prototype=new e.Element.PathElementBase,e.Element.ellipse=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=4*((Math.sqrt(2)-1)/3),r=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(s,o-i),t.bezierCurveTo(s+n*r,o-i,s+r,o-n*i,s+r,o),t.bezierCurveTo(s+r,o+n*i,s+n*r,o+i,s,o+i),t.bezierCurveTo(s-n*r,o+i,s-r,o+n*i,s-r,o),t.bezierCurveTo(s-r,o-n*i,s-n*r,o-i,s,o-i),t.closePath()),new e.BoundingBox(s-r,o-i,s+r,o+i)}},e.Element.ellipse.prototype=new e.Element.PathElementBase,e.Element.line=function(t){this.base=e.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new e.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new e.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var n=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(n[0].x,n[0].y),t.lineTo(n[1].x,n[1].y)),new e.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},e.Element.line.prototype=new e.Element.PathElementBase,e.Element.polyline=function(t){this.base=e.Element.PathElementBase,this.base(t),this.points=e.CreatePath(this.attribute("points").value),this.path=function(t){var n=new e.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var r=1;r<this.points.length;r++)n.addPoint(this.points[r].x,this.points[r].y),null!=t&&t.lineTo(this.points[r].x,this.points[r].y);return n},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},e.Element.polyline.prototype=new e.Element.PathElementBase,e.Element.polygon=function(t){this.base=e.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},e.Element.polygon.prototype=new e.Element.polyline,e.Element.path=function(t){this.base=e.Element.PathElementBase,this.base(t);var n=this.attribute("d").value;n=n.replace(/,/gm," "),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([0-9])([+\-])/gm,"$1 $2"),n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=e.compressSpaces(n),n=e.trim(n),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new e.Point(0,0),this.control=new e.Point(0,0),this.current=new e.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new e.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var t=new e.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(n),this.path=function(t){var n=this.PathParser;n.reset();var r=new e.BoundingBox;for(null!=t&&t.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var i=n.getAsCurrentPoint();for(n.addMarker(i),r.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),n.start=n.current;!n.isCommandOrEnd();){var i=n.getAsCurrentPoint();n.addMarker(i,n.start),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"L":case"l":for(;!n.isCommandOrEnd();){var s=n.current,i=n.getAsCurrentPoint();n.addMarker(i,s),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var o=new e.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();){var o=new e.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y)}break;case"C":case"c":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=t&&t.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getReflectedControlPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=t&&t.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"Q":case"q":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=t&&t.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"T":case"t":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getReflectedControlPoint();n.control=f;var l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=t&&t.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"A":case"a":for(;!n.isCommandOrEnd();){var u=n.current,c=n.getScalar(),h=n.getScalar(),p=n.getScalar()*(Math.PI/180),d=n.getScalar(),v=n.getScalar(),l=n.getAsCurrentPoint(),m=new e.Point(Math.cos(p)*(u.x-l.x)/2+Math.sin(p)*(u.y-l.y)/2,-Math.sin(p)*(u.x-l.x)/2+Math.cos(p)*(u.y-l.y)/2),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(h,2);g>1&&(c*=Math.sqrt(g),h*=Math.sqrt(g));var y=(d==v?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(h,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(h,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(h,2)*Math.pow(m.x,2)));isNaN(y)&&(y=0);var b=new e.Point(y*c*m.y/h,y*-h*m.x/c),w=new e.Point((u.x+l.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(u.y+l.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),E=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},S=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(E(e)*E(t))},x=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(S(e,t))},T=x([1,0],[(m.x-b.x)/c,(m.y-b.y)/h]),N=[(m.x-b.x)/c,(m.y-b.y)/h],C=[(-m.x-b.x)/c,(-m.y-b.y)/h],k=x(N,C);S(N,C)<=-1&&(k=Math.PI),S(N,C)>=1&&(k=0);var L=1-v?1:-1,A=T+L*(k/2),O=new e.Point(w.x+c*Math.cos(A),w.y+h*Math.sin(A));if(n.addMarkerAngle(O,A-L*Math.PI/2),n.addMarkerAngle(l,A-L*Math.PI),r.addPoint(l.x,l.y),null!=t){var S=c>h?c:h,M=c>h?1:c/h,_=c>h?h/c:1;t.translate(w.x,w.y),t.rotate(p),t.scale(M,_),t.arc(0,0,S,T,T+k,1-v),t.scale(1/M,1/_),t.rotate(-p),t.translate(-w.x,-w.y)}}break;case"Z":case"z":null!=t&&t.closePath(),n.current=n.start}return r},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}},e.Element.path.prototype=new e.Element.PathElementBase,e.Element.pattern=function(t){this.base=e.Element.ElementBase,this.base(t),this.createPattern=function(t){var n=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),i=new e.Element.svg;i.attributes.viewBox=new e.Property("viewBox",this.attribute("viewBox").value),i.attributes.width=new e.Property("width",n+"px"),i.attributes.height=new e.Property("height",r+"px"),i.attributes.transform=new e.Property("transform",this.attribute("patternTransform").value),i.children=this.children;var s=document.createElement("canvas");s.width=n,s.height=r;var o=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&o.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var u=-1;1>=u;u++)for(var a=-1;1>=a;a++)o.save(),o.translate(u*s.width,a*s.height),i.render(o),o.restore();var f=t.createPattern(s,"repeat");return f}},e.Element.pattern.prototype=new e.Element.ElementBase,e.Element.marker=function(t){this.base=e.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,n,r){t.translate(n.x,n.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(r),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var i=new e.Element.svg;i.attributes.viewBox=new e.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new e.Property("refX",this.attribute("refX").value),i.attributes.refY=new e.Property("refY",this.attribute("refY").value),i.attributes.width=new e.Property("width",this.attribute("markerWidth").value),i.attributes.height=new e.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new e.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new e.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-r),t.translate(-n.x,-n.y)}},e.Element.marker.prototype=new e.Element.ElementBase,e.Element.defs=function(t){this.base=e.Element.ElementBase,this.base(t),this.render=function(){}},e.Element.defs.prototype=new e.Element.ElementBase,e.Element.GradientBase=function(t){this.base=e.Element.ElementBase,this.base(t),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"stop"==r.type&&this.stops.push(r)}this.getGradient=function(){},this.createGradient=function(t,n,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition());var s=function(t){if(r.hasValue()){var n=new e.Property("color",t);return n.addOpacity(r.value).value}return t},o=this.getGradient(t,n);if(null==o)return s(i.stops[i.stops.length-1].color);for(var u=0;u<i.stops.length;u++)o.addColorStop(i.stops[u].offset,s(i.stops[u].color));if(this.attribute("gradientTransform").hasValue()){var a=e.ViewPort.viewPorts[0],f=new e.Element.rect;f.attributes.x=new e.Property("x",-e.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new e.Property("y",-e.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new e.Property("width",e.MAX_VIRTUAL_PIXELS),f.attributes.height=new e.Property("height",e.MAX_VIRTUAL_PIXELS);var l=new e.Element.g;l.attributes.transform=new e.Property("transform",this.attribute("gradientTransform").value),l.children=[f];var c=new e.Element.svg;c.attributes.x=new e.Property("x",0),c.attributes.y=new e.Property("y",0),c.attributes.width=new e.Property("width",a.width),c.attributes.height=new e.Property("height",a.height),c.children=[l];var h=document.createElement("canvas");h.width=a.width,h.height=a.height;var p=h.getContext("2d");return p.fillStyle=o,c.render(p),p.createPattern(h,"no-repeat")}return o}},e.Element.GradientBase.prototype=new e.Element.ElementBase,e.Element.linearGradient=function(t){this.base=e.Element.GradientBase,this.base(t),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==s&&i==o?null:e.createLinearGradient(r,i,s,o)}},e.Element.linearGradient.prototype=new e.Element.GradientBase,e.Element.radialGradient=function(t){this.base=e.Element.GradientBase,this.base(t),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=r,o=i;this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u="objectBoundingBox"==this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(s,o,0,r,i,u)}},e.Element.radialGradient.prototype=new e.Element.GradientBase,e.Element.stop=function(t){this.base=e.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var n=this.style("stop-color");this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity").value)),this.color=n.value},e.Element.stop.prototype=new e.Element.ElementBase,e.Element.AnimateBase=function(t){this.base=e.Element.ElementBase,this.base(t),e.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var r=this.attribute("type").value;n=r+"("+n+")"}this.getProperty().value=n,t=!0}return t},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=t.progress*(this.values.value.length-1),r=Math.floor(n),i=Math.ceil(n);t.from=new e.Property("from",parseFloat(this.values.value[r])),t.to=new e.Property("to",parseFloat(this.values.value[i])),t.progress=(n-r)/(i-r)}else t.from=this.from,t.to=this.to;return t}},e.Element.AnimateBase.prototype=new e.Element.ElementBase,e.Element.animate=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){var e=this.progress(),t=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return t+this.initialUnits}},e.Element.animate.prototype=new e.Element.AnimateBase,e.Element.animateColor=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),n=new RGBColor(e.to.value);if(t.ok&&n.ok){var r=t.r+(n.r-t.r)*e.progress,i=t.g+(n.g-t.g)*e.progress,s=t.b+(n.b-t.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(i,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},e.Element.animateColor.prototype=new e.Element.AnimateBase,e.Element.animateTransform=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),n=e.ToNumberArray(t.from.value),r=e.ToNumberArray(t.to.value),i="",s=0;s<n.length;s++)i+=n[s]+(r[s]-n[s])*t.progress+" ";return i}},e.Element.animateTransform.prototype=new e.Element.animate,e.Element.font=function(t){this.base=e.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"font-face"==r.type?(this.fontFace=r,r.style("font-family").hasValue()&&(e.Definitions[r.style("font-family").value]=this)):"missing-glyph"==r.type?this.missingGlyph=r:"glyph"==r.type&&(""!=r.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[r.unicode]&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}},e.Element.font.prototype=new e.Element.ElementBase,e.Element.fontface=function(t){this.base=e.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},e.Element.fontface.prototype=new e.Element.ElementBase,e.Element.missingglyph=function(t){this.base=e.Element.path,this.base(t),this.horizAdvX=0},e.Element.missingglyph.prototype=new e.Element.path,e.Element.glyph=function(t){this.base=e.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},e.Element.glyph.prototype=new e.Element.path,e.Element.text=function(t){this.captureTextNodes=!0,this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.style("dominant-baseline").hasValue()&&(e.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(e.textBaseline=this.style("alignment-baseline").value)},this.getBoundingBox=function(){return new e.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,n){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var i=0,s=n;s<t.children.length;s++){var o=t.children[s];if(s>n&&o.attribute("x").hasValue())break;i+=o.measureTextRecursive(e)}return-1*("end"==r?i:i/2)}return 0},this.renderChild=function(e,t,n){var r=t.children[n];r.attribute("x").hasValue()?r.x=r.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),r.attribute("dx").hasValue()&&(this.x+=r.attribute("dx").toPixels("x")),r.x=this.x),this.x=r.x+r.measureText(e),r.attribute("y").hasValue()?r.y=r.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),r.attribute("dy").hasValue()&&(this.y+=r.attribute("dy").toPixels("y")),r.y=this.y),this.y=r.y,r.render(e);for(var n=0;n<r.children.length;n++)this.renderChild(e,r,n)}},e.Element.text.prototype=new e.Element.RenderedElementBase,e.Element.TextElementBase=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.getGlyph=function(e,t,n){var r=t[n],i=null;if(e.isArabic){var s="isolated";(0==n||" "==t[n-1])&&n<t.length-2&&" "!=t[n+1]&&(s="terminal"),n>0&&" "!=t[n-1]&&n<t.length-2&&" "!=t[n+1]&&(s="medial"),n>0&&" "!=t[n-1]&&(n==t.length-1||" "==t[n+1])&&(s="initial"),"undefined"!=typeof e.glyphs[r]&&(i=e.glyphs[r][s],null==i&&"glyph"==e.glyphs[r].type&&(i=e.glyphs[r]))}else i=e.glyphs[r];return null==i&&(i=e.missingGlyph),i},this.renderChildren=function(t){var n=this.parent.style("font-family").getDefinition();if(null==n)""!=t.fillStyle&&t.fillText(e.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(e.compressSpaces(this.getText()),this.x,this.y);else{var r=this.parent.style("font-size").numValueOrDefault(e.Font.Parse(e.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(e.Font.Parse(e.ctx.font).fontStyle),s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=e.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u),f=r/n.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(f,-f);var l=t.lineWidth;t.lineWidth=t.lineWidth*n.fontFace.unitsPerEm/r,"italic"==i&&t.transform(1,0,.4,1,0,0),a.render(t),"italic"==i&&t.transform(1,0,-0.4,1,0,0),t.lineWidth=l,t.scale(1/f,-1/f),t.translate(-this.x,-this.y),this.x+=r*(a.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(this.x+=o[u])}}},this.getText=function(){},this.measureTextRecursive=function(e){for(var t=this.measureText(e),n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},this.measureText=function(t){var n=this.parent.style("font-family").getDefinition();if(null!=n){var r=this.parent.style("font-size").numValueOrDefault(e.Font.Parse(e.ctx.font).fontSize),i=0,s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=e.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u);i+=(a.horizAdvX||n.horizAdvX)*r/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(i+=o[u])}return i}var f=e.compressSpaces(this.getText());if(!t.measureText)return 10*f.length;t.save(),this.setContext(t);var l=t.measureText(f).width;return t.restore(),l}},e.Element.TextElementBase.prototype=new e.Element.RenderedElementBase,e.Element.tspan=function(t){this.captureTextNodes=!0,this.base=e.Element.TextElementBase,this.base(t),this.text=t.nodeValue||t.text||"",this.getText=function(){return this.text}},e.Element.tspan.prototype=new e.Element.TextElementBase,e.Element.tref=function(t){this.base=e.Element.TextElementBase,this.base(t),this.getText=function(){var e=this.getHrefAttribute().getDefinition();return null!=e?e.children[0].getText():void 0}},e.Element.tref.prototype=new e.Element.TextElementBase,e.Element.a=function(t){this.base=e.Element.TextElementBase,this.base(t),this.hasText=!0;for(var n=0;n<t.childNodes.length;n++)3!=t.childNodes[n].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var n=new e.Property("fontSize",e.Font.Parse(e.ctx.font).fontSize);e.Mouse.checkBoundingBox(this,new e.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(t),this.y))}else{var r=new e.Element.g;r.children=this.children,r.parent=this,r.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){e.ctx.canvas.style.cursor="pointer"}},e.Element.a.prototype=new e.Element.TextElementBase,e.Element.image=function(t){this.base=e.Element.RenderedElementBase,this.base(t);var n=this.getHrefAttribute().value,r=n.match(/\.svg$/);if(e.Images.push(this),this.loaded=!1,r)this.img=e.ajax(n),this.loaded=!0;else{this.img=document.createElement("img");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){"undefined"!=typeof console&&(console.log('ERROR: image "'+n+'" not found'),i.loaded=!0)},this.img.src=n}this.renderChildren=function(t){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=s&&0!=o&&(t.save(),r?t.drawSvg(this.img,n,i,s,o):(t.translate(n,i),e.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,o,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new e.BoundingBox(t,n,t+r,n+i)}},e.Element.image.prototype=new e.Element.RenderedElementBase,e.Element.g=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new e.BoundingBox,n=0;n<this.children.length;n++)t.addBoundingBox(this.children[n].getBoundingBox());return t}},e.Element.g.prototype=new e.Element.RenderedElementBase,e.Element.symbol=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){if(this.baseSetContext(t),this.attribute("viewBox").hasValue()){var n=e.ToNumberArray(this.attribute("viewBox").value),r=n[0],i=n[1];width=n[2],height=n[3],e.AspectRatio(t,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,r,i),e.ViewPort.SetCurrent(n[2],n[3])}}},e.Element.symbol.prototype=new e.Element.RenderedElementBase,e.Element.style=function(t){this.base=e.Element.ElementBase,this.base(t);for(var n="",r=0;r<t.childNodes.length;r++)n+=t.childNodes[r].nodeValue;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),n=e.compressSpaces(n);for(var i=n.split("}"),r=0;r<i.length;r++)if(""!=e.trim(i[r]))for(var s=i[r].split("{"),o=s[0].split(","),u=s[1].split(";"),a=0;a<o.length;a++){var f=e.trim(o[a]);if(""!=f){for(var l={},c=0;c<u.length;c++){var h=u[c].indexOf(":"),p=u[c].substr(0,h),d=u[c].substr(h+1,u[c].length-h);null!=p&&null!=d&&(l[e.trim(p)]=new e.Property(e.trim(p),e.trim(d)))}if(e.Styles[f]=l,"@font-face"==f)for(var v=l["font-family"].value.replace(/"/g,""),m=l.src.value.split(","),g=0;g<m.length;g++)if(m[g].indexOf('format("svg")')>0)for(var y=m[g].indexOf("url"),b=m[g].indexOf(")",y),w=m[g].substr(y+5,b-y-6),E=e.parseXml(e.ajax(w)),S=E.getElementsByTagName("font"),x=0;x<S.length;x++){var T=e.CreateElement(S[x]);e.Definitions[v]=T}}}},e.Element.style.prototype=new e.Element.ElementBase,e.Element.use=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var e=this.getHrefAttribute().getDefinition();return this.attribute("width").hasValue()&&(e.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(e.attribute("height",!0).value=this.attribute("height").value),e},this.path=function(e){var t=this.getDefinition();null!=t&&t.path(e)},this.getBoundingBox=function(){var e=this.getDefinition();return null!=e?e.getBoundingBox():void 0},this.renderChildren=function(e){var t=this.getDefinition();if(null!=t){var n=t.parent;t.parent=null,t.render(e),t.parent=n}}},e.Element.use.prototype=new e.Element.RenderedElementBase,e.Element.mask=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(t,n){var r=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==s&&0==o){for(var u=new e.BoundingBox,a=0;a<this.children.length;a++)u.addBoundingBox(this.children[a].getBoundingBox());var r=Math.floor(u.x1),i=Math.floor(u.y1),s=Math.floor(u.width()),o=Math.floor(u.height())}var f=n.attribute("mask").value;n.attribute("mask").value="";var l=document.createElement("canvas");l.width=r+s,l.height=i+o;var c=l.getContext("2d");this.renderChildren(c);var h=document.createElement("canvas");h.width=r+s,h.height=i+o;var p=h.getContext("2d");n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(l,"no-repeat"),p.fillRect(0,0,r+s,i+o),t.fillStyle=p.createPattern(h,"no-repeat"),t.fillRect(0,0,r+s,i+o),n.attribute("mask").value=f},this.render=function(){}},e.Element.mask.prototype=new e.Element.ElementBase,e.Element.clipPath=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(t){for(var n=0;n<this.children.length;n++){var r=this.children[n];if("undefined"!=typeof r.path){var i=null;r.attribute("transform").hasValue()&&(i=new e.Transform(r.attribute("transform").value),i.apply(t)),r.path(t),t.clip(),i&&i.unapply(t)}}},this.render=function(){}},e.Element.clipPath.prototype=new e.Element.ElementBase,e.Element.filter=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(e,t){var n=t.getBoundingBox(),r=Math.floor(n.x1),i=Math.floor(n.y1),s=Math.floor(n.width()),o=Math.floor(n.height()),u=t.style("filter").value;t.style("filter").value="";for(var a=0,f=0,l=0;l<this.children.length;l++){var c=this.children[l].extraFilterDistance||0;a=Math.max(a,c),f=Math.max(f,c)}var h=document.createElement("canvas");h.width=s+2*a,h.height=o+2*f;var p=h.getContext("2d");p.translate(-r+a,-i+f),t.render(p);for(var l=0;l<this.children.length;l++)this.children[l].apply(p,0,0,s+2*a,o+2*f);e.drawImage(h,0,0,s+2*a,o+2*f,r-a,i-f,s+2*a,o+2*f),t.style("filter",!0).value=u},this.render=function(){}},e.Element.filter.prototype=new e.Element.ElementBase,e.Element.feMorphology=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(){}},e.Element.feMorphology.prototype=new e.Element.ElementBase,e.Element.feColorMatrix=function(t){function n(e,t,n,r,i,s){return e[n*r*4+4*t+s]}function r(e,t,n,r,i,s,o){e[n*r*4+4*t+s]=o}this.base=e.Element.ElementBase,this.base(t),this.apply=function(e,t,i,s,o){for(var u=e.getImageData(0,0,s,o),i=0;o>i;i++)for(var t=0;s>t;t++){var a=n(u.data,t,i,s,o,0),f=n(u.data,t,i,s,o,1),l=n(u.data,t,i,s,o,2),c=(a+f+l)/3;r(u.data,t,i,s,o,0,c),r(u.data,t,i,s,o,1,c),r(u.data,t,i,s,o,2,c)}e.clearRect(0,0,s,o),e.putImageData(u,0,0)}},e.Element.feColorMatrix.prototype=new e.Element.ElementBase,e.Element.feGaussianBlur=function(t){this.base=e.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,r,i,s){return"undefined"==typeof stackBlurCanvasRGBA?void ("undefined"!=typeof console&&console.log("ERROR: StackBlur.js must be included for blur to work")):(t.canvas.id=e.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),stackBlurCanvasRGBA(t.canvas.id,n,r,i,s,this.blurRadius),void document.body.removeChild(t.canvas))}},e.Element.feGaussianBlur.prototype=new e.Element.ElementBase,e.Element.title=function(){},e.Element.title.prototype=new e.Element.ElementBase,e.Element.desc=function(){},e.Element.desc.prototype=new e.Element.ElementBase,e.Element.MISSING=function(e){"undefined"!=typeof console&&console.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},e.Element.MISSING.prototype=new e.Element.ElementBase,e.CreateElement=function(t){var n=t.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var r=null;return r="undefined"!=typeof e.Element[n]?new e.Element[n](t):new e.Element.MISSING(t),r.type=t.nodeName,r},e.load=function(t,n){e.loadXml(t,e.ajax(n))},e.loadXml=function(t,n){e.loadXmlDoc(t,e.parseXml(n))},e.loadXmlDoc=function(t,n){e.init(t);var r=function(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=e.opts.ignoreMouse&&(t.canvas.onclick=function(t){var n=r(new e.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));e.Mouse.onclick(n.x,n.y)},t.canvas.onmousemove=function(t){var n=r(new e.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));e.Mouse.onmousemove(n.x,n.y)});var i=e.CreateElement(n.documentElement);i.root=!0;var s=!0,o=function(){e.ViewPort.Clear(),t.canvas.parentNode&&e.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=e.opts.ignoreDimensions&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var r=t.canvas.clientWidth||t.canvas.width,o=t.canvas.clientHeight||t.canvas.height;if(1==e.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(r=i.style("width").toPixels("x"),o=i.style("height").toPixels("y")),e.ViewPort.SetCurrent(r,o),null!=e.opts.offsetX&&(i.attribute("x",!0).value=e.opts.offsetX),null!=e.opts.offsetY&&(i.attribute("y",!0).value=e.opts.offsetY),null!=e.opts.scaleWidth&&null!=e.opts.scaleHeight){var u=1,a=1,f=e.ToNumberArray(i.attribute("viewBox").value);i.attribute("width").hasValue()?u=i.attribute("width").toPixels("x")/e.opts.scaleWidth:isNaN(f[2])||(u=f[2]/e.opts.scaleWidth),i.attribute("height").hasValue()?a=i.attribute("height").toPixels("y")/e.opts.scaleHeight:isNaN(f[3])||(a=f[3]/e.opts.scaleHeight),i.attribute("width",!0).value=e.opts.scaleWidth,i.attribute("height",!0).value=e.opts.scaleHeight,i.attribute("viewBox",!0).value="0 0 "+r*u+" "+o*a,i.attribute("preserveAspectRatio",!0).value="none"}1!=e.opts.ignoreClear&&t.clearRect(0,0,r,o),i.render(t),s&&(s=!1,"function"==typeof e.opts.renderCallback&&e.opts.renderCallback(n))},u=!0;e.ImagesLoaded()&&(u=!1,o()),e.intervalID=setInterval(function(){var t=!1;if(u&&e.ImagesLoaded()&&(u=!1,t=!0),1!=e.opts.ignoreMouse&&(t|=e.Mouse.hasEvents()),1!=e.opts.ignoreAnimation)for(var n=0;n<e.Animations.length;n++)t|=e.Animations[n].update(1e3/e.FRAMERATE);"function"==typeof e.opts.forceRedraw&&1==e.opts.forceRedraw()&&(t=!0),t&&(o(),e.Mouse.runEvents())},1e3/e.FRAMERATE)},e.stop=function(){e.intervalID&&clearInterval(e.intervalID)},e.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInPath&&t.isPointInPath(r.x,r.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInBox(r.x,r.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){e.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var n=this.events[t],r=this.eventElements[t];r;)n.run(r),r=r.parent;this.events=[],this.eventElements=[]}},e}this.canvg=function(t,n,r){if(null!=t||null!=n||null!=r){r=r||{},"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var i=e();(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=i),i.opts=r;var s=t.getContext("2d");"undefined"!=typeof n.documentElement?i.loadXmlDoc(s,n):"<"==n.substr(0,1)?i.loadXml(s,n):i.load(s,n)}else for(var o=document.getElementsByTagName("svg"),u=0;u<o.length;u++){var a=o[u],f=document.createElement("canvas");f.width=a.clientWidth,f.height=a.clientHeight,a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a);var l=document.createElement("div");l.appendChild(a),canvg(f,l.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,r,i){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:r,scaleHeight:i})}),define("canvg.bundle",function(){}),function(e){define("canvas-toBlob",["Blob"],function(){return function(){(function(e){"use strict";var t=e.Uint8Array,n=e.HTMLCanvasElement,r=n&&n.prototype,i=/\s*;\s*base64\s*(?:;|$)/i,s="toDataURL",o,u=function(e){var n=e.length,r=new t(n/4*3|0),i=0,s=0,u=[0,0],a=0,f=0,l,c,h;while(n--)c=e.charCodeAt(i++),l=o[c-43],l!==255&&l!==h&&(u[1]=u[0],u[0]=c,f=f<<6|l,a++,a===4&&(r[s++]=f>>>16,u[1]!==61&&(r[s++]=f>>>8),u[0]!==61&&(r[s++]=f),a=0));return r};t&&(o=new t([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),n&&!r.toBlob&&(r.toBlob=function(e,n){n||(n="image/png");if(this.mozGetAsFile){e(this.mozGetAsFile("canvas",n));return}if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(n)){e(this.msToBlob());return}var r=Array.prototype.slice.call(arguments,1),o=this[s].apply(this,r),a=o.indexOf(","),f=o.substring(a+1),l=i.test(o.substring(0,a)),c;Blob.fake?(c=new Blob,l?c.encoding="base64":c.encoding="URI",c.data=f,c.size=f.length):t&&(l?c=new Blob([u(f)],{type:n}):c=new Blob([decodeURIComponent(f)],{type:n})),e(c)},r.toDataURLHD?r.toBlobHD=function(){s="toDataURLHD";var e=this.toBlob();return s="toDataURL",e}:r.toBlobHD=r.toBlob)})(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content||this)}.apply(e,arguments)})}(this),define("Common/AnalysisData/Plots/Svg/download/SvgDownloadController",["marionette","canvg.bundle","canvas-toBlob","FileSaver","Blob","promise-polyfill"],function(e){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("analysis-data:views:plot:svg:initialize-save-as",this.initializeSaveAs,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},initializeSaveAs:function(e,t){this.listenTo(t,"download:png",_.partial(this._onDownloadPng,e)),this.listenTo(t,"download:svg",_.partial(this._onDownloadSvg,e))},svgToCanvas:function(e){return new Promise(function(t){var n=document.createElement("canvas"),r=e.getAttribute("width"),i=e.getAttribute("height"),s=e.viewBox.baseVal.width,o=e.viewBox.baseVal.height;e.setAttribute("width",s),e.setAttribute("height",o),$(n).css({position:"absolute",left:"-9999px",top:"-9999px"}).attr({width:s,height:o});var u=(new XMLSerializer).serializeToString(e);u=u.replace(/ href=/g," xlink:href=").replace(" xlink="," xmlns:xlink="),canvg(n,u,{renderCallback:function(){e.setAttribute("width",r),e.setAttribute("height",i),t(n)}})})},canvasToBlob:function(e){return new Promise(function(t){e.toBlob(function(e){t(e)})})},textToBlob:function(e,t){return new Blob([t],{type:e})},svgToText:function(e){var t=(new XMLSerializer).serializeToString(e);return t=t.replace(/ href=/g," xlink:href=").replace(" xlink="," xmlns:xlink="),Promise.resolve('<?xml version="1.0" encoding="UTF-8"?>\n'+t)},_onDownloadPng:function(e,t){t.view.ui.downloadPngBtn.prop("disabled",!0),e.getBrushBehaviorTarget().style("display","none"),this.svgToCanvas(e.d3.svg.node()).then(_.bind(this.canvasToBlob,this)).then(function(n){t.view.ui.downloadPngBtn.prop("disabled",!1),e.getBrushBehaviorTarget().style("display","block"),saveAs(n,e.getOption("pageLabel")+".png")})},_onDownloadSvg:function(e,t){t.view.ui.downloadSvgBtn.prop("disabled",!0),e.getBrushBehaviorTarget().style("display","none"),this.svgToText(e.d3.svg.node()).then(_.bind(this.textToBlob,this,"image/svg+xml")).then(function(n){t.view.ui.downloadSvgBtn.prop("disabled",!1),e.getBrushBehaviorTarget().style("display","block"),saveAs(n,e.getOption("pageLabel")+".svg")}).catch(function(e){console.log(e)})}})}),define("Common/AnalysisData/Plots/Svg/svg-app",["marionette","app","./show/SvgShowController","./show/PointDetailsShowController","./show/d3BrushController","./show/d3BrushZoomingController","./show/d3BrushTaggingController","./show/d3TagsShowController","./show/d3ZoomingController","./download/SvgDownloadController"],function(e,t,n,r,i,s,o,u,a,f){var l=t.module("Common.AnalysisData.Plots.Svg"),c=Backbone.Wreqr.radio.channel("global").reqres;return l.on("start",function(){this.showC=new n,this.pointDetailsC=new r,this.brushC=new i,this.brushZoomingC=new s,this.brushTaggingC=new o,this.tagsC=new u,this.zoomingC=new a,this.downloadC=new f}),l}),define("Common/AnalysisData/Plots/Sidebar/show/layoutview/SidebarView",["marionette","bootstrap"],function(e){return e.LayoutView.extend({className:"accordion"})}),define("Common/AnalysisData/Plots/Sidebar/show/behaviors/AccordionGroupBehavior",["marionette","bootstrap"],function(e){return e.Behavior.extend({ui:{toggle:".accordion-toggle",toggleIcon:".accordion-toggle i",body:".accordion-body"},events:{"click @ui.toggle":"_onClickToggle","show @ui.body":"_onBodyShow","hide @ui.body":"_onBodyHide"},onRender:function(){this.ui.body.collapse({parent:this.$el.parent(),toggle:!1})},onOpenAccordion:function(){this.ui.body.collapse("show")},_onClickToggle:function(e){e.preventDefault(),this.ui.body.collapse("toggle")},_onBodyShow:function(){this.view.trigger("accordion:toggle",!0),this.ui.toggleIcon.addClass("icon-chevron-down").removeClass("icon-chevron-right")},_onBodyHide:function(){this.view.trigger("accordion:toggle",!1),this.ui.toggleIcon.addClass("icon-chevron-right").removeClass("icon-chevron-down")}})}),define("Common/AnalysisData/Plots/Sidebar/show/itemview/WarningsView",["marionette","../behaviors/AccordionGroupBehavior"],function(e,t){return e.ItemView.extend({template:"#ep-analysis-plot-sidebar-warnings-tmpl",behaviors:{Accordion:{behaviorClass:t}}})}),define("Common/AnalysisData/Plots/Sidebar/show/layoutview/ParametersView",["marionette","../behaviors/AccordionGroupBehavior","bootstrap"],function(e,t){return e.LayoutView.extend({template:"#ep-analysis-plot-sidebar-parameters-tmpl",regions:{inner:"[data-inner-region]"},behaviors:{Accordion:{behaviorClass:t}},templateHelpers:function(){return{opened:this.getOption("opened")}}})}),define("Common/AnalysisData/Plots/Sidebar/show/compositeview/FilterItemView",["marionette","bootstrap"],function(e){return e.CompositeView.extend({template:"#ep-analysis-plot-sidebar-filters-item-tmpl",tagName:"li",getChildView:function(){return this.getReqRes().request("analysis-data:views:table:filter:class")},childViewContainer:"[data-filters-region]",childViewOptions:{className:"input-prepend ep-analysis-filter"},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres}})}),define("Common/AnalysisData/Plots/Sidebar/show/compositeview/FiltersView",["marionette","./FilterItemView","../behaviors/AccordionGroupBehavior"],function(e,t,n){return e.CompositeView.extend({template:"#ep-analysis-plot-sidebar-filters-tmpl",ui:{label:"[data-label]",nbFilters:"[data-nb-filters]"},behaviors:{Accordion:{behaviorClass:n}},events:{"mouseenter dt":"_onDtMouseenter","mouseleave dt":"_onDtMouseleave"},modelEvents:{"filter:complete":"_onModelFilterComplete"},childView:t,childViewContainer:"[data-inner-region]",childViewOptions:function(e,t){return{collection:e.filtersCollection}},onRender:function(){this.updateHeader()},updateHeader:function(){var e=this.model.filtersCollection.reduce(function(e,t){return e+(t.has("value")?1:0)},0);e+=this.model.get("filteredByIds")?1:0,e>0?(this.ui.label.text("Filters: "+e),this.ui.nbFilters.text("Showing "+this.model.get("currentSize")+" of "+this.model.get("size"))):(this.ui.nbFilters.text("Showing All "+this.model.get("size")),this.ui.label.text("Filters: None"))},_onModelFilterComplete:function(){this.updateHeader()},_onDtMouseenter:function(e){var t=$(e.currentTarget),n=t.children(".ep-ext-label");t.width()<n.width()&&n.css("visibility","visible")},_onDtMouseleave:function(e){var t=$(e.currentTarget);t.children(".ep-ext-label").css("visibility","hidden")}})}),define("Common/AnalysisData/Plots/Sidebar/show/itemview/TaggingView",["marionette","../behaviors/AccordionGroupBehavior"],function(e,t){return e.ItemView.extend({template:"#ep-analysis-plot-sidebar-tagging-tmpl",ui:{selector:"select",tagBtn:"[data-tag]",clearBtn:"[data-clear]",filterBtn:"[data-filter-tagged]",releaseBtn:"[data-release]"},events:{"click @ui.tagBtn":"_onTagButtonClick","click @ui.clearBtn":"_onClearButtonClick","click @ui.filterBtn":"_onFilterButtonClick","click @ui.releaseBtn":"_onReleaseButtonClick","change @ui.selector":"_onSelectorValueChange"},modelEvents:{"change:interactionMode":"_onModelChangeInteractionMode","change:tagFieldIdx":"_onModelChangeTagFieldIdx","change:tagCloudVisible":"_onModelCloudVisibleChanged"},behaviors:{Accordion:{behaviorClass:t}},templateHelpers:function(){return{items:this.collection.toJSON()}},initialize:function(e){},setSelectorValueFirstIfNone:function(){var e=this.ui.selector.children(":selected"),t=parseInt(e.attr("value"));t||(this.ui.selector.children().eq(1).prop("selected",!0),t=0),this.model.set("tagFieldIdx",t)},_onSelectorValueChange:function(){this.setSelectorValueFirstIfNone()},_onTagButtonClick:function(e){this.ui.tagBtn.prop("disabled",!0),this.setSelectorValueFirstIfNone(),this.trigger("tag:all")},_onClearButtonClick:function(){this.ui.tagBtn.prop("disabled",!1),this.ui.filterBtn.prop("disabled",!0),this.trigger("tag:clear")},_onFilterButtonClick:function(){this.ui.releaseBtn.prop("disabled",!1),this.trigger("tag:filter")},_onReleaseButtonClick:function(){this.ui.filterBtn.prop("disabled",!1),this.ui.releaseBtn.prop("disabled",!0),this.trigger("tag:release")},_onModelCloudVisibleChanged:function(e,t){this.ui.clearBtn.prop("disabled",!t),this.ui.filterBtn.prop("disabled",!t),this.ui.tagBtn.prop("disabled",!1),this.setSelectorValueFirstIfNone()},_onModelChangeTagFieldIdx:function(e,t){this.ui.selector.children().eq(t+1).prop("selected",!0)},_onModelChangeInteractionMode:function(e,t){t==="tag"&&this.triggerMethod("openAccordion")}})}),define("Common/AnalysisData/Plots/Sidebar/show/SidebarShowController",["marionette","./layoutview/SidebarView","./itemview/WarningsView","./layoutview/ParametersView","./compositeview/FiltersView","./itemview/TaggingView"],function(e,t,n,r,i,s){return e.Controller.extend({initialize:function(){this.getReqRes().setHandler("analysis-data:views:plot:sidebar",this.getView,this)},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getView:function(e,n){var r=this.getReqRes().request("app:model:env"),i=new t({template:"#"+(r==="analysis-page-server-static"?"apss-":"aps-")+"analysis-plot-sidebar-tmpl",model:e.model});return this.listenToOnce(i,"render",_.partial(this._onRender,n)),i},_onRender:function(e,t){var n=this.getReqRes().request("app:model:env");n!=="analysis-page-server-static"&&(this.renderWarnings(t),this.renderParameters(t)),this.renderFilters(t),this.renderTagging(t,e)},renderWarnings:function(e){if(!e.model.get("warnings"))return;var t=this,r=e.model.get("warnings");r=_.isArray(r)?r:[r];if(_.size(r)<1)return;r=_.map(r,function(e){return{warning:e}});var i=new n({el:e.$el.children("[data-warnings-el]"),collection:new Backbone.Collection(r)});return i.$el.removeClass("hide"),i.once("destroy",function(){t.stopListening(i)}),e.once("destroy",function(){i.destroy()}),i.render(),i},renderParameters:function(e){var t=this,n=this.getReqRes().request("pages:collection"),i=n.getActive(),s=new r({el:e.$el.children("[data-parameters-el]"),opened:!e.model.get("warnings")});s.once("destroy",function(){t.stopListening(s)}),e.once("destroy",function(){s.destroy()});var o=this.getReqRes().request("parameters:views:summary",i.rootParameters,!0);o.on("toggle",function(){t._onParametersSummaryToggle(s,i)}),s.render(),s.getRegion("inner").show(o)},renderFilters:function(e){var t=this,n=new i({el:e.$el.children("[data-filters-el]"),model:e.model,collection:e.model.metaCollection});return n.once("destroy",function(){t.stopListening(n)}),e.once("destroy",function(){n.destroy()}),n.render(),n},renderTagging:function(e,t){var n=new s({el:e.$el.children("[data-tagging-el]"),model:t,collection:e.model.metaCollection});n.on("tag:all",function(){e.model.setAllSelected()}),n.on("tag:clear",function(){e.model.setSelectedRows([],!1)}),n.on("tag:filter",function(){e.model.filterSelected()}),n.on("tag:release",function(){e.model.cancelFilterSelected()}),n.on("accordion:toggle",function(e){e&&t.set("interactionMode","tag")}),e.once("destroy",function(){n.destroy()}),n.render()},_onParametersSummaryToggle:function(e,t){var n=this.getReqRes().request("parameters:views:form",{model:t,collection:t.rootParameters,type:"secondary"});this.getCommands().execute("parameters:views:form:listen-to",n),e.showChildView("inner",n),n.triggerMethod("show:fully")}})}),define("Common/AnalysisData/Plots/Sidebar/sidebar-app",["marionette","app","./show/SidebarShowController"],function(e,t,n){var r=t.module("Common.AnalysisData.Plots.Sidebar"),i=Backbone.Wreqr.radio.channel("global").reqres;return r.on("start",function(){this.showC=new n}),r}),define("Common/AnalysisData/Plots/plots-app",["marionette","app","./show/PlotsShowController","./SettingsModelController","./SideMenu/menu-app","./Svg/svg-app","./Sidebar/sidebar-app"],function(e,t,n,r){var i=t.module("Common.AnalysisData.Plots"),s=Backbone.Wreqr.radio.channel("global").reqres;return i.on("start",function(){this.showC=new n,this.settingsC=new r}),i}),define("Common/AnalysisData/analysisdata-app",["marionette","app","./Html/html-app","./Arrays/arrays-app","./Tables/tables-app","./Plots/plots-app"],function(e,t){var n=t.module("Common.AnalysisData"),r=Backbone.Wreqr.radio.channel("global").reqres;return n.on("start",function(){}),n}),define("Common/common-app",["marionette","app","./App/app-app","./AnalysisData/analysisdata-app"],function(e,t){var n=t.module("Common"),r=Backbone.Wreqr.radio.channel("global").reqres;return n.on("start",function(){}),n}),define("AnalysisPageServer/Pages/Landing/show/LandingPageShowRouter",["marionette"],function(e){return e.AppRouter.extend({appRoutes:{"":"show"}})}),define("AnalysisPageServer/Pages/Landing/show/layoutview/APSLandingPageView",["marionette","bacon"],function(e,t){return e.LayoutView.extend({template:"#aps-landing-page-tmpl",ui:{},regions:{toolOverview:"[data-tool-overview-region]"},onRender:function(){this.$el.prop("id",this.model.get("name")+"-page-view")},onShowFully:function(){this.getRegion("toolOverview").currentView.triggerMethod("show:fully")}})}),define("AnalysisPageServer/Pages/Landing/show/APSLandingPageShowController",["marionette","./layoutview/APSLandingPageView","analytics/AnalyticsFacade"],function(e,t,n){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("app:view:show-main:landing-page",this.onCommandShow,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},onCommandShow:function(){Backbone.history.navigate(""),this._show()},show:function(){this._show()},_show:function(){var e=this,t=this.getReqRes().request("pages:collection"),n=this.getReqRes().request("pages:fetch");n.then(function(){var n=t.getInMenu(),r=_.size(n);r===0||r>1?e._showNormal():e._showPrimary(n[0])})},_showNormal:function(){var e=this.getReqRes().request("pages:collection"),r=e.get("landing"),i=this;e.setActive(r),n.trackPageview(r.get("label"),window.location.hash);var s=new t({model:r}),o=this.getReqRes().request("app:view:show-main",s,r.get("label"));o.then(function(){i.getCommands().execute("pages:views:landing:tool-overview:initialize",s)})},_showPrimary:function(e){var t=this;this.getReqRes().request("parameters:fetch",e).then(function(){t.getCommands().execute("app:view:show-main:primary-page",e)})}})}),define("AnalysisPageServer/Pages/Landing/ToolOverview/show/layoutview/ToolOverviewView",["marionette"],function(e){return e.LayoutView.extend({template:"#ep-tool-overview-tmpl",className:"row-fluid",regions:{list:".span5",body:".span7"},initialize:function(e){},showToolDesc:function(e){var t=e.attr("data-name");e.parent().addClass("active"),e.parent().siblings().removeClass("active"),this.$(".span7").children().hide().filter('[data-name="'+t+'"]').show()},hideToolDescs:function(){this.$(".span7").children().hide()},selectTool:function(e){var t=this.pages.findWhere({name:e});t.ensureParameters().take(1).onValue(this,"_selectTool")},_selectTool:function(e){var t={router:!0,navigateToPageView:!0,pageModel:e,trigger:!0};e.parameters.size()?t.primary=!0:t.secondary=!0,this.eventBus.push(t)},onClickName:function(e){e.preventDefault();var t=$(e.currentTarget);this.selectTool(t.attr("data-name"))},onClickDesc:function(e){e.preventDefault();var t=$(e.currentTarget);this.selectTool(t.attr("data-name"))},onMouseenterName:function(e){this.showToolDesc($(e.currentTarget))},onMouseleave:function(e){}})}),define("AnalysisPageServer/Pages/Landing/ToolOverview/show/itemview/ToolOverviewBodyView",["marionette"],function(e){return e.ItemView.extend({template:"#ep-tool-overview-body-tmpl",className:"",events:{"click .media":"_onClickItem"},showDesc:function(e){this.$el.children().hide().filter('[data-name="'+e+'"]').show()},hideToolDescs:function(){this.$el.children().hide()},_onClickItem:function(e){e.preventDefault();var t=$(e.currentTarget);this.trigger("click:item",t.attr("data-name"))}})}),define("AnalysisPageServer/Pages/Landing/ToolOverview/show/itemview/ToolOverviewListView",["marionette"],function(e){return e.ItemView.extend({template:"#ep-tool-overview-list-tmpl",tagName:"ul",className:"nav nav-list",events:{"click a":"_onClickItem","mouseenter a":"_onMouseenterItem"},markFirstItemActive:function(){this.$("a").first().trigger("mouseenter")},_onClickItem:function(e){e.preventDefault();var t=$(e.currentTarget);this.trigger("click:item",t.attr("data-name"))},_onMouseenterItem:function(e){var t=$(e.currentTarget);t.parent().siblings().removeClass("active"),t.parent().addClass("active"),this.trigger("mouseenter:item",t.attr("data-name"))}})}),define("AnalysisPageServer/Pages/Landing/ToolOverview/show/ToolOverviewShowController",["marionette","./layoutview/ToolOverviewView","./itemview/ToolOverviewBodyView","./itemview/ToolOverviewListView"],function(e,t,n,r){return e.Controller.extend({initialize:function(){this.getCommands().setHandler("pages:views:landing:tool-overview:initialize",this.initializeToolOverview,this)},getReqRes:function(){return Backbone.Wreqr.radio.channel("global").reqres},getCommands:function(){return Backbone.Wreqr.radio.channel("global").commands},initializeToolOverview:function(e){var i=this,s=new t;e.getRegion("toolOverview").show(s);var o=this.getReqRes().request("pages:fetch");o.then(function(e){var t=new Backbone.Collection(e.where({in_menu:!0})),o=new r({collection:t}),u=new n({collection:t});i.listenTo(o,"click:item",i._onToolOverviewClickItem),i.listenTo(o,"mouseenter:item",_.partial(i._onToolOverviewMouseenterItem,u)),o.once("destroy",function(){i.stopListening(o)}),i.listenTo(u,"click:item",i._onToolOverviewClickItem),u.once("destroy",function(){i.stopListening(u)}),s.getRegion("list").show(o),s.getRegion("body").show(u),o.markFirstItemActive()})},_onToolOverviewClickItem:function(e){var t=this,n=this.getReqRes().request("pages:collection"),r=n.get(e),i=this.getReqRes().request("parameters:fetch",r);i.then(function(e){e.size()===0?t.getCommands().execute("app:view:show-main:analysis-page",r):t.getCommands().execute("app:view:show-main:primary-page",r)})},_onToolOverviewMouseenterItem:function(e,t){e.showDesc(t)}})}),define("AnalysisPageServer/Pages/Landing/ToolOverview/tooloverview-app",["marionette","app","./show/ToolOverviewShowController"],function(e,t,n){var r=t.module("AnalysisPageServer.Pages.Landing.ToolOverview");return r.on("start",function(){this.showC=new n}),r}),define("AnalysisPageServer/Pages/Landing/aps-landingpage-app",["marionette","app","./show/LandingPageShowRouter","./show/APSLandingPageShowController","./ToolOverview/tooloverview-app"],function(e,t,n,r){var i=t.module("AnalysisPageServer.Pages.Landing");return i.on("start",function(){this.showRouter=new n({controller:new r})}),i}),require(["backbone","app","bacon","config","Common/App/show/layoutview/AppView","Common/App/models/AppModel","Common/Pages/models/PageCollection","promise-polyfill","TemplateCache.mod","./AnalysisPageServer/aps-app","./Common/common-app","./AnalysisPageServer/Pages/Landing/aps-landingpage-app"],function(e,t,n,r,i,s,o){e.Router.arrayValueSplit="|||";var u=e.Wreqr.radio.channel("global"),a=new s({id:"main",env:"analysis-page-server"});u.commands.execute("app:model:initialize",a);var f=new o(null,{appModel:a});f.create({active:!0,hidden:!0,in_menu:!1,advanced:!1,label:"Landing Page",name:"landing"}),u.commands.execute("pages:collection:set",f);var l=new i({pages:f,model:a,el:"body",title:"AnalysisPageServer",pageTitlePrefix:""});u.commands.execute("app:view:initialize",l),u.commands.execute("header:view:initialize"),t.on("start",function(){e.history.start({root:r["history.root"]})||u.reqres.request("app:view:show-modal",{type:"error",backdrop:!1,withClose:!0,title:"Oops, an error occured",doBtnLabel:"Send an email about this?",cancelBtnLabel:"Cancel",fullErrorText:"AnalysisPageServer was unable to parse the provided link.\n\n"+window.location.href+"\n\n Either it was pasted with error or there is a bug in the app.",pageModel:f.get("landing")})}),t.start()}),define("init-aps",function(){});